(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerpolicy&&(c.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?c.credentials="include":a.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(a){if(a.ep)return;a.ep=!0;const c=n(a);fetch(a.href,c)}})();var mr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ya={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Chess=i.validateFen=i.SQUARES=i.DEFAULT_POSITION=i.KING=i.QUEEN=i.ROOK=i.BISHOP=i.KNIGHT=i.PAWN=i.BLACK=i.WHITE=void 0,i.WHITE="w",i.BLACK="b",i.PAWN="p",i.KNIGHT="n",i.BISHOP="b",i.ROOK="r",i.QUEEN="q",i.KING="k",i.DEFAULT_POSITION="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";const t=-1,n={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"};i.SQUARES=["a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a6","b6","c6","d6","e6","f6","g6","h6","a5","b5","c5","d5","e5","f5","g5","h5","a4","b4","c4","d4","e4","f4","g4","h4","a3","b3","c3","d3","e3","f3","g3","h3","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","c1","d1","e1","f1","g1","h1"];const r={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},a={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},c={b:[16,32,17,15],w:[-16,-32,-17,-15]},l={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},h=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],f=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],d={p:1,n:2,b:4,r:8,q:16,k:32},_="pnbrqkPNBRQK",v=[i.KNIGHT,i.BISHOP,i.ROOK,i.QUEEN],b=7,S=6,w=1,N=0,A={w:[{square:a.a1,flag:r.QSIDE_CASTLE},{square:a.h1,flag:r.KSIDE_CASTLE}],b:[{square:a.a8,flag:r.QSIDE_CASTLE},{square:a.h8,flag:r.KSIDE_CASTLE}]},k={b:w,w:S},V=["1-0","0-1","1/2-1/2","*"];function H(j){return j>>4}function z(j){return j&15}function I(j){return"0123456789".indexOf(j)!==-1}function R(j){const y=z(j),C=H(j);return"abcdefgh".substring(y,y+1)+"87654321".substring(C,C+1)}function F(j){return j===i.WHITE?i.BLACK:i.WHITE}function W(j){const y=[];y[0]="No errors.",y[1]="FEN string must contain six space-delimited fields.",y[2]="6th field (move number) must be a positive integer.",y[3]="5th field (half move counter) must be a non-negative integer.",y[4]="4th field (en-passant square) is invalid.",y[5]="3rd field (castling availability) is invalid.",y[6]="2nd field (side to move) is invalid.",y[7]="1st field (piece positions) does not contain 8 '/'-delimited rows.",y[8]="1st field (piece positions) is invalid [consecutive numbers].",y[9]="1st field (piece positions) is invalid [invalid piece].",y[10]="1st field (piece positions) is invalid [row too large].",y[11]="Illegal en-passant square";const C=j.split(/\s+/);if(C.length!==6)return{valid:!1,errorNumber:1,error:y[1]};const E=parseInt(C[5],10);if(isNaN(E)||E<=0)return{valid:!1,errorNumber:2,error:y[2]};const P=parseInt(C[4],10);if(isNaN(P)||P<0)return{valid:!1,errorNumber:3,error:y[3]};if(!/^(-|[abcdefgh][36])$/.test(C[3]))return{valid:!1,errorNumber:4,error:y[4]};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(C[2]))return{valid:!1,errorNumber:5,error:y[5]};if(!/^(w|b)$/.test(C[1]))return{valid:!1,errorNumber:6,error:y[6]};const D=C[0].split("/");if(D.length!==8)return{valid:!1,errorNumber:7,error:y[7]};for(let G=0;G<D.length;G++){let q=0,X=!1;for(let ut=0;ut<D[G].length;ut++)if(I(D[G][ut])){if(X)return{valid:!1,errorNumber:8,error:y[8]};q+=parseInt(D[G][ut],10),X=!0}else{if(!/^[prnbqkPRNBQK]$/.test(D[G][ut]))return{valid:!1,errorNumber:9,error:y[9]};q+=1,X=!1}if(q!==8)return{valid:!1,errorNumber:10,error:y[10]}}return C[3][1]=="3"&&C[1]=="w"||C[3][1]=="6"&&C[1]=="b"?{valid:!1,errorNumber:11,error:y[11]}:{valid:!0,errorNumber:0,error:y[0]}}i.validateFen=W;function tt(j,y){const C=j.from,E=j.to,P=j.piece;let D=0,G=0,q=0;for(let X=0,ut=y.length;X<ut;X++){const wt=y[X].from,at=y[X].to,et=y[X].piece;P===et&&C!==wt&&E===at&&(D++,H(C)===H(wt)&&G++,z(C)===z(wt)&&q++)}return D>0?G>0&&q>0?R(C):q>0?R(C).charAt(1):R(C).charAt(0):""}function Z(j,y,C,E,P,D=void 0,G=r.NORMAL){const q=H(E);if(P===i.PAWN&&(q===b||q===N))for(let X=0;X<v.length;X++){const ut=v[X];j.push({color:y,from:C,to:E,piece:P,captured:D,promotion:ut,flags:G|r.PROMOTION})}else j.push({color:y,from:C,to:E,piece:P,captured:D,promotion:void 0,flags:G})}function J(j){let y=j.charAt(0);return y>="a"&&y<="h"?j.match(/[a-h]\d.*[a-h]\d/)?void 0:i.PAWN:(y=y.toLowerCase(),y==="o"?i.KING:y)}function K(j){return j.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class it{constructor(y=i.DEFAULT_POSITION){this._board=new Array(128),this._turn=i.WHITE,this._header={},this._kings={w:t,b:t},this._epSquare=-1,this._halfMoves=0,this._moveNumber=0,this._history=[],this._comments={},this._castling={w:0,b:0},this.load(y)}clear(y=!1){this._board=new Array(128),this._kings={w:t,b:t},this._turn=i.WHITE,this._castling={w:0,b:0},this._epSquare=t,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=y?this._header:{},this._updateSetup(this.fen())}load(y,C=!1){const E=y.split(/\s+/),P=E[0];let D=0;if(!W(y).valid)return!1;this.clear(C);for(let G=0;G<P.length;G++){const q=P.charAt(G);if(q==="/")D+=8;else if(I(q))D+=parseInt(q,10);else{const X=q<"a"?i.WHITE:i.BLACK;this.put({type:q.toLowerCase(),color:X},R(D)),D++}}return this._turn=E[1],E[2].indexOf("K")>-1&&(this._castling.w|=r.KSIDE_CASTLE),E[2].indexOf("Q")>-1&&(this._castling.w|=r.QSIDE_CASTLE),E[2].indexOf("k")>-1&&(this._castling.b|=r.KSIDE_CASTLE),E[2].indexOf("q")>-1&&(this._castling.b|=r.QSIDE_CASTLE),this._epSquare=E[3]==="-"?t:a[E[3]],this._halfMoves=parseInt(E[4],10),this._moveNumber=parseInt(E[5],10),this._updateSetup(this.fen()),!0}fen(){let y=0,C="";for(let D=a.a8;D<=a.h1;D++){if(this._board[D]){y>0&&(C+=y,y=0);const{color:G,type:q}=this._board[D];C+=G===i.WHITE?q.toUpperCase():q.toLowerCase()}else y++;D+1&136&&(y>0&&(C+=y),D!==a.h1&&(C+="/"),y=0,D+=8)}let E="";this._castling[i.WHITE]&r.KSIDE_CASTLE&&(E+="K"),this._castling[i.WHITE]&r.QSIDE_CASTLE&&(E+="Q"),this._castling[i.BLACK]&r.KSIDE_CASTLE&&(E+="k"),this._castling[i.BLACK]&r.QSIDE_CASTLE&&(E+="q"),E=E||"-";const P=this._epSquare===t?"-":R(this._epSquare);return[C,this._turn,E,P,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(y){this._history.length>0||(y!==i.DEFAULT_POSITION?(this._header.SetUp="1",this._header.FEN=y):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(i.DEFAULT_POSITION)}get(y){return this._board[a[y]]||!1}put({type:y,color:C},E){if(_.indexOf(y.toLowerCase())===-1||!(E in a))return!1;const P=a[E];return y==i.KING&&!(this._kings[C]==t||this._kings[C]==P)?!1:(this._board[P]={type:y,color:C},y===i.KING&&(this._kings[C]=P),this._updateSetup(this.fen()),!0)}remove(y){const C=this.get(y);return delete this._board[a[y]],C&&C.type===i.KING&&(this._kings[C.color]=t),this._updateSetup(this.fen()),C}_attacked(y,C){for(let E=a.a8;E<=a.h1;E++){if(E&136){E+=7;continue}if(this._board[E]===void 0||this._board[E].color!==y)continue;const P=this._board[E],D=E-C,G=D+119;if(h[G]&d[P.type]){if(P.type===i.PAWN){if(D>0){if(P.color===i.WHITE)return!0}else if(P.color===i.BLACK)return!0;continue}if(P.type==="n"||P.type==="k")return!0;const q=f[G];let X=E+q,ut=!1;for(;X!==C;){if(this._board[X]!=null){ut=!0;break}X+=q}if(!ut)return!0}}return!1}_isKingAttacked(y){return this._attacked(F(y),this._kings[y])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const y={b:0,n:0,r:0,q:0,k:0,p:0},C=[];let E=0,P=0;for(let D=a.a8;D<=a.h1;D++){if(P=(P+1)%2,D&136){D+=7;continue}const G=this._board[D];G&&(y[G.type]=G.type in y?y[G.type]+1:1,G.type===i.BISHOP&&C.push(P),E++)}if(E===2)return!0;if(E===3&&(y[i.BISHOP]===1||y[i.KNIGHT]===1))return!0;if(E===y[i.BISHOP]+2){let D=0;const G=C.length;for(let q=0;q<G;q++)D+=C[q];if(D===0||D===G)return!0}return!1}isThreefoldRepetition(){const y=[],C={};let E=!1;for(;;){const P=this._undoMove();if(!P)break;y.push(P)}for(;;){const P=this.fen().split(" ").slice(0,4).join(" ");C[P]=P in C?C[P]+1:1,C[P]>=3&&(E=!0);const D=y.pop();if(D)this._makeMove(D);else break}return E}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:y=!1,square:C=void 0}={}){const E=this._moves({square:C});return y?E.map(P=>this._makePretty(P)):E.map(P=>this._moveToSan(P,E))}_moves({legal:y=!0,piece:C=void 0,square:E=void 0}={}){var P;const D=E?E.toLowerCase():void 0,G=C==null?void 0:C.toLowerCase(),q=[],X=this._turn,ut=F(X);let wt=a.a8,at=a.h1,et=!1;if(D)if(D in a)wt=at=a[D],et=!0;else return[];for(let Y=wt;Y<=at;Y++){if(Y&136){Y+=7;continue}if(!this._board[Y]||this._board[Y].color===ut)continue;const{type:_t}=this._board[Y];let Ot;if(_t===i.PAWN){if(G&&G!==_t)continue;Ot=Y+c[X][0],this._board[Ot]||(Z(q,X,Y,Ot,i.PAWN),Ot=Y+c[X][1],k[X]===H(Y)&&!this._board[Ot]&&Z(q,X,Y,Ot,i.PAWN,void 0,r.BIG_PAWN));for(let Wt=2;Wt<4;Wt++)Ot=Y+c[X][Wt],!(Ot&136)&&(((P=this._board[Ot])===null||P===void 0?void 0:P.color)===ut?Z(q,X,Y,Ot,i.PAWN,this._board[Ot].type,r.CAPTURE):Ot===this._epSquare&&Z(q,X,Y,Ot,i.PAWN,i.PAWN,r.EP_CAPTURE))}else{if(G&&G!==_t)continue;for(let Wt=0,he=l[_t].length;Wt<he;Wt++){const bt=l[_t][Wt];for(Ot=Y;Ot+=bt,!(Ot&136);){if(!this._board[Ot])Z(q,X,Y,Ot,_t);else{if(this._board[Ot].color===X)break;Z(q,X,Y,Ot,_t,this._board[Ot].type,r.CAPTURE);break}if(_t===i.KNIGHT||_t===i.KING)break}}}}if((G===void 0||G===i.KING)&&(!et||at===this._kings[X])){if(this._castling[X]&r.KSIDE_CASTLE){const Y=this._kings[X],_t=Y+2;!this._board[Y+1]&&!this._board[_t]&&!this._attacked(ut,this._kings[X])&&!this._attacked(ut,Y+1)&&!this._attacked(ut,_t)&&Z(q,X,this._kings[X],_t,i.KING,void 0,r.KSIDE_CASTLE)}if(this._castling[X]&r.QSIDE_CASTLE){const Y=this._kings[X],_t=Y-2;!this._board[Y-1]&&!this._board[Y-2]&&!this._board[Y-3]&&!this._attacked(ut,this._kings[X])&&!this._attacked(ut,Y-1)&&!this._attacked(ut,_t)&&Z(q,X,this._kings[X],_t,i.KING,void 0,r.QSIDE_CASTLE)}}if(!y)return q;const It=[];for(let Y=0,_t=q.length;Y<_t;Y++)this._makeMove(q[Y]),this._isKingAttacked(X)||It.push(q[Y]),this._undoMove();return It}move(y,{sloppy:C=!1}={}){let E=null;if(typeof y=="string")E=this._moveFromSan(y,C);else if(typeof y=="object"){const D=this._moves();for(let G=0,q=D.length;G<q;G++)if(y.from===R(D[G].from)&&y.to===R(D[G].to)&&(!("promotion"in D[G])||y.promotion===D[G].promotion)){E=D[G];break}}if(!E)return null;const P=this._makePretty(E);return this._makeMove(E),P}_push(y){this._history.push({move:y,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(y){const C=this._turn,E=F(C);if(this._push(y),this._board[y.to]=this._board[y.from],delete this._board[y.from],y.flags&r.EP_CAPTURE&&(this._turn===i.BLACK?delete this._board[y.to-16]:delete this._board[y.to+16]),y.promotion&&(this._board[y.to]={type:y.promotion,color:C}),this._board[y.to].type===i.KING){if(this._kings[C]=y.to,y.flags&r.KSIDE_CASTLE){const P=y.to-1,D=y.to+1;this._board[P]=this._board[D],delete this._board[D]}else if(y.flags&r.QSIDE_CASTLE){const P=y.to+1,D=y.to-2;this._board[P]=this._board[D],delete this._board[D]}this._castling[C]=0}if(this._castling[C]){for(let P=0,D=A[C].length;P<D;P++)if(y.from===A[C][P].square&&this._castling[C]&A[C][P].flag){this._castling[C]^=A[C][P].flag;break}}if(this._castling[E]){for(let P=0,D=A[E].length;P<D;P++)if(y.to===A[E][P].square&&this._castling[E]&A[E][P].flag){this._castling[E]^=A[E][P].flag;break}}y.flags&r.BIG_PAWN?C===i.BLACK?this._epSquare=y.to-16:this._epSquare=y.to+16:this._epSquare=t,y.piece===i.PAWN?this._halfMoves=0:y.flags&(r.CAPTURE|r.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,C===i.BLACK&&this._moveNumber++,this._turn=E}undo(){const y=this._undoMove();return y?this._makePretty(y):null}_undoMove(){const y=this._history.pop();if(y===void 0)return null;const C=y.move;this._kings=y.kings,this._turn=y.turn,this._castling=y.castling,this._epSquare=y.epSquare,this._halfMoves=y.halfMoves,this._moveNumber=y.moveNumber;const E=this._turn,P=F(E);if(this._board[C.from]=this._board[C.to],this._board[C.from].type=C.piece,delete this._board[C.to],C.captured)if(C.flags&r.EP_CAPTURE){let D;E===i.BLACK?D=C.to-16:D=C.to+16,this._board[D]={type:i.PAWN,color:P}}else this._board[C.to]={type:C.captured,color:P};if(C.flags&(r.KSIDE_CASTLE|r.QSIDE_CASTLE)){let D,G;C.flags&r.KSIDE_CASTLE?(D=C.to+1,G=C.to-1):(D=C.to-2,G=C.to+1),this._board[D]=this._board[G],delete this._board[G]}return C}pgn({newline:y=`
`,maxWidth:C=0}={}){const E=[];let P=!1;for(const et in this._header)E.push("["+et+' "'+this._header[et]+'"]'+y),P=!0;P&&this._history.length&&E.push(y);const D=et=>{const It=this._comments[this.fen()];if(typeof It<"u"){const Y=et.length>0?" ":"";et=`${et}${Y}{${It}}`}return et},G=[];for(;this._history.length>0;)G.push(this._undoMove());const q=[];let X="";for(G.length===0&&q.push(D(""));G.length>0;){X=D(X);const et=G.pop();if(!et)break;if(!this._history.length&&et.color==="b"){const It=`${this._moveNumber}. ...`;X=X?`${X} ${It}`:It}else et.color==="w"&&(X.length&&q.push(X),X=this._moveNumber+".");X=X+" "+this._moveToSan(et,this._moves({legal:!0})),this._makeMove(et)}if(X.length&&q.push(D(X)),typeof this._header.Result<"u"&&q.push(this._header.Result),C===0)return E.join("")+q.join(" ");const ut=function(){return E.length>0&&E[E.length-1]===" "?(E.pop(),!0):!1},wt=function(et,It){for(const Y of It.split(" "))if(!!Y){if(et+Y.length>C){for(;ut();)et--;E.push(y),et=0}E.push(Y),et+=Y.length,E.push(" "),et++}return ut()&&et--,et};let at=0;for(let et=0;et<q.length;et++){if(at+q[et].length>C&&q[et].includes("{")){at=wt(at,q[et]);continue}at+q[et].length>C&&et!==0?(E[E.length-1]===" "&&E.pop(),E.push(y),at=0):et!==0&&(E.push(" "),at++),E.push(q[et]),at+=q[et].length}return E.join("")}header(...y){for(let C=0;C<y.length;C+=2)typeof y[C]=="string"&&typeof y[C+1]=="string"&&(this._header[y[C]]=y[C+1]);return this._header}loadPgn(y,{sloppy:C=!1,newlineChar:E=`\r?
`}={}){function P(bt){return bt.replace(/\\/g,"\\")}function D(bt){const Bt={},nt=bt.split(new RegExp(P(E)));let lt="",kt="";for(let Mt=0;Mt<nt.length;Mt++){const At=/^\s*\[([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;lt=nt[Mt].replace(At,"$1"),kt=nt[Mt].replace(At,"$2"),lt.trim().length>0&&(Bt[lt]=kt)}return Bt}y=y.trim();const q=new RegExp("^(\\[((?:"+P(E)+")|.)*\\])(?:\\s*"+P(E)+"){2}").exec(y),X=q&&q.length>=2?q[1]:"";this.reset();const ut=D(X);let wt="";for(const bt in ut)bt.toLowerCase()==="fen"&&(wt=ut[bt]),this.header(bt,ut[bt]);if(C){if(wt&&!this.load(wt,!0))return!1}else if(ut.SetUp==="1"&&!("FEN"in ut&&this.load(ut.FEN,!0)))return!1;function at(bt){return Array.from(bt).map(function(Bt){return Bt.charCodeAt(0)<128?Bt.charCodeAt(0).toString(16):encodeURIComponent(Bt).replace(/%/g,"").toLowerCase()}).join("")}function et(bt){return bt.length==0?"":decodeURIComponent("%"+(bt.match(/.{1,2}/g)||[]).join("%"))}const It=function(bt){return bt=bt.replace(new RegExp(P(E),"g")," "),`{${at(bt.slice(1,bt.length-1))}}`},Y=function(bt){if(bt.startsWith("{")&&bt.endsWith("}"))return et(bt.slice(1,bt.length-1))};let _t=y.replace(X,"").replace(new RegExp(`({[^}]*})+?|;([^${P(E)}]*)`,"g"),function(bt,Bt,nt){return Bt!==void 0?It(Bt):" "+It(`{${nt.slice(1)}}`)}).replace(new RegExp(P(E),"g")," ");const Ot=/(\([^()]+\))+?/g;for(;Ot.test(_t);)_t=_t.replace(Ot,"");_t=_t.replace(/\d+\.(\.\.)?/g,""),_t=_t.replace(/\.\.\./g,""),_t=_t.replace(/\$\d+/g,"");let Wt=_t.trim().split(new RegExp(/\s+/));Wt=Wt.join(",").replace(/,,+/g,",").split(",");let he="";for(let bt=0;bt<Wt.length;bt++){const Bt=Y(Wt[bt]);if(Bt!==void 0){this._comments[this.fen()]=Bt;continue}const nt=this._moveFromSan(Wt[bt],C);if(nt==null)if(V.indexOf(Wt[bt])>-1)he=Wt[bt];else return!1;else he="",this._makeMove(nt)}return he&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",he),!0}_moveToSan(y,C){let E="";if(y.flags&r.KSIDE_CASTLE)E="O-O";else if(y.flags&r.QSIDE_CASTLE)E="O-O-O";else{if(y.piece!==i.PAWN){const P=tt(y,C);E+=y.piece.toUpperCase()+P}y.flags&(r.CAPTURE|r.EP_CAPTURE)&&(y.piece===i.PAWN&&(E+=R(y.from)[0]),E+="x"),E+=R(y.to),y.promotion&&(E+="="+y.promotion.toUpperCase())}return this._makeMove(y),this.isCheck()&&(this.isCheckmate()?E+="#":E+="+"),this._undoMove(),E}_moveFromSan(y,C=!1){const E=K(y);let P=J(E),D=this._moves({legal:!0,piece:P});for(let et=0,It=D.length;et<It;et++)if(E===K(this._moveToSan(D[et],D)))return D[et];if(!C)return null;let G,q,X,ut,wt,at=!1;q=E.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),q?(G=q[1],X=q[2],ut=q[3],wt=q[4],X.length==1&&(at=!0)):(q=E.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),q&&(G=q[1],X=q[2],ut=q[3],wt=q[4],X.length==1&&(at=!0))),P=J(E),D=this._moves({legal:!0,piece:G||P});for(let et=0,It=D.length;et<It;et++)if(X&&ut){if((!G||G.toLowerCase()==D[et].piece)&&a[X]==D[et].from&&a[ut]==D[et].to&&(!wt||wt.toLowerCase()==D[et].promotion))return D[et];if(at){const Y=R(D[et].from);if((!G||G.toLowerCase()==D[et].piece)&&a[ut]==D[et].to&&(X==Y[0]||X==Y[1])&&(!wt||wt.toLowerCase()==D[et].promotion))return D[et]}}return null}ascii(){let y=`   +------------------------+
`;for(let C=a.a8;C<=a.h1;C++){if(z(C)===0&&(y+=" "+"87654321"[H(C)]+" |"),this._board[C]){const E=this._board[C].type,D=this._board[C].color===i.WHITE?E.toUpperCase():E.toLowerCase();y+=" "+D+" "}else y+=" . ";C+1&136&&(y+=`|
`,C+=8)}return y+=`   +------------------------+
`,y+="     a  b  c  d  e  f  g  h",y}perft(y){const C=this._moves({legal:!1});let E=0;const P=this._turn;for(let D=0,G=C.length;D<G;D++)this._makeMove(C[D]),this._isKingAttacked(P)||(y-1>0?E+=this.perft(y-1):E++),this._undoMove();return E}_makePretty(y){const{color:C,piece:E,from:P,to:D,flags:G,captured:q,promotion:X}=y;let ut="";for(const at in r)r[at]&G&&(ut+=n[at]);const wt={color:C,piece:E,from:R(P),to:R(D),san:this._moveToSan(y,this._moves({legal:!0})),flags:ut};return q&&(wt.captured=q),X&&(wt.promotion=X),wt}turn(){return this._turn}board(){const y=[];let C=[];for(let E=a.a8;E<=a.h1;E++)this._board[E]==null?C.push(null):C.push({square:R(E),type:this._board[E].type,color:this._board[E].color}),E+1&136&&(y.push(C),C=[],E+=8);return y}squareColor(y){if(y in a){const C=a[y];return(H(C)+z(C))%2===0?"light":"dark"}return null}history({verbose:y=!1}={}){const C=[],E=[];for(;this._history.length>0;)C.push(this._undoMove());for(;;){const P=C.pop();if(!P)break;y?E.push(this._makePretty(P)):E.push(this._moveToSan(P,this._moves())),this._makeMove(P)}return E}_pruneComments(){const y=[],C={},E=P=>{P in this._comments&&(C[P]=this._comments[P])};for(;this._history.length>0;)y.push(this._undoMove());for(E(this.fen());;){const P=y.pop();if(!P)break;this._makeMove(P),E(this.fen())}this._comments=C}getComment(){return this._comments[this.fen()]}setComment(y){this._comments[this.fen()]=y.replace("{","[").replace("}","]")}deleteComment(){const y=this._comments[this.fen()];return delete this._comments[this.fen()],y}getComments(){return this._pruneComments(),Object.keys(this._comments).map(y=>({fen:y,comment:this._comments[y]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(y=>{const C=this._comments[y];return delete this._comments[y],{fen:y,comment:C}})}}i.Chess=it})(Ya);const Th="14.7.77",jl=(i,t,n)=>({endTime:t,insertTime:n,type:"exponentialRampToValue",value:i}),Jl=(i,t,n)=>({endTime:t,insertTime:n,type:"linearRampToValue",value:i}),Wa=(i,t)=>({startTime:t,type:"setValue",value:i}),bh=(i,t,n)=>({duration:n,startTime:t,type:"setValueCurve",values:i}),Sh=(i,t,{startTime:n,target:r,timeConstant:a})=>r+(t-r)*Math.exp((n-i)/a),Ws=i=>i.type==="exponentialRampToValue",Li=i=>i.type==="linearRampToValue",Kn=i=>Ws(i)||Li(i),Xa=i=>i.type==="setValue",On=i=>i.type==="setValueCurve",Wi=(i,t,n,r)=>{const a=i[t];return a===void 0?r:Kn(a)||Xa(a)?a.value:On(a)?a.values[a.values.length-1]:Sh(n,Wi(i,t-1,a.startTime,r),a)},th=(i,t,n,r,a)=>n===void 0?[r.insertTime,a]:Kn(n)?[n.endTime,n.value]:Xa(n)?[n.startTime,n.value]:On(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,Wi(i,t-1,n.startTime,a)],Va=i=>i.type==="cancelAndHold",qa=i=>i.type==="cancelScheduledValues",zn=i=>Va(i)||qa(i)?i.cancelTime:Ws(i)||Li(i)?i.endTime:i.startTime,eh=(i,t,n,{endTime:r,value:a})=>n===a?a:0<n&&0<a||n<0&&a<0?n*(a/n)**((i-t)/(r-t)):0,nh=(i,t,n,{endTime:r,value:a})=>n+(i-t)/(r-t)*(a-n),u1=(i,t)=>{const n=Math.floor(t),r=Math.ceil(t);return n===r?i[n]:(1-(t-n))*i[n]+(1-(r-t))*i[r]},l1=(i,{duration:t,startTime:n,values:r})=>{const a=(i-n)/t*(r.length-1);return u1(r,a)},ki=i=>i.type==="setTarget";class h1{constructor(t){this._automationEvents=[],this._currenTime=0,this._defaultValue=t}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(t){const n=zn(t);if(Va(t)||qa(t)){const r=this._automationEvents.findIndex(c=>qa(t)&&On(c)?c.startTime+c.duration>=n:zn(c)>=n),a=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),Va(t)){const c=this._automationEvents[this._automationEvents.length-1];if(a!==void 0&&Kn(a)){if(ki(c))throw new Error("The internal list is malformed.");const l=On(c)?c.startTime+c.duration:zn(c),h=On(c)?c.values[c.values.length-1]:c.value,f=Ws(a)?eh(n,l,h,a):nh(n,l,h,a),d=Ws(a)?jl(f,n,this._currenTime):Jl(f,n,this._currenTime);this._automationEvents.push(d)}c!==void 0&&ki(c)&&this._automationEvents.push(Wa(this.getValue(n),n)),c!==void 0&&On(c)&&c.startTime+c.duration>n&&(this._automationEvents[this._automationEvents.length-1]=bh(new Float32Array([6,7]),c.startTime,n-c.startTime))}}else{const r=this._automationEvents.findIndex(l=>zn(l)>n),a=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(a!==void 0&&On(a)&&zn(a)+a.duration>n)return!1;const c=Ws(t)?jl(t.value,t.endTime,this._currenTime):Li(t)?Jl(t.value,n,this._currenTime):t;if(r===-1)this._automationEvents.push(c);else{if(On(t)&&n+t.duration>zn(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,c)}}return!0}flush(t){const n=this._automationEvents.findIndex(r=>zn(r)>t);if(n>1){const r=this._automationEvents.slice(n-1),a=r[0];ki(a)&&r.unshift(Wa(Wi(this._automationEvents,n-2,a.startTime,this._defaultValue),a.startTime)),this._automationEvents=r}}getValue(t){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(l=>zn(l)>t),r=this._automationEvents[n],a=(n===-1?this._automationEvents.length:n)-1,c=this._automationEvents[a];if(c!==void 0&&ki(c)&&(r===void 0||!Kn(r)||r.insertTime>t))return Sh(t,Wi(this._automationEvents,a-1,c.startTime,this._defaultValue),c);if(c!==void 0&&Xa(c)&&(r===void 0||!Kn(r)))return c.value;if(c!==void 0&&On(c)&&(r===void 0||!Kn(r)||c.startTime+c.duration>t))return t<c.startTime+c.duration?l1(t,c):c.values[c.values.length-1];if(c!==void 0&&Kn(c)&&(r===void 0||!Kn(r)))return c.value;if(r!==void 0&&Ws(r)){const[l,h]=th(this._automationEvents,a,c,r,this._defaultValue);return eh(t,l,h,r)}if(r!==void 0&&Li(r)){const[l,h]=th(this._automationEvents,a,c,r,this._defaultValue);return nh(t,l,h,r)}return this._defaultValue}}const f1=i=>({cancelTime:i,type:"cancelAndHold"}),d1=i=>({cancelTime:i,type:"cancelScheduledValues"}),p1=(i,t)=>({endTime:t,type:"exponentialRampToValue",value:i}),_1=(i,t)=>({endTime:t,type:"linearRampToValue",value:i}),m1=(i,t,n)=>({startTime:t,target:i,timeConstant:n,type:"setTarget"}),g1=()=>new DOMException("","AbortError"),v1=i=>(t,n,[r,a,c],l)=>{i(t[a],[n,r,c],h=>h[0]===n&&h[1]===r,l)},y1=i=>(t,n,r)=>{const a=[];for(let c=0;c<r.numberOfInputs;c+=1)a.push(new Set);i.set(t,{activeInputs:a,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},w1=i=>(t,n)=>{i.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},Us=new WeakSet,Ch=new WeakMap,Qa=new WeakMap,Ah=new WeakMap,ja=new WeakMap,eo=new WeakMap,xh=new WeakMap,Ba=new WeakMap,Ua=new WeakMap,Ga=new WeakMap,Nh={construct(){return Nh}},T1=i=>{try{const t=new Proxy(i,Nh);new t}catch{return!1}return!0},sh=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,rh=(i,t)=>{const n=[];let r=i.replace(/^[\s]+/,""),a=r.match(sh);for(;a!==null;){const c=a[1].slice(1,-1),l=a[0].replace(/([\s]+)?;?$/,"").replace(c,new URL(c,t).toString());n.push(l),r=r.slice(a[0].length).replace(/^[\s]+/,""),a=r.match(sh)}return[n.join(";"),r]},ih=i=>{if(i!==void 0&&!Array.isArray(i))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},oh=i=>{if(!T1(i))throw new TypeError("The given value for processorCtor should be a constructor.");if(i.prototype===null||typeof i.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},b1=(i,t,n,r,a,c,l,h,f,d,_,v,b)=>{let S=0;return(w,N,A={credentials:"omit"})=>{const k=_.get(w);if(k!==void 0&&k.has(N))return Promise.resolve();const V=d.get(w);if(V!==void 0){const I=V.get(N);if(I!==void 0)return I}const H=c(w),z=H.audioWorklet===void 0?a(N).then(([I,R])=>{const[F,W]=rh(I,R),tt=`${F};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${W}
})})(window,'_AWGS')`;return n(tt)}).then(()=>{const I=b._AWGS.pop();if(I===void 0)throw new SyntaxError;r(H.currentTime,H.sampleRate,()=>I(class{},void 0,(R,F)=>{if(R.trim()==="")throw t();const W=Ua.get(H);if(W!==void 0){if(W.has(R))throw t();oh(F),ih(F.parameterDescriptors),W.set(R,F)}else oh(F),ih(F.parameterDescriptors),Ua.set(H,new Map([[R,F]]))},H.sampleRate,void 0,void 0))}):Promise.all([a(N),Promise.resolve(i(v,v))]).then(([[I,R],F])=>{const W=S+1;S=W;const[tt,Z]=rh(I,R),j=`${tt};((AudioWorkletProcessor,registerProcessor)=>{${Z}
})(${F?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${F?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${F?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${W}',class extends AudioWorkletProcessor{process(){return !1}})`,y=new Blob([j],{type:"application/javascript; charset=utf-8"}),C=URL.createObjectURL(y);return H.audioWorklet.addModule(C,A).then(()=>{if(h(H))return H;const E=l(H);return E.audioWorklet.addModule(C,A).then(()=>E)}).then(E=>{if(f===null)throw new SyntaxError;try{new f(E,`__sac${W}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(C))});return V===void 0?d.set(w,new Map([[N,z]])):V.set(N,z),z.then(()=>{const I=_.get(w);I===void 0?_.set(w,new Set([N])):I.add(N)}).finally(()=>{const I=d.get(w);I!==void 0&&I.delete(N)}),z}},an=(i,t)=>{const n=i.get(t);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},no=(i,t)=>{const n=Array.from(i).filter(t);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return i.delete(r),r},Ih=(i,t,n,r)=>{const a=an(i,t),c=no(a,l=>l[0]===n&&l[1]===r);return a.size===0&&i.delete(t),c},Rr=i=>an(xh,i),Gs=i=>{if(Us.has(i))throw new Error("The AudioNode is already stored.");Us.add(i),Rr(i).forEach(t=>t(!0))},Eh=i=>"port"in i,Dr=i=>{if(!Us.has(i))throw new Error("The AudioNode is not stored.");Us.delete(i),Rr(i).forEach(t=>t(!1))},$a=(i,t)=>{!Eh(i)&&t.every(n=>n.size===0)&&Dr(i)},S1=(i,t,n,r,a,c,l,h,f,d,_,v,b)=>{const S=new WeakMap;return(w,N,A,k,V)=>{const{activeInputs:H,passiveInputs:z}=c(N),{outputs:I}=c(w),R=h(w),F=W=>{const tt=f(N),Z=f(w);if(W){const J=Ih(z,w,A,k);i(H,w,J,!1),!V&&!v(w)&&n(Z,tt,A,k),b(N)&&Gs(N)}else{const J=r(H,w,A,k);t(z,k,J,!1),!V&&!v(w)&&a(Z,tt,A,k);const K=l(N);if(K===0)_(N)&&$a(N,H);else{const it=S.get(N);it!==void 0&&clearTimeout(it),S.set(N,setTimeout(()=>{_(N)&&$a(N,H)},K*1e3))}}};return d(I,[N,A,k],W=>W[0]===N&&W[1]===A&&W[2]===k,!0)?(R.add(F),_(w)?i(H,w,[A,k,F],!0):t(z,k,[w,A,F],!0),!0):!1}},C1=i=>(t,n,[r,a,c],l)=>{const h=t.get(r);h===void 0?t.set(r,new Set([[a,n,c]])):i(h,[a,n,c],f=>f[0]===a&&f[1]===n,l)},A1=i=>(t,n)=>{const r=i(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(t.destination);const a=()=>{n.removeEventListener("ended",a),n.disconnect(r),r.disconnect()};n.addEventListener("ended",a)},x1=i=>(t,n)=>{i(t).add(n)},N1={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},I1=(i,t,n,r,a,c)=>class extends i{constructor(h,f){const d=a(h),_={...N1,...f},v=r(d,_),b=c(d)?t():null;super(h,!1,v,b),this._nativeAnalyserNode=v}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(h){this._nativeAnalyserNode.fftSize=h}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(h){const f=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=h,!(h>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=f,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(h){const f=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=h,!(this._nativeAnalyserNode.maxDecibels>h))throw this._nativeAnalyserNode.minDecibels=f,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(h){this._nativeAnalyserNode.smoothingTimeConstant=h}getByteFrequencyData(h){this._nativeAnalyserNode.getByteFrequencyData(h)}getByteTimeDomainData(h){this._nativeAnalyserNode.getByteTimeDomainData(h)}getFloatFrequencyData(h){this._nativeAnalyserNode.getFloatFrequencyData(h)}getFloatTimeDomainData(h){this._nativeAnalyserNode.getFloatTimeDomainData(h)}},ye=(i,t)=>i.context===t,E1=(i,t,n)=>()=>{const r=new WeakMap,a=async(c,l)=>{let h=t(c);if(!ye(h,l)){const d={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,fftSize:h.fftSize,maxDecibels:h.maxDecibels,minDecibels:h.minDecibels,smoothingTimeConstant:h.smoothingTimeConstant};h=i(l,d)}return r.set(l,h),await n(c,l,h),h};return{render(c,l){const h=r.get(l);return h!==void 0?Promise.resolve(h):a(c,l)}}},Vi=i=>{try{i.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},gn=()=>new DOMException("","IndexSizeError"),Ja=i=>{i.getChannelData=(t=>n=>{try{return t.call(i,n)}catch(r){throw r.code===12?gn():r}})(i.getChannelData)},O1={numberOfChannels:1},k1=(i,t,n,r,a,c,l,h)=>{let f=null;return class Oh{constructor(_){if(a===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:v,numberOfChannels:b,sampleRate:S}={...O1,..._};f===null&&(f=new a(1,1,44100));const w=r!==null&&t(c,c)?new r({length:v,numberOfChannels:b,sampleRate:S}):f.createBuffer(b,v,S);if(w.numberOfChannels===0)throw n();return typeof w.copyFromChannel!="function"?(l(w),Ja(w)):t(Vi,()=>Vi(w))||h(w),i.add(w),w}static[Symbol.hasInstance](_){return _!==null&&typeof _=="object"&&Object.getPrototypeOf(_)===Oh.prototype||i.has(_)}}},Me=-34028234663852886e22,Se=-Me,Mn=i=>Us.has(i),M1={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},R1=(i,t,n,r,a,c,l,h)=>class extends i{constructor(d,_){const v=c(d),b={...M1,..._},S=a(v,b),w=l(v),N=w?t():null;super(d,!1,S,N),this._audioBufferSourceNodeRenderer=N,this._isBufferNullified=!1,this._isBufferSet=b.buffer!==null,this._nativeAudioBufferSourceNode=S,this._onended=null,this._playbackRate=n(this,w,S.playbackRate,Se,Me)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(d){if(this._nativeAudioBufferSourceNode.buffer=d,d!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(d){this._nativeAudioBufferSourceNode.loop=d}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(d){this._nativeAudioBufferSourceNode.loopEnd=d}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(d){this._nativeAudioBufferSourceNode.loopStart=d}get onended(){return this._onended}set onended(d){const _=typeof d=="function"?h(this,d):null;this._nativeAudioBufferSourceNode.onended=_;const v=this._nativeAudioBufferSourceNode.onended;this._onended=v!==null&&v===_?d:v}get playbackRate(){return this._playbackRate}start(d=0,_=0,v){if(this._nativeAudioBufferSourceNode.start(d,_,v),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=v===void 0?[d,_]:[d,_,v]),this.context.state!=="closed"){Gs(this);const b=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",b),Mn(this)&&Dr(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",b)}}stop(d=0){this._nativeAudioBufferSourceNode.stop(d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=d)}},D1=(i,t,n,r,a)=>()=>{const c=new WeakMap;let l=null,h=null;const f=async(d,_)=>{let v=n(d);const b=ye(v,_);if(!b){const S={buffer:v.buffer,channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,loop:v.loop,loopEnd:v.loopEnd,loopStart:v.loopStart,playbackRate:v.playbackRate.value};v=t(_,S),l!==null&&v.start(...l),h!==null&&v.stop(h)}return c.set(_,v),b?await i(_,d.playbackRate,v.playbackRate):await r(_,d.playbackRate,v.playbackRate),await a(d,_,v),v};return{set start(d){l=d},set stop(d){h=d},render(d,_){const v=c.get(_);return v!==void 0?Promise.resolve(v):f(d,_)}}},P1=i=>"playbackRate"in i,F1=i=>"frequency"in i&&"gain"in i,L1=i=>"offset"in i,W1=i=>!("frequency"in i)&&"gain"in i,V1=i=>"detune"in i&&"frequency"in i,q1=i=>"pan"in i,Ce=i=>an(Ch,i),Pr=i=>an(Ah,i),Ha=(i,t)=>{const{activeInputs:n}=Ce(i);n.forEach(a=>a.forEach(([c])=>{t.includes(i)||Ha(c,[...t,i])}));const r=P1(i)?[i.playbackRate]:Eh(i)?Array.from(i.parameters.values()):F1(i)?[i.Q,i.detune,i.frequency,i.gain]:L1(i)?[i.offset]:W1(i)?[i.gain]:V1(i)?[i.detune,i.frequency]:q1(i)?[i.pan]:[];for(const a of r){const c=Pr(a);c!==void 0&&c.activeInputs.forEach(([l])=>Ha(l,t))}Mn(i)&&Dr(i)},kh=i=>{Ha(i.destination,[])},B1=i=>i===void 0||typeof i=="number"||typeof i=="string"&&(i==="balanced"||i==="interactive"||i==="playback"),U1=(i,t,n,r,a,c,l,h,f)=>class extends i{constructor(_={}){if(f===null)throw new Error("Missing the native AudioContext constructor.");let v;try{v=new f(_)}catch(w){throw w.code===12&&w.message==="sampleRate is not in range"?n():w}if(v===null)throw r();if(!B1(_.latencyHint))throw new TypeError(`The provided value '${_.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(_.sampleRate!==void 0&&v.sampleRate!==_.sampleRate)throw n();super(v,2);const{latencyHint:b}=_,{sampleRate:S}=v;if(this._baseLatency=typeof v.baseLatency=="number"?v.baseLatency:b==="balanced"?512/S:b==="interactive"||b===void 0?256/S:b==="playback"?1024/S:Math.max(2,Math.min(128,Math.round(b*S/128)))*128/S,this._nativeAudioContext=v,f.name==="webkitAudioContext"?(this._nativeGainNode=v.createGain(),this._nativeOscillatorNode=v.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(v.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,v.state==="running"){this._state="suspended";const w=()=>{this._state==="suspended"&&(this._state=null),v.removeEventListener("statechange",w)};v.addEventListener("statechange",w)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw t()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),kh(this)}))}createMediaElementSource(_){return new a(this,{mediaElement:_})}createMediaStreamDestination(){return new c(this)}createMediaStreamSource(_){return new l(this,{mediaStream:_})}createMediaStreamTrackSource(_){return new h(this,{mediaStreamTrack:_})}resume(){return this._state==="suspended"?new Promise((_,v)=>{const b=()=>{this._nativeAudioContext.removeEventListener("statechange",b),this._nativeAudioContext.state==="running"?_():this.resume().then(_,v)};this._nativeAudioContext.addEventListener("statechange",b)}):this._nativeAudioContext.resume().catch(_=>{throw _===void 0||_.code===15?t():_})}suspend(){return this._nativeAudioContext.suspend().catch(_=>{throw _===void 0?t():_})}},G1=(i,t,n,r,a,c,l,h)=>class extends i{constructor(d,_){const v=c(d),b=l(v),S=a(v,_,b),w=b?t(h):null;super(d,!1,S,w),this._isNodeOfNativeOfflineAudioContext=b,this._nativeAudioDestinationNode=S}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(d){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(d>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=d}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(d){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=d}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},$1=i=>{const t=new WeakMap,n=async(r,a)=>{const c=a.destination;return t.set(a,c),await i(r,a,c),c};return{render(r,a){const c=t.get(a);return c!==void 0?Promise.resolve(c):n(r,a)}}},H1=(i,t,n,r,a,c,l,h)=>(f,d)=>{const _=d.listener,v=()=>{const I=new Float32Array(1),R=t(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),F=l(d);let W=!1,tt=[0,0,-1,0,1,0],Z=[0,0,0];const J=()=>{if(W)return;W=!0;const y=r(d,256,9,0);y.onaudioprocess=({inputBuffer:C})=>{const E=[c(C,I,0),c(C,I,1),c(C,I,2),c(C,I,3),c(C,I,4),c(C,I,5)];E.some((D,G)=>D!==tt[G])&&(_.setOrientation(...E),tt=E);const P=[c(C,I,6),c(C,I,7),c(C,I,8)];P.some((D,G)=>D!==Z[G])&&(_.setPosition(...P),Z=P)},R.connect(y)},K=y=>C=>{C!==tt[y]&&(tt[y]=C,_.setOrientation(...tt))},it=y=>C=>{C!==Z[y]&&(Z[y]=C,_.setPosition(...Z))},j=(y,C,E)=>{const P=n(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:C});P.connect(R,0,y),P.start(),Object.defineProperty(P.offset,"defaultValue",{get(){return C}});const D=i({context:f},F,P.offset,Se,Me);return h(D,"value",G=>()=>G.call(D),G=>q=>{try{G.call(D,q)}catch(X){if(X.code!==9)throw X}J(),F&&E(q)}),D.cancelAndHoldAtTime=(G=>F?()=>{throw a()}:(...q)=>{const X=G.apply(D,q);return J(),X})(D.cancelAndHoldAtTime),D.cancelScheduledValues=(G=>F?()=>{throw a()}:(...q)=>{const X=G.apply(D,q);return J(),X})(D.cancelScheduledValues),D.exponentialRampToValueAtTime=(G=>F?()=>{throw a()}:(...q)=>{const X=G.apply(D,q);return J(),X})(D.exponentialRampToValueAtTime),D.linearRampToValueAtTime=(G=>F?()=>{throw a()}:(...q)=>{const X=G.apply(D,q);return J(),X})(D.linearRampToValueAtTime),D.setTargetAtTime=(G=>F?()=>{throw a()}:(...q)=>{const X=G.apply(D,q);return J(),X})(D.setTargetAtTime),D.setValueAtTime=(G=>F?()=>{throw a()}:(...q)=>{const X=G.apply(D,q);return J(),X})(D.setValueAtTime),D.setValueCurveAtTime=(G=>F?()=>{throw a()}:(...q)=>{const X=G.apply(D,q);return J(),X})(D.setValueCurveAtTime),D};return{forwardX:j(0,0,K(0)),forwardY:j(1,0,K(1)),forwardZ:j(2,-1,K(2)),positionX:j(6,0,it(0)),positionY:j(7,0,it(1)),positionZ:j(8,0,it(2)),upX:j(3,0,K(3)),upY:j(4,1,K(4)),upZ:j(5,0,K(5))}},{forwardX:b,forwardY:S,forwardZ:w,positionX:N,positionY:A,positionZ:k,upX:V,upY:H,upZ:z}=_.forwardX===void 0?v():_;return{get forwardX(){return b},get forwardY(){return S},get forwardZ(){return w},get positionX(){return N},get positionY(){return A},get positionZ(){return k},get upX(){return V},get upY(){return H},get upZ(){return z}}},qi=i=>"context"in i,Fr=i=>qi(i[0]),ys=(i,t,n,r)=>{for(const a of i)if(n(a)){if(r)return!1;throw Error("The set contains at least one similar element.")}return i.add(t),!0},ah=(i,t,[n,r],a)=>{ys(i,[t,n,r],c=>c[0]===t&&c[1]===n,a)},ch=(i,[t,n,r],a)=>{const c=i.get(t);c===void 0?i.set(t,new Set([[n,r]])):ys(c,[n,r],l=>l[0]===n,a)},Ks=i=>"inputs"in i,Bi=(i,t,n,r)=>{if(Ks(t)){const a=t.inputs[r];return i.connect(a,n,0),[a,n,0]}return i.connect(t,n,r),[t,n,r]},Mh=(i,t,n)=>{for(const r of i)if(r[0]===t&&r[1]===n)return i.delete(r),r;return null},z1=(i,t,n)=>no(i,r=>r[0]===t&&r[1]===n),Rh=(i,t)=>{if(!Rr(i).delete(t))throw new Error("Missing the expected event listener.")},Dh=(i,t,n)=>{const r=an(i,t),a=no(r,c=>c[0]===n);return r.size===0&&i.delete(t),a},Ui=(i,t,n,r)=>{Ks(t)?i.disconnect(t.inputs[r],n,0):i.disconnect(t,n,r)},zt=i=>an(Qa,i),vr=i=>an(ja,i),fs=i=>Ba.has(i),Pi=i=>!Us.has(i),uh=(i,t)=>new Promise(n=>{if(t!==null)n(!0);else{const r=i.createScriptProcessor(256,1,1),a=i.createGain(),c=i.createBuffer(1,2,44100),l=c.getChannelData(0);l[0]=1,l[1]=1;const h=i.createBufferSource();h.buffer=c,h.loop=!0,h.connect(r).connect(i.destination),h.connect(a),h.disconnect(a),r.onaudioprocess=f=>{const d=f.inputBuffer.getChannelData(0);Array.prototype.some.call(d,_=>_===1)?n(!0):n(!1),h.stop(),r.onaudioprocess=null,h.disconnect(r),r.disconnect(i.destination)},h.start()}}),Da=(i,t)=>{const n=new Map;for(const r of i)for(const a of r){const c=n.get(a);n.set(a,c===void 0?1:c+1)}n.forEach((r,a)=>t(a,r))},Gi=i=>"context"in i,K1=i=>{const t=new Map;i.connect=(n=>(r,a=0,c=0)=>{const l=Gi(r)?n(r,a,c):n(r,a),h=t.get(r);return h===void 0?t.set(r,[{input:c,output:a}]):h.every(f=>f.input!==c||f.output!==a)&&h.push({input:c,output:a}),l})(i.connect.bind(i)),i.disconnect=(n=>(r,a,c)=>{if(n.apply(i),r===void 0)t.clear();else if(typeof r=="number")for(const[l,h]of t){const f=h.filter(d=>d.output!==r);f.length===0?t.delete(l):t.set(l,f)}else if(t.has(r))if(a===void 0)t.delete(r);else{const l=t.get(r);if(l!==void 0){const h=l.filter(f=>f.output!==a&&(f.input!==c||c===void 0));h.length===0?t.delete(r):t.set(r,h)}}for(const[l,h]of t)h.forEach(f=>{Gi(l)?i.connect(l,f.output,f.input):i.connect(l,f.output)})})(i.disconnect)},Z1=(i,t,n,r)=>{const{activeInputs:a,passiveInputs:c}=Pr(t),{outputs:l}=Ce(i),h=Rr(i),f=d=>{const _=zt(i),v=vr(t);if(d){const b=Dh(c,i,n);ah(a,i,b,!1),!r&&!fs(i)&&_.connect(v,n)}else{const b=z1(a,i,n);ch(c,b,!1),!r&&!fs(i)&&_.disconnect(v,n)}};return ys(l,[t,n],d=>d[0]===t&&d[1]===n,!0)?(h.add(f),Mn(i)?ah(a,i,[n,f],!0):ch(c,[i,n,f],!0),!0):!1},Y1=(i,t,n,r)=>{const{activeInputs:a,passiveInputs:c}=Ce(t),l=Mh(a[r],i,n);return l===null?[Ih(c,i,n,r)[2],!1]:[l[2],!0]},X1=(i,t,n)=>{const{activeInputs:r,passiveInputs:a}=Pr(t),c=Mh(r,i,n);return c===null?[Dh(a,i,n)[1],!1]:[c[2],!0]},tc=(i,t,n,r,a)=>{const[c,l]=Y1(i,n,r,a);if(c!==null&&(Rh(i,c),l&&!t&&!fs(i)&&Ui(zt(i),zt(n),r,a)),Mn(n)){const{activeInputs:h}=Ce(n);$a(n,h)}},ec=(i,t,n,r)=>{const[a,c]=X1(i,n,r);a!==null&&(Rh(i,a),c&&!t&&!fs(i)&&zt(i).disconnect(vr(n),r))},Q1=(i,t)=>{const n=Ce(i),r=[];for(const a of n.outputs)Fr(a)?tc(i,t,...a):ec(i,t,...a),r.push(a[0]);return n.outputs.clear(),r},j1=(i,t,n)=>{const r=Ce(i),a=[];for(const c of r.outputs)c[1]===n&&(Fr(c)?tc(i,t,...c):ec(i,t,...c),a.push(c[0]),r.outputs.delete(c));return a},J1=(i,t,n,r,a)=>{const c=Ce(i);return Array.from(c.outputs).filter(l=>l[0]===n&&(r===void 0||l[1]===r)&&(a===void 0||l[2]===a)).map(l=>(Fr(l)?tc(i,t,...l):ec(i,t,...l),c.outputs.delete(l),l[0]))},ty=(i,t,n,r,a,c,l,h,f,d,_,v,b,S,w,N)=>class extends d{constructor(k,V,H,z){super(H),this._context=k,this._nativeAudioNode=H;const I=_(k);v(I)&&n(uh,()=>uh(I,N))!==!0&&K1(H),Qa.set(this,H),xh.set(this,new Set),k.state!=="closed"&&V&&Gs(this),i(this,z,H)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(k){this._nativeAudioNode.channelCount=k}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(k){this._nativeAudioNode.channelCountMode=k}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(k){this._nativeAudioNode.channelInterpretation=k}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(k,V=0,H=0){if(V<0||V>=this._nativeAudioNode.numberOfOutputs)throw a();const z=_(this._context),I=w(z);if(b(k)||S(k))throw c();if(qi(k)){const W=zt(k);try{const Z=Bi(this._nativeAudioNode,W,V,H),J=Pi(this);(I||J)&&this._nativeAudioNode.disconnect(...Z),this.context.state!=="closed"&&!J&&Pi(k)&&Gs(k)}catch(Z){throw Z.code===12?c():Z}if(t(this,k,V,H,I)){const Z=f([this],k);Da(Z,r(I))}return k}const R=vr(k);if(R.name==="playbackRate"&&R.maxValue===1024)throw l();try{this._nativeAudioNode.connect(R,V),(I||Pi(this))&&this._nativeAudioNode.disconnect(R,V)}catch(W){throw W.code===12?c():W}if(Z1(this,k,V,I)){const W=f([this],k);Da(W,r(I))}}disconnect(k,V,H){let z;const I=_(this._context),R=w(I);if(k===void 0)z=Q1(this,R);else if(typeof k=="number"){if(k<0||k>=this.numberOfOutputs)throw a();z=j1(this,R,k)}else{if(V!==void 0&&(V<0||V>=this.numberOfOutputs)||qi(k)&&H!==void 0&&(H<0||H>=k.numberOfInputs))throw a();if(z=J1(this,R,k,V,H),z.length===0)throw c()}for(const F of z){const W=f([this],F);Da(W,h)}}},ey=(i,t,n,r,a,c,l,h,f,d,_,v,b)=>(S,w,N,A=null,k=null)=>{const V=new h1(N.defaultValue),H=w?r(V):null,z={get defaultValue(){return N.defaultValue},get maxValue(){return A===null?N.maxValue:A},get minValue(){return k===null?N.minValue:k},get value(){return N.value},set value(I){N.value=I,z.setValueAtTime(I,S.context.currentTime)},cancelAndHoldAtTime(I){if(typeof N.cancelAndHoldAtTime=="function")H===null&&V.flush(S.context.currentTime),V.add(a(I)),N.cancelAndHoldAtTime(I);else{const R=Array.from(V).pop();H===null&&V.flush(S.context.currentTime),V.add(a(I));const F=Array.from(V).pop();N.cancelScheduledValues(I),R!==F&&F!==void 0&&(F.type==="exponentialRampToValue"?N.exponentialRampToValueAtTime(F.value,F.endTime):F.type==="linearRampToValue"?N.linearRampToValueAtTime(F.value,F.endTime):F.type==="setValue"?N.setValueAtTime(F.value,F.startTime):F.type==="setValueCurve"&&N.setValueCurveAtTime(F.values,F.startTime,F.duration))}return z},cancelScheduledValues(I){return H===null&&V.flush(S.context.currentTime),V.add(c(I)),N.cancelScheduledValues(I),z},exponentialRampToValueAtTime(I,R){if(I===0)throw new RangeError;if(!Number.isFinite(R)||R<0)throw new RangeError;return H===null&&V.flush(S.context.currentTime),V.add(l(I,R)),N.exponentialRampToValueAtTime(I,R),z},linearRampToValueAtTime(I,R){return H===null&&V.flush(S.context.currentTime),V.add(h(I,R)),N.linearRampToValueAtTime(I,R),z},setTargetAtTime(I,R,F){return H===null&&V.flush(S.context.currentTime),V.add(f(I,R,F)),N.setTargetAtTime(I,R,F),z},setValueAtTime(I,R){return H===null&&V.flush(S.context.currentTime),V.add(d(I,R)),N.setValueAtTime(I,R),z},setValueCurveAtTime(I,R,F){const W=I instanceof Float32Array?I:new Float32Array(I);if(v!==null&&v.name==="webkitAudioContext"){const tt=R+F,Z=S.context.sampleRate,J=Math.ceil(R*Z),K=Math.floor(tt*Z),it=K-J,j=new Float32Array(it);for(let C=0;C<it;C+=1){const E=(W.length-1)/F*((J+C)/Z-R),P=Math.floor(E),D=Math.ceil(E);j[C]=P===D?W[P]:(1-(E-P))*W[P]+(1-(D-E))*W[D]}H===null&&V.flush(S.context.currentTime),V.add(_(j,R,F)),N.setValueCurveAtTime(j,R,F);const y=K/Z;y<tt&&b(z,j[j.length-1],y),b(z,W[W.length-1],tt)}else H===null&&V.flush(S.context.currentTime),V.add(_(W,R,F)),N.setValueCurveAtTime(W,R,F);return z}};return n.set(z,N),t.set(z,S),i(z,H),z},ny=i=>({replay(t){for(const n of i)if(n.type==="exponentialRampToValue"){const{endTime:r,value:a}=n;t.exponentialRampToValueAtTime(a,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:a}=n;t.linearRampToValueAtTime(a,r)}else if(n.type==="setTarget"){const{startTime:r,target:a,timeConstant:c}=n;t.setTargetAtTime(a,r,c)}else if(n.type==="setValue"){const{startTime:r,value:a}=n;t.setValueAtTime(a,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:a,values:c}=n;t.setValueCurveAtTime(c,a,r)}else throw new Error("Can't apply an unknown automation.")}});class Ph{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,n=null){return this._map.forEach((r,a)=>t.call(n,r,a,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const sy={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},ry=(i,t,n,r,a,c,l,h,f,d,_,v,b,S)=>class extends t{constructor(N,A,k){var V;const H=h(N),z=f(H),I=_({...sy,...k});b(I);const R=Ua.get(H),F=R==null?void 0:R.get(A),W=z||H.state!=="closed"?H:(V=l(H))!==null&&V!==void 0?V:H,tt=a(W,z?null:N.baseLatency,d,A,F,I),Z=z?r(A,I,F):null;super(N,!0,tt,Z);const J=[];tt.parameters.forEach((it,j)=>{const y=n(this,z,it);J.push([j,y])}),this._nativeAudioWorkletNode=tt,this._onprocessorerror=null,this._parameters=new Ph(J),z&&i(H,this);const{activeInputs:K}=c(this);v(tt,K)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(N){const A=typeof N=="function"?S(this,N):null;this._nativeAudioWorkletNode.onprocessorerror=A;const k=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=k!==null&&k===A?N:k}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function $i(i,t,n,r,a){if(typeof i.copyFromChannel=="function")t[n].byteLength===0&&(t[n]=new Float32Array(128)),i.copyFromChannel(t[n],r,a);else{const c=i.getChannelData(r);if(t[n].byteLength===0)t[n]=c.slice(a,a+128);else{const l=new Float32Array(c.buffer,a*Float32Array.BYTES_PER_ELEMENT,128);t[n].set(l)}}}const Fh=(i,t,n,r,a)=>{typeof i.copyToChannel=="function"?t[n].byteLength!==0&&i.copyToChannel(t[n],r,a):t[n].byteLength!==0&&i.getChannelData(r).set(t[n],a)},Hi=(i,t)=>{const n=[];for(let r=0;r<i;r+=1){const a=[],c=typeof t=="number"?t:t[r];for(let l=0;l<c;l+=1)a.push(new Float32Array(128));n.push(a)}return n},iy=(i,t)=>{const n=an(Ga,i),r=zt(t);return an(n,r)},oy=async(i,t,n,r,a,c,l)=>{const h=t===null?Math.ceil(i.context.length/128)*128:t.length,f=r.channelCount*r.numberOfInputs,d=a.reduce((A,k)=>A+k,0),_=d===0?null:n.createBuffer(d,h,n.sampleRate);if(c===void 0)throw new Error("Missing the processor constructor.");const v=Ce(i),b=await iy(n,i),S=Hi(r.numberOfInputs,r.channelCount),w=Hi(r.numberOfOutputs,a),N=Array.from(i.parameters.keys()).reduce((A,k)=>({...A,[k]:new Float32Array(128)}),{});for(let A=0;A<h;A+=128){if(r.numberOfInputs>0&&t!==null)for(let k=0;k<r.numberOfInputs;k+=1)for(let V=0;V<r.channelCount;V+=1)$i(t,S[k],V,V,A);c.parameterDescriptors!==void 0&&t!==null&&c.parameterDescriptors.forEach(({name:k},V)=>{$i(t,N,k,f+V,A)});for(let k=0;k<r.numberOfInputs;k+=1)for(let V=0;V<a[k];V+=1)w[k][V].byteLength===0&&(w[k][V]=new Float32Array(128));try{const k=S.map((H,z)=>v.activeInputs[z].size===0?[]:H),V=l(A/n.sampleRate,n.sampleRate,()=>b.process(k,w,N));if(_!==null)for(let H=0,z=0;H<r.numberOfOutputs;H+=1){for(let I=0;I<a[H];I+=1)Fh(_,w[H],I,z+I,A);z+=a[H]}if(!V)break}catch(k){i.dispatchEvent(new ErrorEvent("processorerror",{colno:k.colno,filename:k.filename,lineno:k.lineno,message:k.message}));break}}return _},ay=(i,t,n,r,a,c,l,h,f,d,_,v,b,S,w,N)=>(A,k,V)=>{const H=new WeakMap;let z=null;const I=async(R,F)=>{let W=_(R),tt=null;const Z=ye(W,F),J=Array.isArray(k.outputChannelCount)?k.outputChannelCount:Array.from(k.outputChannelCount);if(v===null){const K=J.reduce((C,E)=>C+E,0),it=a(F,{channelCount:Math.max(1,K),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,K)}),j=[];for(let C=0;C<R.numberOfOutputs;C+=1)j.push(r(F,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:J[C]}));const y=l(F,{channelCount:k.channelCount,channelCountMode:k.channelCountMode,channelInterpretation:k.channelInterpretation,gain:1});y.connect=t.bind(null,j),y.disconnect=f.bind(null,j),tt=[it,j,y]}else Z||(W=new v(F,A));if(H.set(F,tt===null?W:tt[2]),tt!==null){if(z===null){if(V===void 0)throw new Error("Missing the processor constructor.");if(b===null)throw new Error("Missing the native OfflineAudioContext constructor.");const E=R.channelCount*R.numberOfInputs,P=V.parameterDescriptors===void 0?0:V.parameterDescriptors.length,D=E+P;z=oy(R,D===0?null:await(async()=>{const q=new b(D,Math.ceil(R.context.length/128)*128,F.sampleRate),X=[],ut=[];for(let et=0;et<k.numberOfInputs;et+=1)X.push(l(q,{channelCount:k.channelCount,channelCountMode:k.channelCountMode,channelInterpretation:k.channelInterpretation,gain:1})),ut.push(a(q,{channelCount:k.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:k.channelCount}));const wt=await Promise.all(Array.from(R.parameters.values()).map(async et=>{const It=c(q,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:et.value});return await S(q,et,It.offset),It})),at=r(q,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,E+P)});for(let et=0;et<k.numberOfInputs;et+=1){X[et].connect(ut[et]);for(let It=0;It<k.channelCount;It+=1)ut[et].connect(at,It,et*k.channelCount+It)}for(const[et,It]of wt.entries())It.connect(at,0,E+et),It.start(0);return at.connect(q.destination),await Promise.all(X.map(et=>w(R,q,et))),N(q)})(),F,k,J,V,d)}const K=await z,it=n(F,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[j,y,C]=tt;K!==null&&(it.buffer=K,it.start(0)),it.connect(j);for(let E=0,P=0;E<R.numberOfOutputs;E+=1){const D=y[E];for(let G=0;G<J[E];G+=1)j.connect(D,P+G,G);P+=J[E]}return C}if(Z)for(const[K,it]of R.parameters.entries())await i(F,it,W.parameters.get(K));else for(const[K,it]of R.parameters.entries())await S(F,it,W.parameters.get(K));return await w(R,F,W),W};return{render(R,F){h(F,R);const W=H.get(F);return W!==void 0?Promise.resolve(W):I(R,F)}}},cy=(i,t,n,r,a,c,l,h,f,d,_,v,b,S,w,N,A,k,V,H)=>class extends w{constructor(I,R){super(I,R),this._nativeContext=I,this._audioWorklet=i===void 0?void 0:{addModule:(F,W)=>i(this,F,W)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new a(this)}createBuffer(I,R,F){return new n({length:R,numberOfChannels:I,sampleRate:F})}createBufferSource(){return new r(this)}createChannelMerger(I=6){return new c(this,{numberOfInputs:I})}createChannelSplitter(I=6){return new l(this,{numberOfOutputs:I})}createConstantSource(){return new h(this)}createConvolver(){return new f(this)}createDelay(I=1){return new _(this,{maxDelayTime:I})}createDynamicsCompressor(){return new v(this)}createGain(){return new b(this)}createIIRFilter(I,R){return new S(this,{feedback:R,feedforward:I})}createOscillator(){return new N(this)}createPanner(){return new A(this)}createPeriodicWave(I,R,F={disableNormalization:!1}){return new k(this,{...F,imag:R,real:I})}createStereoPanner(){return new V(this)}createWaveShaper(){return new H(this)}decodeAudioData(I,R,F){return d(this._nativeContext,I).then(W=>(typeof R=="function"&&R(W),W),W=>{throw typeof F=="function"&&F(W),W})}},uy={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},ly=(i,t,n,r,a,c,l,h)=>class extends i{constructor(d,_){const v=c(d),b={...uy,..._},S=a(v,b),w=l(v),N=w?n():null;super(d,!1,S,N),this._Q=t(this,w,S.Q,Se,Me),this._detune=t(this,w,S.detune,1200*Math.log2(Se),-1200*Math.log2(Se)),this._frequency=t(this,w,S.frequency,d.sampleRate/2,0),this._gain=t(this,w,S.gain,40*Math.log10(Se),Me),this._nativeBiquadFilterNode=S,h(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(d){this._nativeBiquadFilterNode.type=d}getFrequencyResponse(d,_,v){try{this._nativeBiquadFilterNode.getFrequencyResponse(d,_,v)}catch(b){throw b.code===11?r():b}if(d.length!==_.length||_.length!==v.length)throw r()}},hy=(i,t,n,r,a)=>()=>{const c=new WeakMap,l=async(h,f)=>{let d=n(h);const _=ye(d,f);if(!_){const v={Q:d.Q.value,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,gain:d.gain.value,type:d.type};d=t(f,v)}return c.set(f,d),_?(await i(f,h.Q,d.Q),await i(f,h.detune,d.detune),await i(f,h.frequency,d.frequency),await i(f,h.gain,d.gain)):(await r(f,h.Q,d.Q),await r(f,h.detune,d.detune),await r(f,h.frequency,d.frequency),await r(f,h.gain,d.gain)),await a(h,f,d),d};return{render(h,f){const d=c.get(f);return d!==void 0?Promise.resolve(d):l(h,f)}}},fy=(i,t)=>(n,r)=>{const a=t.get(n);if(a!==void 0)return a;const c=i.get(n);if(c!==void 0)return c;try{const l=r();return l instanceof Promise?(i.set(n,l),l.catch(()=>!1).then(h=>(i.delete(n),t.set(n,h),h))):(t.set(n,l),l)}catch{return t.set(n,!1),!1}},dy={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},py=(i,t,n,r,a)=>class extends i{constructor(l,h){const f=r(l),d={...dy,...h},_=n(f,d),v=a(f)?t():null;super(l,!1,_,v)}},_y=(i,t,n)=>()=>{const r=new WeakMap,a=async(c,l)=>{let h=t(c);if(!ye(h,l)){const d={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,numberOfInputs:h.numberOfInputs};h=i(l,d)}return r.set(l,h),await n(c,l,h),h};return{render(c,l){const h=r.get(l);return h!==void 0?Promise.resolve(h):a(c,l)}}},my={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},gy=(i,t,n,r,a,c)=>class extends i{constructor(h,f){const d=r(h),_=c({...my,...f}),v=n(d,_),b=a(d)?t():null;super(h,!1,v,b)}},vy=(i,t,n)=>()=>{const r=new WeakMap,a=async(c,l)=>{let h=t(c);if(!ye(h,l)){const d={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,numberOfOutputs:h.numberOfOutputs};h=i(l,d)}return r.set(l,h),await n(c,l,h),h};return{render(c,l){const h=r.get(l);return h!==void 0?Promise.resolve(h):a(c,l)}}},yy=i=>(t,n,r)=>i(n,t,r),wy=i=>(t,n,r=0,a=0)=>{const c=t[r];if(c===void 0)throw i();return Gi(n)?c.connect(n,0,a):c.connect(n,0)},Ty=i=>(t,n)=>{const r=i(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),a=t.createBuffer(1,2,44100);return r.buffer=a,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},by={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Sy=(i,t,n,r,a,c,l)=>class extends i{constructor(f,d){const _=a(f),v={...by,...d},b=r(_,v),S=c(_),w=S?n():null;super(f,!1,b,w),this._constantSourceNodeRenderer=w,this._nativeConstantSourceNode=b,this._offset=t(this,S,b.offset,Se,Me),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(f){const d=typeof f=="function"?l(this,f):null;this._nativeConstantSourceNode.onended=d;const _=this._nativeConstantSourceNode.onended;this._onended=_!==null&&_===d?f:_}start(f=0){if(this._nativeConstantSourceNode.start(f),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=f),this.context.state!=="closed"){Gs(this);const d=()=>{this._nativeConstantSourceNode.removeEventListener("ended",d),Mn(this)&&Dr(this)};this._nativeConstantSourceNode.addEventListener("ended",d)}}stop(f=0){this._nativeConstantSourceNode.stop(f),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=f)}},Cy=(i,t,n,r,a)=>()=>{const c=new WeakMap;let l=null,h=null;const f=async(d,_)=>{let v=n(d);const b=ye(v,_);if(!b){const S={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,offset:v.offset.value};v=t(_,S),l!==null&&v.start(l),h!==null&&v.stop(h)}return c.set(_,v),b?await i(_,d.offset,v.offset):await r(_,d.offset,v.offset),await a(d,_,v),v};return{set start(d){l=d},set stop(d){h=d},render(d,_){const v=c.get(_);return v!==void 0?Promise.resolve(v):f(d,_)}}},Ay=i=>t=>(i[0]=t,i[0]),xy={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Ny=(i,t,n,r,a,c)=>class extends i{constructor(h,f){const d=r(h),_={...xy,...f},v=n(d,_),S=a(d)?t():null;super(h,!1,v,S),this._isBufferNullified=!1,this._nativeConvolverNode=v,_.buffer!==null&&c(this,_.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(h){if(this._nativeConvolverNode.buffer=h,h===null&&this._nativeConvolverNode.buffer!==null){const f=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=f.createBuffer(1,1,f.sampleRate),this._isBufferNullified=!0,c(this,0)}else this._isBufferNullified=!1,c(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(h){this._nativeConvolverNode.normalize=h}},Iy=(i,t,n)=>()=>{const r=new WeakMap,a=async(c,l)=>{let h=t(c);if(!ye(h,l)){const d={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,disableNormalization:!h.normalize};h=i(l,d)}return r.set(l,h),Ks(h)?await n(c,l,h.inputs[0]):await n(c,l,h),h};return{render(c,l){const h=r.get(l);return h!==void 0?Promise.resolve(h):a(c,l)}}},Ey=(i,t)=>(n,r,a)=>{if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(n,r,a)}catch(c){throw c.name==="SyntaxError"?i():c}},Oy=()=>new DOMException("","DataCloneError"),lh=i=>{const{port1:t,port2:n}=new MessageChannel;return new Promise(r=>{const a=()=>{n.onmessage=null,t.close(),n.close(),r()};n.onmessage=()=>a();try{t.postMessage(i,[i])}finally{a()}})},ky=(i,t,n,r,a,c,l,h,f,d,_)=>(v,b)=>{const S=l(v)?v:c(v);if(a.has(b)){const w=n();return Promise.reject(w)}try{a.add(b)}catch{}return t(f,()=>f(S))?S.decodeAudioData(b).then(w=>(lh(b).catch(()=>{}),t(h,()=>h(w))||_(w),i.add(w),w)):new Promise((w,N)=>{const A=async()=>{try{await lh(b)}catch{}},k=V=>{N(V),A()};try{S.decodeAudioData(b,V=>{typeof V.copyFromChannel!="function"&&(d(V),Ja(V)),i.add(V),A().then(()=>w(V))},V=>{k(V===null?r():V)})}catch(V){k(V)}})},My=(i,t,n,r,a,c,l,h)=>(f,d)=>{const _=t.get(f);if(_===void 0)throw new Error("Missing the expected cycle count.");const v=c(f.context),b=h(v);if(_===d){if(t.delete(f),!b&&l(f)){const S=r(f),{outputs:w}=n(f);for(const N of w)if(Fr(N)){const A=r(N[0]);i(S,A,N[1],N[2])}else{const A=a(N[0]);S.connect(A,N[1])}}}else t.set(f,_-d)},Ry={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Dy=(i,t,n,r,a,c,l)=>class extends i{constructor(f,d){const _=a(f),v={...Ry,...d},b=r(_,v),S=c(_),w=S?n(v.maxDelayTime):null;super(f,!1,b,w),this._delayTime=t(this,S,b.delayTime),l(this,v.maxDelayTime)}get delayTime(){return this._delayTime}},Py=(i,t,n,r,a)=>c=>{const l=new WeakMap,h=async(f,d)=>{let _=n(f);const v=ye(_,d);if(!v){const b={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,delayTime:_.delayTime.value,maxDelayTime:c};_=t(d,b)}return l.set(d,_),v?await i(d,f.delayTime,_.delayTime):await r(d,f.delayTime,_.delayTime),await a(f,d,_),_};return{render(f,d){const _=l.get(d);return _!==void 0?Promise.resolve(_):h(f,d)}}},Fy=i=>(t,n,r,a)=>i(t[a],c=>c[0]===n&&c[1]===r),Ly=i=>(t,n)=>{i(t).delete(n)},Wy=i=>"delayTime"in i,Vy=(i,t,n)=>function r(a,c){const l=qi(c)?c:n(i,c);if(Wy(l))return[];if(a[0]===l)return[a];if(a.includes(l))return[];const{outputs:h}=t(l);return Array.from(h).map(f=>r([...a,l],f[0])).reduce((f,d)=>f.concat(d),[])},Mi=(i,t,n)=>{const r=t[n];if(r===void 0)throw i();return r},qy=i=>(t,n=void 0,r=void 0,a=0)=>n===void 0?t.forEach(c=>c.disconnect()):typeof n=="number"?Mi(i,t,n).disconnect():Gi(n)?r===void 0?t.forEach(c=>c.disconnect(n)):a===void 0?Mi(i,t,r).disconnect(n,0):Mi(i,t,r).disconnect(n,0,a):r===void 0?t.forEach(c=>c.disconnect(n)):Mi(i,t,r).disconnect(n,0),By={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Uy=(i,t,n,r,a,c,l,h)=>class extends i{constructor(d,_){const v=c(d),b={...By,..._},S=r(v,b),w=l(v),N=w?n():null;super(d,!1,S,N),this._attack=t(this,w,S.attack),this._knee=t(this,w,S.knee),this._nativeDynamicsCompressorNode=S,this._ratio=t(this,w,S.ratio),this._release=t(this,w,S.release),this._threshold=t(this,w,S.threshold),h(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(d){const _=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=d,d>2)throw this._nativeDynamicsCompressorNode.channelCount=_,a()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(d){const _=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=d,d==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=_,a()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Gy=(i,t,n,r,a)=>()=>{const c=new WeakMap,l=async(h,f)=>{let d=n(h);const _=ye(d,f);if(!_){const v={attack:d.attack.value,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,knee:d.knee.value,ratio:d.ratio.value,release:d.release.value,threshold:d.threshold.value};d=t(f,v)}return c.set(f,d),_?(await i(f,h.attack,d.attack),await i(f,h.knee,d.knee),await i(f,h.ratio,d.ratio),await i(f,h.release,d.release),await i(f,h.threshold,d.threshold)):(await r(f,h.attack,d.attack),await r(f,h.knee,d.knee),await r(f,h.ratio,d.ratio),await r(f,h.release,d.release),await r(f,h.threshold,d.threshold)),await a(h,f,d),d};return{render(h,f){const d=c.get(f);return d!==void 0?Promise.resolve(d):l(h,f)}}},$y=()=>new DOMException("","EncodingError"),Hy=i=>t=>new Promise((n,r)=>{if(i===null){r(new SyntaxError);return}const a=i.document.head;if(a===null)r(new SyntaxError);else{const c=i.document.createElement("script"),l=new Blob([t],{type:"application/javascript"}),h=URL.createObjectURL(l),f=i.onerror,d=()=>{i.onerror=f,URL.revokeObjectURL(h)};i.onerror=(_,v,b,S,w)=>{if(v===h||v===i.location.href&&b===1&&S===1)return d(),r(w),!1;if(f!==null)return f(_,v,b,S,w)},c.onerror=()=>{d(),r(new SyntaxError)},c.onload=()=>{d(),n()},c.src=h,c.type="module",a.appendChild(c)}}),zy=i=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,a){if(r!==null){let c=this._listeners.get(r);c===void 0&&(c=i(this,r),typeof r=="function"&&this._listeners.set(r,c)),this._nativeEventTarget.addEventListener(n,c,a)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,a){const c=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,c===void 0?null:c,a)}},Ky=i=>(t,n,r)=>{Object.defineProperties(i,{currentFrame:{configurable:!0,get(){return Math.round(t*n)}},currentTime:{configurable:!0,get(){return t}}});try{return r()}finally{i!==null&&(delete i.currentFrame,delete i.currentTime)}},Zy=i=>async t=>{try{const n=await fetch(t);if(n.ok)return[await n.text(),n.url]}catch{}throw i()},Yy={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Xy=(i,t,n,r,a,c)=>class extends i{constructor(h,f){const d=a(h),_={...Yy,...f},v=r(d,_),b=c(d),S=b?n():null;super(h,!1,v,S),this._gain=t(this,b,v.gain,Se,Me)}get gain(){return this._gain}},Qy=(i,t,n,r,a)=>()=>{const c=new WeakMap,l=async(h,f)=>{let d=n(h);const _=ye(d,f);if(!_){const v={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,gain:d.gain.value};d=t(f,v)}return c.set(f,d),_?await i(f,h.gain,d.gain):await r(f,h.gain,d.gain),await a(h,f,d),d};return{render(h,f){const d=c.get(f);return d!==void 0?Promise.resolve(d):l(h,f)}}},jy=(i,t)=>n=>t(i,n),Jy=i=>t=>{const n=i(t);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},tw=i=>t=>{var n;return(n=i.get(t))!==null&&n!==void 0?n:0},ew=i=>t=>{const n=i(t);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},nw=i=>t=>i.get(t),de=()=>new DOMException("","InvalidStateError"),sw=i=>t=>{const n=i.get(t);if(n===void 0)throw de();return n},rw=(i,t)=>n=>{let r=i.get(n);if(r!==void 0)return r;if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new t(1,1,44100),i.set(n,r),r},iw=i=>t=>{const n=i.get(t);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},so=()=>new DOMException("","InvalidAccessError"),ow=i=>{i.getFrequencyResponse=(t=>(n,r,a)=>{if(n.length!==r.length||r.length!==a.length)throw so();return t.call(i,n,r,a)})(i.getFrequencyResponse)},aw={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},cw=(i,t,n,r,a,c)=>class extends i{constructor(h,f){const d=r(h),_=a(d),v={...aw,...f},b=t(d,_?null:h.baseLatency,v),S=_?n(v.feedback,v.feedforward):null;super(h,!1,b,S),ow(b),this._nativeIIRFilterNode=b,c(this,1)}getFrequencyResponse(h,f,d){return this._nativeIIRFilterNode.getFrequencyResponse(h,f,d)}},Lh=(i,t,n,r,a,c,l,h,f,d,_)=>{const v=d.length;let b=h;for(let S=0;S<v;S+=1){let w=n[0]*d[S];for(let N=1;N<a;N+=1){const A=b-N&f-1;w+=n[N]*c[A],w-=i[N]*l[A]}for(let N=a;N<r;N+=1)w+=n[N]*c[b-N&f-1];for(let N=a;N<t;N+=1)w-=i[N]*l[b-N&f-1];c[b]=d[S],l[b]=w,b=b+1&f-1,_[S]=w}return b},uw=(i,t,n,r)=>{const a=n instanceof Float64Array?n:new Float64Array(n),c=r instanceof Float64Array?r:new Float64Array(r),l=a.length,h=c.length,f=Math.min(l,h);if(a[0]!==1){for(let w=0;w<l;w+=1)c[w]/=a[0];for(let w=1;w<h;w+=1)a[w]/=a[0]}const d=32,_=new Float32Array(d),v=new Float32Array(d),b=t.createBuffer(i.numberOfChannels,i.length,i.sampleRate),S=i.numberOfChannels;for(let w=0;w<S;w+=1){const N=i.getChannelData(w),A=b.getChannelData(w);_.fill(0),v.fill(0),Lh(a,l,c,h,f,_,v,0,d,N,A)}return b},lw=(i,t,n,r,a)=>(c,l)=>{const h=new WeakMap;let f=null;const d=async(_,v)=>{let b=null,S=t(_);const w=ye(S,v);if(v.createIIRFilter===void 0?b=i(v,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):w||(S=v.createIIRFilter(l,c)),h.set(v,b===null?S:b),b!==null){if(f===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const A=new n(_.context.destination.channelCount,_.context.length,v.sampleRate);f=(async()=>{await r(_,A,A.destination);const k=await a(A);return uw(k,v,c,l)})()}const N=await f;return b.buffer=N,b.start(0),b}return await r(_,v,S),S};return{render(_,v){const b=h.get(v);return b!==void 0?Promise.resolve(b):d(_,v)}}},hw=(i,t,n,r,a,c)=>l=>(h,f)=>{const d=i.get(h);if(d===void 0){if(!l&&c(h)){const _=r(h),{outputs:v}=n(h);for(const b of v)if(Fr(b)){const S=r(b[0]);t(_,S,b[1],b[2])}else{const S=a(b[0]);_.disconnect(S,b[1])}}i.set(h,f)}else i.set(h,d+f)},fw=(i,t)=>n=>{const r=i.get(n);return t(r)||t(n)},dw=(i,t)=>n=>i.has(n)||t(n),pw=(i,t)=>n=>i.has(n)||t(n),_w=(i,t)=>n=>{const r=i.get(n);return t(r)||t(n)},mw=i=>t=>i!==null&&t instanceof i,gw=i=>t=>i!==null&&typeof i.AudioNode=="function"&&t instanceof i.AudioNode,vw=i=>t=>i!==null&&typeof i.AudioParam=="function"&&t instanceof i.AudioParam,yw=(i,t)=>n=>i(n)||t(n),ww=i=>t=>i!==null&&t instanceof i,Tw=i=>i!==null&&i.isSecureContext,bw=(i,t,n,r)=>class extends i{constructor(c,l){const h=n(c),f=t(h,l);if(r(h))throw TypeError();super(c,!0,f,null),this._nativeMediaElementAudioSourceNode=f}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},Sw={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Cw=(i,t,n,r)=>class extends i{constructor(c,l){const h=n(c);if(r(h))throw new TypeError;const f={...Sw,...l},d=t(h,f);super(c,!1,d,null),this._nativeMediaStreamAudioDestinationNode=d}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},Aw=(i,t,n,r)=>class extends i{constructor(c,l){const h=n(c),f=t(h,l);if(r(h))throw new TypeError;super(c,!0,f,null),this._nativeMediaStreamAudioSourceNode=f}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},xw=(i,t,n)=>class extends i{constructor(a,c){const l=n(a),h=t(l,c);super(a,!0,h,null)}},Nw=(i,t,n,r,a,c)=>class extends n{constructor(h,f){super(h),this._nativeContext=h,eo.set(this,h),r(h)&&a.set(h,new Set),this._destination=new i(this,f),this._listener=t(this,h),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(h){const f=typeof h=="function"?c(this,h):null;this._nativeContext.onstatechange=f;const d=this._nativeContext.onstatechange;this._onstatechange=d!==null&&d===f?h:d}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},yr=i=>{const t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=i.decodeAudioData(t.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},Iw=(i,t)=>(n,r,a)=>{const c=new Set;return n.connect=(l=>(h,f=0,d=0)=>{const _=c.size===0;if(t(h))return l.call(n,h,f,d),i(c,[h,f,d],v=>v[0]===h&&v[1]===f&&v[2]===d,!0),_&&r(),h;l.call(n,h,f),i(c,[h,f],v=>v[0]===h&&v[1]===f,!0),_&&r()})(n.connect),n.disconnect=(l=>(h,f,d)=>{const _=c.size>0;if(h===void 0)l.apply(n),c.clear();else if(typeof h=="number"){l.call(n,h);for(const b of c)b[1]===h&&c.delete(b)}else{t(h)?l.call(n,h,f,d):l.call(n,h,f);for(const b of c)b[0]===h&&(f===void 0||b[1]===f)&&(d===void 0||b[2]===d)&&c.delete(b)}const v=c.size===0;_&&v&&a()})(n.disconnect),n},Xt=(i,t,n)=>{const r=t[n];r!==void 0&&r!==i[n]&&(i[n]=r)},ue=(i,t)=>{Xt(i,t,"channelCount"),Xt(i,t,"channelCountMode"),Xt(i,t,"channelInterpretation")},hh=i=>typeof i.getFloatTimeDomainData=="function",Ew=i=>{i.getFloatTimeDomainData=t=>{const n=new Uint8Array(t.length);i.getByteTimeDomainData(n);const r=Math.max(n.length,i.fftSize);for(let a=0;a<r;a+=1)t[a]=(n[a]-128)*.0078125;return t}},Ow=(i,t)=>(n,r)=>{const a=n.createAnalyser();if(ue(a,r),!(r.maxDecibels>r.minDecibels))throw t();return Xt(a,r,"fftSize"),Xt(a,r,"maxDecibels"),Xt(a,r,"minDecibels"),Xt(a,r,"smoothingTimeConstant"),i(hh,()=>hh(a))||Ew(a),a},kw=i=>i===null?null:i.hasOwnProperty("AudioBuffer")?i.AudioBuffer:null,Jt=(i,t,n)=>{const r=t[n];r!==void 0&&r!==i[n].value&&(i[n].value=r)},Mw=i=>{i.start=(t=>{let n=!1;return(r=0,a=0,c)=>{if(n)throw de();t.call(i,r,a,c),n=!0}})(i.start)},nc=i=>{i.start=(t=>(n=0,r=0,a)=>{if(typeof a=="number"&&a<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");t.call(i,n,r,a)})(i.start)},sc=i=>{i.stop=(t=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");t.call(i,n)})(i.stop)},Rw=(i,t,n,r,a,c,l,h,f,d,_)=>(v,b)=>{const S=v.createBufferSource();return ue(S,b),Jt(S,b,"playbackRate"),Xt(S,b,"buffer"),Xt(S,b,"loop"),Xt(S,b,"loopEnd"),Xt(S,b,"loopStart"),t(n,()=>n(v))||Mw(S),t(r,()=>r(v))||f(S),t(a,()=>a(v))||d(S,v),t(c,()=>c(v))||nc(S),t(l,()=>l(v))||_(S,v),t(h,()=>h(v))||sc(S),i(v,S),S},Dw=i=>i===null?null:i.hasOwnProperty("AudioContext")?i.AudioContext:i.hasOwnProperty("webkitAudioContext")?i.webkitAudioContext:null,Pw=(i,t)=>(n,r,a)=>{const c=n.destination;if(c.channelCount!==r)try{c.channelCount=r}catch{}a&&c.channelCountMode!=="explicit"&&(c.channelCountMode="explicit"),c.maxChannelCount===0&&Object.defineProperty(c,"maxChannelCount",{value:r});const l=i(n,{channelCount:r,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:1});return t(l,"channelCount",h=>()=>h.call(l),h=>f=>{h.call(l,f);try{c.channelCount=f}catch(d){if(f>c.maxChannelCount)throw d}}),t(l,"channelCountMode",h=>()=>h.call(l),h=>f=>{h.call(l,f),c.channelCountMode=f}),t(l,"channelInterpretation",h=>()=>h.call(l),h=>f=>{h.call(l,f),c.channelInterpretation=f}),Object.defineProperty(l,"maxChannelCount",{get:()=>c.maxChannelCount}),l.connect(c),l},Fw=i=>i===null?null:i.hasOwnProperty("AudioWorkletNode")?i.AudioWorkletNode:null,Lw=i=>{const{port1:t}=new MessageChannel;try{t.postMessage(i)}finally{t.close()}},Ww=(i,t,n,r,a)=>(c,l,h,f,d,_)=>{if(h!==null)try{const v=new h(c,f,_),b=new Map;let S=null;if(Object.defineProperties(v,{channelCount:{get:()=>_.channelCount,set:()=>{throw i()}},channelCountMode:{get:()=>"explicit",set:()=>{throw i()}},onprocessorerror:{get:()=>S,set:w=>{typeof S=="function"&&v.removeEventListener("processorerror",S),S=typeof w=="function"?w:null,typeof S=="function"&&v.addEventListener("processorerror",S)}}}),v.addEventListener=(w=>(...N)=>{if(N[0]==="processorerror"){const A=typeof N[1]=="function"?N[1]:typeof N[1]=="object"&&N[1]!==null&&typeof N[1].handleEvent=="function"?N[1].handleEvent:null;if(A!==null){const k=b.get(N[1]);k!==void 0?N[1]=k:(N[1]=V=>{V.type==="error"?(Object.defineProperties(V,{type:{value:"processorerror"}}),A(V)):A(new ErrorEvent(N[0],{...V}))},b.set(A,N[1]))}}return w.call(v,"error",N[1],N[2]),w.call(v,...N)})(v.addEventListener),v.removeEventListener=(w=>(...N)=>{if(N[0]==="processorerror"){const A=b.get(N[1]);A!==void 0&&(b.delete(N[1]),N[1]=A)}return w.call(v,"error",N[1],N[2]),w.call(v,N[0],N[1],N[2])})(v.removeEventListener),_.numberOfOutputs!==0){const w=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return v.connect(w).connect(c.destination),a(v,()=>w.disconnect(),()=>w.connect(c.destination))}return v}catch(v){throw v.code===11?r():v}if(d===void 0)throw r();return Lw(_),t(c,l,d,_)},Wh=(i,t)=>i===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(i*t))))),Vw=i=>new Promise((t,n)=>{const{port1:r,port2:a}=new MessageChannel;r.onmessage=({data:c})=>{r.close(),a.close(),t(c)},r.onmessageerror=({data:c})=>{r.close(),a.close(),n(c)},a.postMessage(i)}),qw=async(i,t)=>{const n=await Vw(t);return new i(n)},Bw=(i,t,n,r)=>{let a=Ga.get(i);a===void 0&&(a=new WeakMap,Ga.set(i,a));const c=qw(n,r);return a.set(t,c),c},Uw=(i,t,n,r,a,c,l,h,f,d,_,v,b)=>(S,w,N,A)=>{if(A.numberOfInputs===0&&A.numberOfOutputs===0)throw f();const k=Array.isArray(A.outputChannelCount)?A.outputChannelCount:Array.from(A.outputChannelCount);if(k.some(nt=>nt<1))throw f();if(k.length!==A.numberOfOutputs)throw t();if(A.channelCountMode!=="explicit")throw f();const V=A.channelCount*A.numberOfInputs,H=k.reduce((nt,lt)=>nt+lt,0),z=N.parameterDescriptors===void 0?0:N.parameterDescriptors.length;if(V+z>6||H>6)throw f();const I=new MessageChannel,R=[],F=[];for(let nt=0;nt<A.numberOfInputs;nt+=1)R.push(l(S,{channelCount:A.channelCount,channelCountMode:A.channelCountMode,channelInterpretation:A.channelInterpretation,gain:1})),F.push(a(S,{channelCount:A.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:A.channelCount}));const W=[];if(N.parameterDescriptors!==void 0)for(const{defaultValue:nt,maxValue:lt,minValue:kt,name:Mt}of N.parameterDescriptors){const At=c(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:A.parameterData[Mt]!==void 0?A.parameterData[Mt]:nt===void 0?0:nt});Object.defineProperties(At.offset,{defaultValue:{get:()=>nt===void 0?0:nt},maxValue:{get:()=>lt===void 0?Se:lt},minValue:{get:()=>kt===void 0?Me:kt}}),W.push(At)}const tt=r(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,V+z)}),Z=Wh(w,S.sampleRate),J=h(S,Z,V+z,Math.max(1,H)),K=a(S,{channelCount:Math.max(1,H),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,H)}),it=[];for(let nt=0;nt<A.numberOfOutputs;nt+=1)it.push(r(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:k[nt]}));for(let nt=0;nt<A.numberOfInputs;nt+=1){R[nt].connect(F[nt]);for(let lt=0;lt<A.channelCount;lt+=1)F[nt].connect(tt,lt,nt*A.channelCount+lt)}const j=new Ph(N.parameterDescriptors===void 0?[]:N.parameterDescriptors.map(({name:nt},lt)=>{const kt=W[lt];return kt.connect(tt,0,V+lt),kt.start(0),[nt,kt.offset]}));tt.connect(J);let y=A.channelInterpretation,C=null;const E=A.numberOfOutputs===0?[J]:it,P={get bufferSize(){return Z},get channelCount(){return A.channelCount},set channelCount(nt){throw n()},get channelCountMode(){return A.channelCountMode},set channelCountMode(nt){throw n()},get channelInterpretation(){return y},set channelInterpretation(nt){for(const lt of R)lt.channelInterpretation=nt;y=nt},get context(){return J.context},get inputs(){return R},get numberOfInputs(){return A.numberOfInputs},get numberOfOutputs(){return A.numberOfOutputs},get onprocessorerror(){return C},set onprocessorerror(nt){typeof C=="function"&&P.removeEventListener("processorerror",C),C=typeof nt=="function"?nt:null,typeof C=="function"&&P.addEventListener("processorerror",C)},get parameters(){return j},get port(){return I.port2},addEventListener(...nt){return J.addEventListener(nt[0],nt[1],nt[2])},connect:i.bind(null,E),disconnect:d.bind(null,E),dispatchEvent(...nt){return J.dispatchEvent(nt[0])},removeEventListener(...nt){return J.removeEventListener(nt[0],nt[1],nt[2])}},D=new Map;I.port1.addEventListener=(nt=>(...lt)=>{if(lt[0]==="message"){const kt=typeof lt[1]=="function"?lt[1]:typeof lt[1]=="object"&&lt[1]!==null&&typeof lt[1].handleEvent=="function"?lt[1].handleEvent:null;if(kt!==null){const Mt=D.get(lt[1]);Mt!==void 0?lt[1]=Mt:(lt[1]=At=>{_(S.currentTime,S.sampleRate,()=>kt(At))},D.set(kt,lt[1]))}}return nt.call(I.port1,lt[0],lt[1],lt[2])})(I.port1.addEventListener),I.port1.removeEventListener=(nt=>(...lt)=>{if(lt[0]==="message"){const kt=D.get(lt[1]);kt!==void 0&&(D.delete(lt[1]),lt[1]=kt)}return nt.call(I.port1,lt[0],lt[1],lt[2])})(I.port1.removeEventListener);let G=null;Object.defineProperty(I.port1,"onmessage",{get:()=>G,set:nt=>{typeof G=="function"&&I.port1.removeEventListener("message",G),G=typeof nt=="function"?nt:null,typeof G=="function"&&(I.port1.addEventListener("message",G),I.port1.start())}}),N.prototype.port=I.port1;let q=null;Bw(S,P,N,A).then(nt=>q=nt);const ut=Hi(A.numberOfInputs,A.channelCount),wt=Hi(A.numberOfOutputs,k),at=N.parameterDescriptors===void 0?[]:N.parameterDescriptors.reduce((nt,{name:lt})=>({...nt,[lt]:new Float32Array(128)}),{});let et=!0;const It=()=>{A.numberOfOutputs>0&&J.disconnect(K);for(let nt=0,lt=0;nt<A.numberOfOutputs;nt+=1){const kt=it[nt];for(let Mt=0;Mt<k[nt];Mt+=1)K.disconnect(kt,lt+Mt,Mt);lt+=k[nt]}},Y=new Map;J.onaudioprocess=({inputBuffer:nt,outputBuffer:lt})=>{if(q!==null){const kt=v(P);for(let Mt=0;Mt<Z;Mt+=128){for(let At=0;At<A.numberOfInputs;At+=1)for(let Ft=0;Ft<A.channelCount;Ft+=1)$i(nt,ut[At],Ft,Ft,Mt);N.parameterDescriptors!==void 0&&N.parameterDescriptors.forEach(({name:At},Ft)=>{$i(nt,at,At,V+Ft,Mt)});for(let At=0;At<A.numberOfInputs;At+=1)for(let Ft=0;Ft<k[At];Ft+=1)wt[At][Ft].byteLength===0&&(wt[At][Ft]=new Float32Array(128));try{const At=ut.map((Kt,Ne)=>{if(kt[Ne].size>0)return Y.set(Ne,Z/128),Kt;const Js=Y.get(Ne);return Js===void 0?[]:(Kt.every(Jn=>Jn.every(ho=>ho===0))&&(Js===1?Y.delete(Ne):Y.set(Ne,Js-1)),Kt)});et=_(S.currentTime+Mt/S.sampleRate,S.sampleRate,()=>q.process(At,wt,at));for(let Kt=0,Ne=0;Kt<A.numberOfOutputs;Kt+=1){for(let hn=0;hn<k[Kt];hn+=1)Fh(lt,wt[Kt],hn,Ne+hn,Mt);Ne+=k[Kt]}}catch(At){et=!1,P.dispatchEvent(new ErrorEvent("processorerror",{colno:At.colno,filename:At.filename,lineno:At.lineno,message:At.message}))}if(!et){for(let At=0;At<A.numberOfInputs;At+=1){R[At].disconnect(F[At]);for(let Ft=0;Ft<A.channelCount;Ft+=1)F[Mt].disconnect(tt,Ft,At*A.channelCount+Ft)}if(N.parameterDescriptors!==void 0){const At=N.parameterDescriptors.length;for(let Ft=0;Ft<At;Ft+=1){const Kt=W[Ft];Kt.disconnect(tt,0,V+Ft),Kt.stop()}}tt.disconnect(J),J.onaudioprocess=null,_t?It():he();break}}}};let _t=!1;const Ot=l(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Wt=()=>J.connect(Ot).connect(S.destination),he=()=>{J.disconnect(Ot),Ot.disconnect()},bt=()=>{if(et){he(),A.numberOfOutputs>0&&J.connect(K);for(let nt=0,lt=0;nt<A.numberOfOutputs;nt+=1){const kt=it[nt];for(let Mt=0;Mt<k[nt];Mt+=1)K.connect(kt,lt+Mt,Mt);lt+=k[nt]}}_t=!0},Bt=()=>{et&&(Wt(),It()),_t=!1};return Wt(),b(P,bt,Bt)},Vh=(i,t)=>{const n=i.createBiquadFilter();return ue(n,t),Jt(n,t,"Q"),Jt(n,t,"detune"),Jt(n,t,"frequency"),Jt(n,t,"gain"),Xt(n,t,"type"),n},Gw=(i,t)=>(n,r)=>{const a=n.createChannelMerger(r.numberOfInputs);return i!==null&&i.name==="webkitAudioContext"&&t(n,a),ue(a,r),a},$w=i=>{const t=i.numberOfOutputs;Object.defineProperty(i,"channelCount",{get:()=>t,set:n=>{if(n!==t)throw de()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw de()}}),Object.defineProperty(i,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw de()}})},Lr=(i,t)=>{const n=i.createChannelSplitter(t.numberOfOutputs);return ue(n,t),$w(n),n},Hw=(i,t,n,r,a)=>(c,l)=>{if(c.createConstantSource===void 0)return n(c,l);const h=c.createConstantSource();return ue(h,l),Jt(h,l,"offset"),t(r,()=>r(c))||nc(h),t(a,()=>a(c))||sc(h),i(c,h),h},Zs=(i,t)=>(i.connect=t.connect.bind(t),i.disconnect=t.disconnect.bind(t),i),zw=(i,t,n,r)=>(a,{offset:c,...l})=>{const h=a.createBuffer(1,2,44100),f=t(a,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),d=n(a,{...l,gain:c}),_=h.getChannelData(0);_[0]=1,_[1]=1,f.buffer=h,f.loop=!0;const v={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(w){d.channelCount=w},get channelCountMode(){return d.channelCountMode},set channelCountMode(w){d.channelCountMode=w},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(w){d.channelInterpretation=w},get context(){return d.context},get inputs(){return[]},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get offset(){return d.gain},get onended(){return f.onended},set onended(w){f.onended=w},addEventListener(...w){return f.addEventListener(w[0],w[1],w[2])},dispatchEvent(...w){return f.dispatchEvent(w[0])},removeEventListener(...w){return f.removeEventListener(w[0],w[1],w[2])},start(w=0){f.start.call(f,w)},stop(w=0){f.stop.call(f,w)}},b=()=>f.connect(d),S=()=>f.disconnect(d);return i(a,f),r(Zs(v,d),b,S)},Kw=(i,t)=>(n,r)=>{const a=n.createConvolver();if(ue(a,r),r.disableNormalization===a.normalize&&(a.normalize=!r.disableNormalization),Xt(a,r,"buffer"),r.channelCount>2||(t(a,"channelCount",c=>()=>c.call(a),c=>l=>{if(l>2)throw i();return c.call(a,l)}),r.channelCountMode==="max"))throw i();return t(a,"channelCountMode",c=>()=>c.call(a),c=>l=>{if(l==="max")throw i();return c.call(a,l)}),a},qh=(i,t)=>{const n=i.createDelay(t.maxDelayTime);return ue(n,t),Jt(n,t,"delayTime"),n},Zw=i=>(t,n)=>{const r=t.createDynamicsCompressor();if(ue(r,n),n.channelCount>2||n.channelCountMode==="max")throw i();return Jt(r,n,"attack"),Jt(r,n,"knee"),Jt(r,n,"ratio"),Jt(r,n,"release"),Jt(r,n,"threshold"),r},De=(i,t)=>{const n=i.createGain();return ue(n,t),Jt(n,t,"gain"),n},Yw=i=>(t,n,r)=>{if(t.createIIRFilter===void 0)return i(t,n,r);const a=t.createIIRFilter(r.feedforward,r.feedback);return ue(a,r),a};function Xw(i,t){const n=t[0]*t[0]+t[1]*t[1];return[(i[0]*t[0]+i[1]*t[1])/n,(i[1]*t[0]-i[0]*t[1])/n]}function Qw(i,t){return[i[0]*t[0]-i[1]*t[1],i[0]*t[1]+i[1]*t[0]]}function fh(i,t){let n=[0,0];for(let r=i.length-1;r>=0;r-=1)n=Qw(n,t),n[0]+=i[r];return n}const jw=(i,t,n,r)=>(a,c,{channelCount:l,channelCountMode:h,channelInterpretation:f,feedback:d,feedforward:_})=>{const v=Wh(c,a.sampleRate),b=d instanceof Float64Array?d:new Float64Array(d),S=_ instanceof Float64Array?_:new Float64Array(_),w=b.length,N=S.length,A=Math.min(w,N);if(w===0||w>20)throw r();if(b[0]===0)throw t();if(N===0||N>20)throw r();if(S[0]===0)throw t();if(b[0]!==1){for(let W=0;W<N;W+=1)S[W]/=b[0];for(let W=1;W<w;W+=1)b[W]/=b[0]}const k=n(a,v,l,l);k.channelCount=l,k.channelCountMode=h,k.channelInterpretation=f;const V=32,H=[],z=[],I=[];for(let W=0;W<l;W+=1){H.push(0);const tt=new Float32Array(V),Z=new Float32Array(V);tt.fill(0),Z.fill(0),z.push(tt),I.push(Z)}k.onaudioprocess=W=>{const tt=W.inputBuffer,Z=W.outputBuffer,J=tt.numberOfChannels;for(let K=0;K<J;K+=1){const it=tt.getChannelData(K),j=Z.getChannelData(K);H[K]=Lh(b,w,S,N,A,z[K],I[K],H[K],V,it,j)}};const R=a.sampleRate/2;return Zs({get bufferSize(){return v},get channelCount(){return k.channelCount},set channelCount(W){k.channelCount=W},get channelCountMode(){return k.channelCountMode},set channelCountMode(W){k.channelCountMode=W},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(W){k.channelInterpretation=W},get context(){return k.context},get inputs(){return[k]},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},addEventListener(...W){return k.addEventListener(W[0],W[1],W[2])},dispatchEvent(...W){return k.dispatchEvent(W[0])},getFrequencyResponse(W,tt,Z){if(W.length!==tt.length||tt.length!==Z.length)throw i();const J=W.length;for(let K=0;K<J;K+=1){const it=-Math.PI*(W[K]/R),j=[Math.cos(it),Math.sin(it)],y=fh(S,j),C=fh(b,j),E=Xw(y,C);tt[K]=Math.sqrt(E[0]*E[0]+E[1]*E[1]),Z[K]=Math.atan2(E[1],E[0])}},removeEventListener(...W){return k.removeEventListener(W[0],W[1],W[2])}},k)},Jw=(i,t)=>i.createMediaElementSource(t.mediaElement),tT=(i,t)=>{const n=i.createMediaStreamDestination();return ue(n,t),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},eT=(i,{mediaStream:t})=>{const n=t.getAudioTracks();n.sort((c,l)=>c.id<l.id?-1:c.id>l.id?1:0);const r=n.slice(0,1),a=i.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(a,"mediaStream",{value:t}),a},nT=(i,t)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const a=new MediaStream([r]),c=n.createMediaStreamSource(a);if(r.kind!=="audio")throw i();if(t(n))throw new TypeError;return c},sT=i=>i===null?null:i.hasOwnProperty("OfflineAudioContext")?i.OfflineAudioContext:i.hasOwnProperty("webkitOfflineAudioContext")?i.webkitOfflineAudioContext:null,rT=(i,t,n,r,a,c)=>(l,h)=>{const f=l.createOscillator();return ue(f,h),Jt(f,h,"detune"),Jt(f,h,"frequency"),h.periodicWave!==void 0?f.setPeriodicWave(h.periodicWave):Xt(f,h,"type"),t(n,()=>n(l))||nc(f),t(r,()=>r(l))||c(f,l),t(a,()=>a(l))||sc(f),i(l,f),f},iT=i=>(t,n)=>{const r=t.createPanner();return r.orientationX===void 0?i(t,n):(ue(r,n),Jt(r,n,"orientationX"),Jt(r,n,"orientationY"),Jt(r,n,"orientationZ"),Jt(r,n,"positionX"),Jt(r,n,"positionY"),Jt(r,n,"positionZ"),Xt(r,n,"coneInnerAngle"),Xt(r,n,"coneOuterAngle"),Xt(r,n,"coneOuterGain"),Xt(r,n,"distanceModel"),Xt(r,n,"maxDistance"),Xt(r,n,"panningModel"),Xt(r,n,"refDistance"),Xt(r,n,"rolloffFactor"),r)},oT=(i,t,n,r,a,c,l,h,f,d)=>(_,{coneInnerAngle:v,coneOuterAngle:b,coneOuterGain:S,distanceModel:w,maxDistance:N,orientationX:A,orientationY:k,orientationZ:V,panningModel:H,positionX:z,positionY:I,positionZ:R,refDistance:F,rolloffFactor:W,...tt})=>{const Z=_.createPanner();if(tt.channelCount>2||tt.channelCountMode==="max")throw l();ue(Z,tt);const J={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},K=n(_,{...J,channelInterpretation:"speakers",numberOfInputs:6}),it=r(_,{...tt,gain:1}),j=r(_,{...J,gain:1}),y=r(_,{...J,gain:0}),C=r(_,{...J,gain:0}),E=r(_,{...J,gain:0}),P=r(_,{...J,gain:0}),D=r(_,{...J,gain:0}),G=a(_,256,6,1),q=c(_,{...J,curve:new Float32Array([1,1]),oversample:"none"});let X=[A,k,V],ut=[z,I,R];const wt=new Float32Array(1);G.onaudioprocess=({inputBuffer:Y})=>{const _t=[f(Y,wt,0),f(Y,wt,1),f(Y,wt,2)];_t.some((Wt,he)=>Wt!==X[he])&&(Z.setOrientation(..._t),X=_t);const Ot=[f(Y,wt,3),f(Y,wt,4),f(Y,wt,5)];Ot.some((Wt,he)=>Wt!==ut[he])&&(Z.setPosition(...Ot),ut=Ot)},Object.defineProperty(y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(C.gain,"defaultValue",{get:()=>0}),Object.defineProperty(E.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0});const at={get bufferSize(){},get channelCount(){return Z.channelCount},set channelCount(Y){if(Y>2)throw l();it.channelCount=Y,Z.channelCount=Y},get channelCountMode(){return Z.channelCountMode},set channelCountMode(Y){if(Y==="max")throw l();it.channelCountMode=Y,Z.channelCountMode=Y},get channelInterpretation(){return Z.channelInterpretation},set channelInterpretation(Y){it.channelInterpretation=Y,Z.channelInterpretation=Y},get coneInnerAngle(){return Z.coneInnerAngle},set coneInnerAngle(Y){Z.coneInnerAngle=Y},get coneOuterAngle(){return Z.coneOuterAngle},set coneOuterAngle(Y){Z.coneOuterAngle=Y},get coneOuterGain(){return Z.coneOuterGain},set coneOuterGain(Y){if(Y<0||Y>1)throw t();Z.coneOuterGain=Y},get context(){return Z.context},get distanceModel(){return Z.distanceModel},set distanceModel(Y){Z.distanceModel=Y},get inputs(){return[it]},get maxDistance(){return Z.maxDistance},set maxDistance(Y){if(Y<0)throw new RangeError;Z.maxDistance=Y},get numberOfInputs(){return Z.numberOfInputs},get numberOfOutputs(){return Z.numberOfOutputs},get orientationX(){return j.gain},get orientationY(){return y.gain},get orientationZ(){return C.gain},get panningModel(){return Z.panningModel},set panningModel(Y){Z.panningModel=Y},get positionX(){return E.gain},get positionY(){return P.gain},get positionZ(){return D.gain},get refDistance(){return Z.refDistance},set refDistance(Y){if(Y<0)throw new RangeError;Z.refDistance=Y},get rolloffFactor(){return Z.rolloffFactor},set rolloffFactor(Y){if(Y<0)throw new RangeError;Z.rolloffFactor=Y},addEventListener(...Y){return it.addEventListener(Y[0],Y[1],Y[2])},dispatchEvent(...Y){return it.dispatchEvent(Y[0])},removeEventListener(...Y){return it.removeEventListener(Y[0],Y[1],Y[2])}};v!==at.coneInnerAngle&&(at.coneInnerAngle=v),b!==at.coneOuterAngle&&(at.coneOuterAngle=b),S!==at.coneOuterGain&&(at.coneOuterGain=S),w!==at.distanceModel&&(at.distanceModel=w),N!==at.maxDistance&&(at.maxDistance=N),A!==at.orientationX.value&&(at.orientationX.value=A),k!==at.orientationY.value&&(at.orientationY.value=k),V!==at.orientationZ.value&&(at.orientationZ.value=V),H!==at.panningModel&&(at.panningModel=H),z!==at.positionX.value&&(at.positionX.value=z),I!==at.positionY.value&&(at.positionY.value=I),R!==at.positionZ.value&&(at.positionZ.value=R),F!==at.refDistance&&(at.refDistance=F),W!==at.rolloffFactor&&(at.rolloffFactor=W),(X[0]!==1||X[1]!==0||X[2]!==0)&&Z.setOrientation(...X),(ut[0]!==0||ut[1]!==0||ut[2]!==0)&&Z.setPosition(...ut);const et=()=>{it.connect(Z),i(it,q,0,0),q.connect(j).connect(K,0,0),q.connect(y).connect(K,0,1),q.connect(C).connect(K,0,2),q.connect(E).connect(K,0,3),q.connect(P).connect(K,0,4),q.connect(D).connect(K,0,5),K.connect(G).connect(_.destination)},It=()=>{it.disconnect(Z),h(it,q,0,0),q.disconnect(j),j.disconnect(K),q.disconnect(y),y.disconnect(K),q.disconnect(C),C.disconnect(K),q.disconnect(E),E.disconnect(K),q.disconnect(P),P.disconnect(K),q.disconnect(D),D.disconnect(K),K.disconnect(G),G.disconnect(_.destination)};return d(Zs(at,Z),et,It)},aT=i=>(t,{disableNormalization:n,imag:r,real:a})=>{const c=r instanceof Float32Array?r:new Float32Array(r),l=a instanceof Float32Array?a:new Float32Array(a),h=t.createPeriodicWave(l,c,{disableNormalization:n});if(Array.from(r).length<2)throw i();return h},Wr=(i,t,n,r)=>i.createScriptProcessor(t,n,r),cT=(i,t)=>(n,r)=>{const a=r.channelCountMode;if(a==="clamped-max")throw t();if(n.createStereoPanner===void 0)return i(n,r);const c=n.createStereoPanner();return ue(c,r),Jt(c,r,"pan"),Object.defineProperty(c,"channelCountMode",{get:()=>a,set:l=>{if(l!==a)throw t()}}),c},uT=(i,t,n,r,a,c)=>{const h=new Float32Array([1,1]),f=Math.PI/2,d={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},_={...d,oversample:"none"},v=(w,N,A,k)=>{const V=new Float32Array(16385),H=new Float32Array(16385);for(let tt=0;tt<16385;tt+=1){const Z=tt/16384*f;V[tt]=Math.cos(Z),H[tt]=Math.sin(Z)}const z=n(w,{...d,gain:0}),I=r(w,{..._,curve:V}),R=r(w,{..._,curve:h}),F=n(w,{...d,gain:0}),W=r(w,{..._,curve:H});return{connectGraph(){N.connect(z),N.connect(R.inputs===void 0?R:R.inputs[0]),N.connect(F),R.connect(A),A.connect(I.inputs===void 0?I:I.inputs[0]),A.connect(W.inputs===void 0?W:W.inputs[0]),I.connect(z.gain),W.connect(F.gain),z.connect(k,0,0),F.connect(k,0,1)},disconnectGraph(){N.disconnect(z),N.disconnect(R.inputs===void 0?R:R.inputs[0]),N.disconnect(F),R.disconnect(A),A.disconnect(I.inputs===void 0?I:I.inputs[0]),A.disconnect(W.inputs===void 0?W:W.inputs[0]),I.disconnect(z.gain),W.disconnect(F.gain),z.disconnect(k,0,0),F.disconnect(k,0,1)}}},b=(w,N,A,k)=>{const V=new Float32Array(16385),H=new Float32Array(16385),z=new Float32Array(16385),I=new Float32Array(16385),R=Math.floor(16385/2);for(let E=0;E<16385;E+=1)if(E>R){const P=(E-R)/(16384-R)*f;V[E]=Math.cos(P),H[E]=Math.sin(P),z[E]=0,I[E]=1}else{const P=E/(16384-R)*f;V[E]=1,H[E]=0,z[E]=Math.cos(P),I[E]=Math.sin(P)}const F=t(w,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),W=n(w,{...d,gain:0}),tt=r(w,{..._,curve:V}),Z=n(w,{...d,gain:0}),J=r(w,{..._,curve:H}),K=r(w,{..._,curve:h}),it=n(w,{...d,gain:0}),j=r(w,{..._,curve:z}),y=n(w,{...d,gain:0}),C=r(w,{..._,curve:I});return{connectGraph(){N.connect(F),N.connect(K.inputs===void 0?K:K.inputs[0]),F.connect(W,0),F.connect(Z,0),F.connect(it,1),F.connect(y,1),K.connect(A),A.connect(tt.inputs===void 0?tt:tt.inputs[0]),A.connect(J.inputs===void 0?J:J.inputs[0]),A.connect(j.inputs===void 0?j:j.inputs[0]),A.connect(C.inputs===void 0?C:C.inputs[0]),tt.connect(W.gain),J.connect(Z.gain),j.connect(it.gain),C.connect(y.gain),W.connect(k,0,0),it.connect(k,0,0),Z.connect(k,0,1),y.connect(k,0,1)},disconnectGraph(){N.disconnect(F),N.disconnect(K.inputs===void 0?K:K.inputs[0]),F.disconnect(W,0),F.disconnect(Z,0),F.disconnect(it,1),F.disconnect(y,1),K.disconnect(A),A.disconnect(tt.inputs===void 0?tt:tt.inputs[0]),A.disconnect(J.inputs===void 0?J:J.inputs[0]),A.disconnect(j.inputs===void 0?j:j.inputs[0]),A.disconnect(C.inputs===void 0?C:C.inputs[0]),tt.disconnect(W.gain),J.disconnect(Z.gain),j.disconnect(it.gain),C.disconnect(y.gain),W.disconnect(k,0,0),it.disconnect(k,0,0),Z.disconnect(k,0,1),y.disconnect(k,0,1)}}},S=(w,N,A,k,V)=>{if(N===1)return v(w,A,k,V);if(N===2)return b(w,A,k,V);throw a()};return(w,{channelCount:N,channelCountMode:A,pan:k,...V})=>{if(A==="max")throw a();const H=i(w,{...V,channelCount:1,channelCountMode:A,numberOfInputs:2}),z=n(w,{...V,channelCount:N,channelCountMode:A,gain:1}),I=n(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:k});let{connectGraph:R,disconnectGraph:F}=S(w,N,z,I,H);Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"maxValue",{get:()=>1}),Object.defineProperty(I.gain,"minValue",{get:()=>-1});const W={get bufferSize(){},get channelCount(){return z.channelCount},set channelCount(K){z.channelCount!==K&&(tt&&F(),{connectGraph:R,disconnectGraph:F}=S(w,K,z,I,H),tt&&R()),z.channelCount=K},get channelCountMode(){return z.channelCountMode},set channelCountMode(K){if(K==="clamped-max"||K==="max")throw a();z.channelCountMode=K},get channelInterpretation(){return z.channelInterpretation},set channelInterpretation(K){z.channelInterpretation=K},get context(){return z.context},get inputs(){return[z]},get numberOfInputs(){return z.numberOfInputs},get numberOfOutputs(){return z.numberOfOutputs},get pan(){return I.gain},addEventListener(...K){return z.addEventListener(K[0],K[1],K[2])},dispatchEvent(...K){return z.dispatchEvent(K[0])},removeEventListener(...K){return z.removeEventListener(K[0],K[1],K[2])}};let tt=!1;const Z=()=>{R(),tt=!0},J=()=>{F(),tt=!1};return c(Zs(W,H),Z,J)}},lT=(i,t,n,r,a,c,l)=>(h,f)=>{const d=h.createWaveShaper();if(c!==null&&c.name==="webkitAudioContext"&&h.createGain().gain.automationRate===void 0)return n(h,f);ue(d,f);const _=f.curve===null||f.curve instanceof Float32Array?f.curve:new Float32Array(f.curve);if(_!==null&&_.length<2)throw t();Xt(d,{curve:_},"curve"),Xt(d,f,"oversample");let v=null,b=!1;return l(d,"curve",N=>()=>N.call(d),N=>A=>(N.call(d,A),b&&(r(A)&&v===null?v=i(h,d):!r(A)&&v!==null&&(v(),v=null)),A)),a(d,()=>{b=!0,r(d.curve)&&(v=i(h,d))},()=>{b=!1,v!==null&&(v(),v=null)})},hT=(i,t,n,r,a)=>(c,{curve:l,oversample:h,...f})=>{const d=c.createWaveShaper(),_=c.createWaveShaper();ue(d,f),ue(_,f);const v=n(c,{...f,gain:1}),b=n(c,{...f,gain:-1}),S=n(c,{...f,gain:1}),w=n(c,{...f,gain:-1});let N=null,A=!1,k=null;const V={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(I){v.channelCount=I,b.channelCount=I,d.channelCount=I,S.channelCount=I,_.channelCount=I,w.channelCount=I},get channelCountMode(){return d.channelCountMode},set channelCountMode(I){v.channelCountMode=I,b.channelCountMode=I,d.channelCountMode=I,S.channelCountMode=I,_.channelCountMode=I,w.channelCountMode=I},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(I){v.channelInterpretation=I,b.channelInterpretation=I,d.channelInterpretation=I,S.channelInterpretation=I,_.channelInterpretation=I,w.channelInterpretation=I},get context(){return d.context},get curve(){return k},set curve(I){if(I!==null&&I.length<2)throw t();if(I===null)d.curve=I,_.curve=I;else{const R=I.length,F=new Float32Array(R+2-R%2),W=new Float32Array(R+2-R%2);F[0]=I[0],W[0]=-I[R-1];const tt=Math.ceil((R+1)/2),Z=(R+1)/2-1;for(let J=1;J<tt;J+=1){const K=J/tt*Z,it=Math.floor(K),j=Math.ceil(K);F[J]=it===j?I[it]:(1-(K-it))*I[it]+(1-(j-K))*I[j],W[J]=it===j?-I[R-1-it]:-((1-(K-it))*I[R-1-it])-(1-(j-K))*I[R-1-j]}F[tt]=R%2===1?I[tt-1]:(I[tt-2]+I[tt-1])/2,d.curve=F,_.curve=W}k=I,A&&(r(k)&&N===null?N=i(c,v):N!==null&&(N(),N=null))},get inputs(){return[v]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get oversample(){return d.oversample},set oversample(I){d.oversample=I,_.oversample=I},addEventListener(...I){return v.addEventListener(I[0],I[1],I[2])},dispatchEvent(...I){return v.dispatchEvent(I[0])},removeEventListener(...I){return v.removeEventListener(I[0],I[1],I[2])}};l!==null&&(V.curve=l instanceof Float32Array?l:new Float32Array(l)),h!==V.oversample&&(V.oversample=h);const H=()=>{v.connect(d).connect(S),v.connect(b).connect(_).connect(w).connect(S),A=!0,r(k)&&(N=i(c,v))},z=()=>{v.disconnect(d),d.disconnect(S),v.disconnect(b),b.disconnect(_),_.disconnect(w),w.disconnect(S),A=!1,N!==null&&(N(),N=null)};return a(Zs(V,S),H,z)},xe=()=>new DOMException("","NotSupportedError"),fT={numberOfChannels:1},dT=(i,t,n,r,a)=>class extends i{constructor(l,h,f){let d;if(typeof l=="number"&&h!==void 0&&f!==void 0)d={length:h,numberOfChannels:l,sampleRate:f};else if(typeof l=="object")d=l;else throw new Error("The given parameters are not valid.");const{length:_,numberOfChannels:v,sampleRate:b}={...fT,...d},S=r(v,_,b);t(yr,()=>yr(S))||S.addEventListener("statechange",(()=>{let w=0;const N=A=>{this._state==="running"&&(w>0?(S.removeEventListener("statechange",N),A.stopImmediatePropagation(),this._waitForThePromiseToSettle(A)):w+=1)};return N})()),super(S,v),this._length=_,this._nativeOfflineAudioContext=S,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(n()):(this._state="running",a(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,kh(this)}))}_waitForThePromiseToSettle(l){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(l):setTimeout(()=>this._waitForThePromiseToSettle(l))}},pT={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},_T=(i,t,n,r,a,c,l)=>class extends i{constructor(f,d){const _=a(f),v={...pT,...d},b=n(_,v),S=c(_),w=S?r():null,N=f.sampleRate/2;super(f,!1,b,w),this._detune=t(this,S,b.detune,153600,-153600),this._frequency=t(this,S,b.frequency,N,-N),this._nativeOscillatorNode=b,this._onended=null,this._oscillatorNodeRenderer=w,this._oscillatorNodeRenderer!==null&&v.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=v.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(f){const d=typeof f=="function"?l(this,f):null;this._nativeOscillatorNode.onended=d;const _=this._nativeOscillatorNode.onended;this._onended=_!==null&&_===d?f:_}get type(){return this._nativeOscillatorNode.type}set type(f){this._nativeOscillatorNode.type=f,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(f){this._nativeOscillatorNode.setPeriodicWave(f),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=f)}start(f=0){if(this._nativeOscillatorNode.start(f),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=f),this.context.state!=="closed"){Gs(this);const d=()=>{this._nativeOscillatorNode.removeEventListener("ended",d),Mn(this)&&Dr(this)};this._nativeOscillatorNode.addEventListener("ended",d)}}stop(f=0){this._nativeOscillatorNode.stop(f),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=f)}},mT=(i,t,n,r,a)=>()=>{const c=new WeakMap;let l=null,h=null,f=null;const d=async(_,v)=>{let b=n(_);const S=ye(b,v);if(!S){const w={channelCount:b.channelCount,channelCountMode:b.channelCountMode,channelInterpretation:b.channelInterpretation,detune:b.detune.value,frequency:b.frequency.value,periodicWave:l===null?void 0:l,type:b.type};b=t(v,w),h!==null&&b.start(h),f!==null&&b.stop(f)}return c.set(v,b),S?(await i(v,_.detune,b.detune),await i(v,_.frequency,b.frequency)):(await r(v,_.detune,b.detune),await r(v,_.frequency,b.frequency)),await a(_,v,b),b};return{set periodicWave(_){l=_},set start(_){h=_},set stop(_){f=_},render(_,v){const b=c.get(v);return b!==void 0?Promise.resolve(b):d(_,v)}}},gT={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},vT=(i,t,n,r,a,c,l)=>class extends i{constructor(f,d){const _=a(f),v={...gT,...d},b=n(_,v),S=c(_),w=S?r():null;super(f,!1,b,w),this._nativePannerNode=b,this._orientationX=t(this,S,b.orientationX,Se,Me),this._orientationY=t(this,S,b.orientationY,Se,Me),this._orientationZ=t(this,S,b.orientationZ,Se,Me),this._positionX=t(this,S,b.positionX,Se,Me),this._positionY=t(this,S,b.positionY,Se,Me),this._positionZ=t(this,S,b.positionZ,Se,Me),l(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(f){this._nativePannerNode.coneInnerAngle=f}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(f){this._nativePannerNode.coneOuterAngle=f}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(f){this._nativePannerNode.coneOuterGain=f}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(f){this._nativePannerNode.distanceModel=f}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(f){this._nativePannerNode.maxDistance=f}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(f){this._nativePannerNode.panningModel=f}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(f){this._nativePannerNode.refDistance=f}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(f){this._nativePannerNode.rolloffFactor=f}},yT=(i,t,n,r,a,c,l,h,f,d)=>()=>{const _=new WeakMap;let v=null;const b=async(S,w)=>{let N=null,A=c(S);const k={channelCount:A.channelCount,channelCountMode:A.channelCountMode,channelInterpretation:A.channelInterpretation},V={...k,coneInnerAngle:A.coneInnerAngle,coneOuterAngle:A.coneOuterAngle,coneOuterGain:A.coneOuterGain,distanceModel:A.distanceModel,maxDistance:A.maxDistance,panningModel:A.panningModel,refDistance:A.refDistance,rolloffFactor:A.rolloffFactor},H=ye(A,w);if("bufferSize"in A)N=r(w,{...k,gain:1});else if(!H){const z={...V,orientationX:A.orientationX.value,orientationY:A.orientationY.value,orientationZ:A.orientationZ.value,positionX:A.positionX.value,positionY:A.positionY.value,positionZ:A.positionZ.value};A=a(w,z)}if(_.set(w,N===null?A:N),N!==null){if(v===null){if(l===null)throw new Error("Missing the native OfflineAudioContext constructor.");const J=new l(6,S.context.length,w.sampleRate),K=t(J,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});K.connect(J.destination),v=(async()=>{const it=await Promise.all([S.orientationX,S.orientationY,S.orientationZ,S.positionX,S.positionY,S.positionZ].map(async(j,y)=>{const C=n(J,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:y===0?1:0});return await h(J,j,C.offset),C}));for(let j=0;j<6;j+=1)it[j].connect(K,0,j),it[j].start(0);return d(J)})()}const z=await v,I=r(w,{...k,gain:1});await f(S,w,I);const R=[];for(let J=0;J<z.numberOfChannels;J+=1)R.push(z.getChannelData(J));let F=[R[0][0],R[1][0],R[2][0]],W=[R[3][0],R[4][0],R[5][0]],tt=r(w,{...k,gain:1}),Z=a(w,{...V,orientationX:F[0],orientationY:F[1],orientationZ:F[2],positionX:W[0],positionY:W[1],positionZ:W[2]});I.connect(tt).connect(Z.inputs[0]),Z.connect(N);for(let J=128;J<z.length;J+=128){const K=[R[0][J],R[1][J],R[2][J]],it=[R[3][J],R[4][J],R[5][J]];if(K.some((j,y)=>j!==F[y])||it.some((j,y)=>j!==W[y])){F=K,W=it;const j=J/w.sampleRate;tt.gain.setValueAtTime(0,j),tt=r(w,{...k,gain:0}),Z=a(w,{...V,orientationX:F[0],orientationY:F[1],orientationZ:F[2],positionX:W[0],positionY:W[1],positionZ:W[2]}),tt.gain.setValueAtTime(1,j),I.connect(tt).connect(Z.inputs[0]),Z.connect(N)}}return N}return H?(await i(w,S.orientationX,A.orientationX),await i(w,S.orientationY,A.orientationY),await i(w,S.orientationZ,A.orientationZ),await i(w,S.positionX,A.positionX),await i(w,S.positionY,A.positionY),await i(w,S.positionZ,A.positionZ)):(await h(w,S.orientationX,A.orientationX),await h(w,S.orientationY,A.orientationY),await h(w,S.orientationZ,A.orientationZ),await h(w,S.positionX,A.positionX),await h(w,S.positionY,A.positionY),await h(w,S.positionZ,A.positionZ)),Ks(A)?await f(S,w,A.inputs[0]):await f(S,w,A),A};return{render(S,w){const N=_.get(w);return N!==void 0?Promise.resolve(N):b(S,w)}}},wT={disableNormalization:!1},TT=(i,t,n,r)=>class Bh{constructor(c,l){const h=t(c),f=r({...wT,...l}),d=i(h,f);return n.add(d),d}static[Symbol.hasInstance](c){return c!==null&&typeof c=="object"&&Object.getPrototypeOf(c)===Bh.prototype||n.has(c)}},bT=(i,t)=>(n,r,a)=>(i(r).replay(a),t(r,n,a)),ST=(i,t,n)=>async(r,a,c)=>{const l=i(r);await Promise.all(l.activeInputs.map((h,f)=>Array.from(h).map(async([d,_])=>{const b=await t(d).render(d,a),S=r.context.destination;!n(d)&&(r!==S||!n(r))&&b.connect(c,_,f)})).reduce((h,f)=>[...h,...f],[]))},CT=(i,t,n)=>async(r,a,c)=>{const l=t(r);await Promise.all(Array.from(l.activeInputs).map(async([h,f])=>{const _=await i(h).render(h,a);n(h)||_.connect(c,f)}))},AT=(i,t,n,r)=>a=>i(yr,()=>yr(a))?Promise.resolve(i(r,r)).then(c=>{if(!c){const l=n(a,512,0,1);a.oncomplete=()=>{l.onaudioprocess=null,l.disconnect()},l.onaudioprocess=()=>a.currentTime,l.connect(a.destination)}return a.startRendering()}):new Promise(c=>{const l=t(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});a.oncomplete=h=>{l.disconnect(),c(h.renderedBuffer)},l.connect(a.destination),a.startRendering()}),xT=i=>(t,n)=>{i.set(t,n)},NT=i=>(t,n)=>i.set(t,n),IT=(i,t,n,r,a,c,l,h)=>(f,d)=>n(f).render(f,d).then(()=>Promise.all(Array.from(r(d)).map(_=>n(_).render(_,d)))).then(()=>a(d)).then(_=>(typeof _.copyFromChannel!="function"?(l(_),Ja(_)):t(c,()=>c(_))||h(_),i.add(_),_)),ET={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},OT=(i,t,n,r,a,c)=>class extends i{constructor(h,f){const d=a(h),_={...ET,...f},v=n(d,_),b=c(d),S=b?r():null;super(h,!1,v,S),this._pan=t(this,b,v.pan)}get pan(){return this._pan}},kT=(i,t,n,r,a)=>()=>{const c=new WeakMap,l=async(h,f)=>{let d=n(h);const _=ye(d,f);if(!_){const v={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,pan:d.pan.value};d=t(f,v)}return c.set(f,d),_?await i(f,h.pan,d.pan):await r(f,h.pan,d.pan),Ks(d)?await a(h,f,d.inputs[0]):await a(h,f,d),d};return{render(h,f){const d=c.get(f);return d!==void 0?Promise.resolve(d):l(h,f)}}},MT=i=>()=>{if(i===null)return!1;try{new i({length:1,sampleRate:44100})}catch{return!1}return!0},RT=(i,t)=>async()=>{if(i===null)return!0;if(t===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new t(1,128,44100),a=URL.createObjectURL(n);let c=!1,l=!1;try{await r.audioWorklet.addModule(a);const h=new i(r,"a",{numberOfOutputs:0}),f=r.createOscillator();h.port.onmessage=()=>c=!0,h.onprocessorerror=()=>l=!0,f.connect(h),f.start(0),await r.startRendering()}catch{}finally{URL.revokeObjectURL(a)}return c&&!l},DT=(i,t)=>()=>{if(t===null)return Promise.resolve(!1);const n=new t(1,1,44100),r=i(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(a=>{n.oncomplete=()=>{r.disconnect(),a(n.currentTime!==0)},n.startRendering()})},PT=()=>new DOMException("","UnknownError"),FT={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},LT=(i,t,n,r,a,c,l)=>class extends i{constructor(f,d){const _=a(f),v={...FT,...d},b=n(_,v),w=c(_)?r():null;super(f,!0,b,w),this._isCurveNullified=!1,this._nativeWaveShaperNode=b,l(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(f){if(f===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(f.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=f}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(f){this._nativeWaveShaperNode.oversample=f}},WT=(i,t,n)=>()=>{const r=new WeakMap,a=async(c,l)=>{let h=t(c);if(!ye(h,l)){const d={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,curve:h.curve,oversample:h.oversample};h=i(l,d)}return r.set(l,h),Ks(h)?await n(c,l,h.inputs[0]):await n(c,l,h),h};return{render(c,l){const h=r.get(l);return h!==void 0?Promise.resolve(h):a(c,l)}}},VT=()=>typeof window>"u"?null:window,qT=(i,t)=>n=>{n.copyFromChannel=(r,a,c=0)=>{const l=i(c),h=i(a);if(h>=n.numberOfChannels)throw t();const f=n.length,d=n.getChannelData(h),_=r.length;for(let v=l<0?-l:0;v+l<f&&v<_;v+=1)r[v]=d[v+l]},n.copyToChannel=(r,a,c=0)=>{const l=i(c),h=i(a);if(h>=n.numberOfChannels)throw t();const f=n.length,d=n.getChannelData(h),_=r.length;for(let v=l<0?-l:0;v+l<f&&v<_;v+=1)d[v+l]=r[v]}},BT=i=>t=>{t.copyFromChannel=(n=>(r,a,c=0)=>{const l=i(c),h=i(a);if(l<t.length)return n.call(t,r,h,l)})(t.copyFromChannel),t.copyToChannel=(n=>(r,a,c=0)=>{const l=i(c),h=i(a);if(l<t.length)return n.call(t,r,h,l)})(t.copyToChannel)},UT=i=>(t,n)=>{const r=n.createBuffer(1,1,44100);t.buffer===null&&(t.buffer=r),i(t,"buffer",a=>()=>{const c=a.call(t);return c===r?null:c},a=>c=>a.call(t,c===null?r:c))},GT=(i,t)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw i()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw i()}});const a=n.createBufferSource();t(r,()=>{const h=r.numberOfInputs;for(let f=0;f<h;f+=1)a.connect(r,0,f)},()=>a.disconnect(r))},Uh=(i,t,n)=>i.copyFromChannel===void 0?i.getChannelData(n)[0]:(i.copyFromChannel(t,n),t[0]),Gh=i=>{if(i===null)return!1;const t=i.length;return t%2!==0?i[Math.floor(t/2)]!==0:i[t/2-1]+i[t/2]!==0},Vr=(i,t,n,r)=>{let a=i;for(;!a.hasOwnProperty(t);)a=Object.getPrototypeOf(a);const{get:c,set:l}=Object.getOwnPropertyDescriptor(a,t);Object.defineProperty(i,t,{get:n(c),set:r(l)})},$T=i=>({...i,outputChannelCount:i.outputChannelCount!==void 0?i.outputChannelCount:i.numberOfInputs===1&&i.numberOfOutputs===1?[i.channelCount]:Array.from({length:i.numberOfOutputs},()=>1)}),HT=i=>({...i,channelCount:i.numberOfOutputs}),zT=i=>{const{imag:t,real:n}=i;return t===void 0?n===void 0?{...i,imag:[0,0],real:[0,0]}:{...i,imag:Array.from(n,()=>0),real:n}:n===void 0?{...i,imag:t,real:Array.from(t,()=>0)}:{...i,imag:t,real:n}},$h=(i,t,n)=>{try{i.setValueAtTime(t,n)}catch(r){if(r.code!==9)throw r;$h(i,t,n+1e-7)}},KT=i=>{const t=i.createBufferSource();t.start();try{t.start()}catch{return!0}return!1},ZT=i=>{const t=i.createBufferSource(),n=i.createBuffer(1,1,44100);t.buffer=n;try{t.start(0,1)}catch{return!1}return!0},YT=i=>{const t=i.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0},rc=i=>{const t=i.createOscillator();try{t.start(-1)}catch(n){return n instanceof RangeError}return!1},Hh=i=>{const t=i.createBuffer(1,1,44100),n=i.createBufferSource();n.buffer=t,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},ic=i=>{const t=i.createOscillator();try{t.stop(-1)}catch(n){return n instanceof RangeError}return!1},XT=i=>{const{port1:t,port2:n}=new MessageChannel;try{t.postMessage(i)}finally{t.close(),n.close()}},QT=i=>{i.start=(t=>(n=0,r=0,a)=>{const c=i.buffer,l=c===null?r:Math.min(c.duration,r);c!==null&&l>c.duration-.5/i.context.sampleRate?t.call(i,n,0,0):t.call(i,n,l,a)})(i.start)},zh=(i,t)=>{const n=t.createGain();i.connect(n);const r=(a=>()=>{a.call(i,n),i.removeEventListener("ended",r)})(i.disconnect);i.addEventListener("ended",r),Zs(i,n),i.stop=(a=>{let c=!1;return(l=0)=>{if(c)try{a.call(i,l)}catch{n.gain.setValueAtTime(0,l)}else a.call(i,l),c=!0}})(i.stop)},Ys=(i,t)=>n=>{const r={value:i};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof t=="function"?t.call(i,n):t.handleEvent.call(i,n)},jT=v1(ys),JT=C1(ys),tb=Fy(no),Kh=new WeakMap,eb=tw(Kh),cn=fy(new Map,new WeakMap),_n=VT(),Zh=Ow(cn,gn),oc=Jy(Ce),me=ST(Ce,oc,fs),nb=E1(Zh,zt,me),$t=sw(eo),Dn=sT(_n),Lt=ww(Dn),Yh=new WeakMap,Xh=zy(Ys),qr=Dw(_n),ac=mw(qr),cc=gw(_n),Qh=vw(_n),wr=Fw(_n),ie=ty(y1(Ch),S1(jT,JT,Bi,tb,Ui,Ce,eb,Rr,zt,ys,Mn,fs,Pi),cn,hw(Ba,Ui,Ce,zt,vr,Mn),gn,so,xe,My(Bi,Ba,Ce,zt,vr,$t,Mn,Lt),Vy(Yh,Ce,an),Xh,$t,ac,cc,Qh,Lt,wr),sb=I1(ie,nb,gn,Zh,$t,Lt),uc=new WeakSet,dh=kw(_n),jh=Ay(new Uint32Array(1)),lc=qT(jh,gn),hc=BT(jh),rb=k1(uc,cn,xe,dh,Dn,MT(dh),lc,hc),ro=A1(De),Jh=CT(oc,Pr,fs),vn=yy(Jh),Xs=Rw(ro,cn,KT,ZT,YT,rc,Hh,ic,QT,UT(Vr),zh),yn=bT(ew(Pr),Jh),ib=D1(vn,Xs,zt,yn,me),un=ey(w1(Ah),Yh,ja,ny,f1,d1,p1,_1,m1,Wa,bh,qr,$h),ob=R1(ie,ib,un,de,Xs,$t,Lt,Ys),ab=G1(ie,$1,gn,de,Pw(De,Vr),$t,Lt,me),cb=hy(vn,Vh,zt,yn,me),ws=NT(Kh),ub=ly(ie,un,cb,so,Vh,$t,Lt,ws),Qn=Iw(ys,cc),lb=GT(de,Qn),jn=Gw(qr,lb),hb=_y(jn,zt,me),fb=py(ie,hb,jn,$t,Lt),db=vy(Lr,zt,me),pb=gy(ie,db,Lr,$t,Lt,HT),_b=zw(ro,Xs,De,Qn),Qs=Hw(ro,cn,_b,rc,ic),mb=Cy(vn,Qs,zt,yn,me),gb=Sy(ie,un,mb,Qs,$t,Lt,Ys),tf=Kw(xe,Vr),vb=Iy(tf,zt,me),yb=Ny(ie,vb,tf,$t,Lt,ws),wb=Py(vn,qh,zt,yn,me),Tb=Dy(ie,un,wb,qh,$t,Lt,ws),ef=Zw(xe),bb=Gy(vn,ef,zt,yn,me),Sb=Uy(ie,un,bb,ef,xe,$t,Lt,ws),Cb=Qy(vn,De,zt,yn,me),Ab=Xy(ie,un,Cb,De,$t,Lt),xb=jw(so,de,Wr,xe),io=AT(cn,De,Wr,DT(De,Dn)),Nb=lw(Xs,zt,Dn,me,io),Ib=Yw(xb),Eb=cw(ie,Ib,Nb,$t,Lt,ws),Ob=H1(un,jn,Qs,Wr,xe,Uh,Lt,Vr),nf=new WeakMap,kb=Nw(ab,Ob,Xh,Lt,nf,Ys),sf=rT(ro,cn,rc,Hh,ic,zh),Mb=mT(vn,sf,zt,yn,me),Rb=_T(ie,un,sf,Mb,$t,Lt,Ys),rf=Ty(Xs),Db=hT(rf,de,De,Gh,Qn),oo=lT(rf,de,Db,Gh,Qn,qr,Vr),Pb=oT(Bi,de,jn,De,Wr,oo,xe,Ui,Uh,Qn),of=iT(Pb),Fb=yT(vn,jn,Qs,De,of,zt,Dn,yn,me,io),Lb=vT(ie,un,of,Fb,$t,Lt,ws),Wb=aT(gn),Vb=TT(Wb,$t,new WeakSet,zT),qb=uT(jn,Lr,De,oo,xe,Qn),af=cT(qb,xe),Bb=kT(vn,af,zt,yn,me),Ub=OT(ie,un,af,Bb,$t,Lt),Gb=WT(oo,zt,me),$b=LT(ie,de,oo,Gb,$t,Lt,ws),cf=Tw(_n),fc=Ky(_n),uf=new WeakMap,Hb=rw(uf,Dn),zb=cf?b1(cn,xe,Hy(_n),fc,Zy(g1),$t,Hb,Lt,wr,new WeakMap,new WeakMap,RT(wr,Dn),_n):void 0,Kb=yw(ac,Lt),Zb=ky(uc,cn,Oy,$y,new WeakSet,$t,Kb,Vi,yr,lc,hc),lf=cy(zb,sb,rb,ob,ub,fb,pb,gb,yb,Zb,Tb,Sb,Ab,Eb,kb,Rb,Lb,Vb,Ub,$b),Yb=bw(ie,Jw,$t,Lt),Xb=Cw(ie,tT,$t,Lt),Qb=Aw(ie,eT,$t,Lt),jb=nT(de,Lt),Jb=xw(ie,jb,$t),tS=U1(lf,de,xe,PT,Yb,Xb,Qb,Jb,qr),dc=iw(nf),eS=x1(dc),hf=wy(gn),nS=Ly(dc),ff=qy(gn),df=new WeakMap,sS=jy(df,an),rS=Uw(hf,gn,de,jn,Lr,Qs,De,Wr,xe,ff,fc,sS,Qn),iS=Ww(de,rS,De,xe,Qn),oS=ay(vn,hf,Xs,jn,Lr,Qs,De,nS,ff,fc,zt,wr,Dn,yn,me,io),aS=nw(uf),cS=xT(df),ph=cf?ry(eS,ie,un,oS,iS,Ce,aS,$t,Lt,wr,$T,cS,XT,Ys):void 0,uS=Ey(xe,Dn),lS=IT(uc,cn,oc,dc,io,Vi,lc,hc),hS=dT(lf,cn,de,uS,lS),fS=fw(eo,ac),dS=dw(Qa,cc),pS=pw(ja,Qh),_S=_w(eo,Lt);function yt(i,t){if(!i)throw new Error(t)}function Yn(i,t,n=1/0){if(!(t<=i&&i<=n))throw new RangeError(`Value must be within [${t}, ${n}], got: ${i}`)}function pf(i){!i.isOffline&&i.state!=="running"&&mf('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let _f=console;function mS(...i){_f.log(...i)}function mf(...i){_f.warn(...i)}function je(i){return typeof i>"u"}function Nt(i){return!je(i)}function gS(i){return typeof i=="function"}function ds(i){return typeof i=="number"}function ls(i){return Object.prototype.toString.call(i)==="[object Object]"&&i.constructor===Object}function vS(i){return typeof i=="boolean"}function on(i){return Array.isArray(i)}function mn(i){return typeof i=="string"}function Ri(i){return mn(i)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(i)}function yS(i){return new tS(i)}function wS(i,t,n){return new hS(i,t,n)}const hs=typeof self=="object"?self:null,TS=hs&&(hs.hasOwnProperty("AudioContext")||hs.hasOwnProperty("webkitAudioContext"));function bS(i,t,n){return yt(Nt(ph),"This node only works in a secure context (https or localhost)"),new ph(i,t,n)}function ln(i,t,n,r){var a=arguments.length,c=a<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,t,n,r);else for(var h=i.length-1;h>=0;h--)(l=i[h])&&(c=(a<3?l(c):a>3?l(t,n,c):l(t,n))||c);return a>3&&c&&Object.defineProperty(t,n,c),c}function oe(i,t,n,r){function a(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function h(_){try{d(r.next(_))}catch(v){l(v)}}function f(_){try{d(r.throw(_))}catch(v){l(v)}}function d(_){_.done?c(_.value):a(_.value).then(h,f)}d((r=r.apply(i,t||[])).next())})}class SS{constructor(t,n,r){this._callback=t,this._type=n,this._updateInterval=r,this._createClock()}_createWorker(){const t=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),n=URL.createObjectURL(t),r=new Worker(n);r.onmessage=this._callback.bind(this),this._worker=r}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),this._type==="worker"&&this._worker.postMessage(Math.max(t*1e3,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function ps(i){return pS(i)}function Zn(i){return dS(i)}function Fi(i){return _S(i)}function Ls(i){return fS(i)}function gf(i){return i instanceof AudioBuffer}function CS(i,t){return i==="value"||ps(t)||Zn(t)||gf(t)}function Vs(i,...t){if(!t.length)return i;const n=t.shift();if(ls(i)&&ls(n))for(const r in n)CS(r,n[r])?i[r]=n[r]:ls(n[r])?(i[r]||Object.assign(i,{[r]:{}}),Vs(i[r],n[r])):Object.assign(i,{[r]:n[r]});return Vs(i,...t)}function AS(i,t){return i.length===t.length&&i.every((n,r)=>t[r]===n)}function rt(i,t,n=[],r){const a={},c=Array.from(t);if(ls(c[0])&&r&&!Reflect.has(c[0],r)&&(Object.keys(c[0]).some(h=>Reflect.has(i,h))||(Vs(a,{[r]:c[0]}),n.splice(n.indexOf(r),1),c.shift())),c.length===1&&ls(c[0]))Vs(a,c[0]);else for(let l=0;l<n.length;l++)Nt(c[l])&&(a[n[l]]=c[l]);return Vs(i,a)}function xS(i){return i.constructor.getDefaults()}function qs(i,t){return je(i)?t:i}function _h(i,t){return t.forEach(n=>{Reflect.has(i,n)&&delete i[n]}),i}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */class Pn{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||hs&&this.toString()===hs.TONE_DEBUG_CLASS)&&mS(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Pn.version=Th;const pc=1e-6;function zi(i,t){return i>t+pc}function za(i,t){return zi(i,t)||sn(i,t)}function vf(i,t){return i+pc<t}function sn(i,t){return Math.abs(i-t)<pc}function NS(i,t,n){return Math.max(Math.min(i,n),t)}class wn extends Pn{constructor(){super(),this.name="Timeline",this._timeline=[];const t=rt(wn.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(yt(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const n=this._timeline[this.length-1];yt(za(t.time,n.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const n=this._search(t.time);this._timeline.splice(n+1,0,t)}if(this.length>this.memory){const n=this.length-this.memory;this._timeline.splice(0,n)}return this}remove(t){const n=this._timeline.indexOf(t);return n!==-1&&this._timeline.splice(n,1),this}get(t,n="time"){const r=this._search(t,n);return r!==-1?this._timeline[r]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,n="time"){const r=this._search(t,n);return r+1<this._timeline.length?this._timeline[r+1]:null}getBefore(t){const n=this._timeline.length;if(n>0&&this._timeline[n-1].time<t)return this._timeline[n-1];const r=this._search(t);return r-1>=0?this._timeline[r-1]:null}cancel(t){if(this._timeline.length>1){let n=this._search(t);if(n>=0)if(sn(this._timeline[n].time,t)){for(let r=n;r>=0&&sn(this._timeline[r].time,t);r--)n=r;this._timeline=this._timeline.slice(0,n)}else this._timeline=this._timeline.slice(0,n+1);else this._timeline=[]}else this._timeline.length===1&&za(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const n=this._search(t);return n>=0&&(this._timeline=this._timeline.slice(n+1)),this}previousEvent(t){const n=this._timeline.indexOf(t);return n>0?this._timeline[n-1]:null}_search(t,n="time"){if(this._timeline.length===0)return-1;let r=0;const a=this._timeline.length;let c=a;if(a>0&&this._timeline[a-1][n]<=t)return a-1;for(;r<c;){let l=Math.floor(r+(c-r)/2);const h=this._timeline[l],f=this._timeline[l+1];if(sn(h[n],t)){for(let d=l;d<this._timeline.length;d++){const _=this._timeline[d];if(sn(_[n],t))l=d;else break}return l}else{if(vf(h[n],t)&&zi(f[n],t))return l;zi(h[n],t)?c=l:r=l+1}}return-1}_iterate(t,n=0,r=this._timeline.length-1){this._timeline.slice(n,r+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,n){const r=this._search(t);return r!==-1&&this._iterate(n,0,r),this}forEachAfter(t,n){const r=this._search(t);return this._iterate(n,r+1),this}forEachBetween(t,n,r){let a=this._search(t),c=this._search(n);return a!==-1&&c!==-1?(this._timeline[a].time!==t&&(a+=1),this._timeline[c].time===n&&(c-=1),this._iterate(r,a,c)):a===-1&&this._iterate(r,0,c),this}forEachFrom(t,n){let r=this._search(t);for(;r>=0&&this._timeline[r].time>=t;)r--;return this._iterate(n,r+1),this}forEachAtTime(t,n){const r=this._search(t);if(r!==-1&&sn(this._timeline[r].time,t)){let a=r;for(let c=r;c>=0&&sn(this._timeline[c].time,t);c--)a=c;this._iterate(c=>{n(c)},a,r)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const yf=[];function ao(i){yf.push(i)}function IS(i){yf.forEach(t=>t(i))}const wf=[];function co(i){wf.push(i)}function ES(i){wf.forEach(t=>t(i))}class Br extends Pn{constructor(){super(...arguments),this.name="Emitter"}on(t,n){return t.split(/\W+/).forEach(a=>{je(this._events)&&(this._events={}),this._events.hasOwnProperty(a)||(this._events[a]=[]),this._events[a].push(n)}),this}once(t,n){const r=(...a)=>{n(...a),this.off(t,r)};return this.on(t,r),this}off(t,n){return t.split(/\W+/).forEach(a=>{if(je(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(je(n))this._events[t]=[];else{const c=this._events[t];for(let l=c.length-1;l>=0;l--)c[l]===n&&c.splice(l,1)}}),this}emit(t,...n){if(this._events&&this._events.hasOwnProperty(t)){const r=this._events[t].slice(0);for(let a=0,c=r.length;a<c;a++)r[a].apply(this,n)}return this}static mixin(t){["on","once","off","emit"].forEach(n=>{const r=Object.getOwnPropertyDescriptor(Br.prototype,n);Object.defineProperty(t.prototype,n,r)})}dispose(){return super.dispose(),this._events=void 0,this}}class Tf extends Br{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Ur extends Tf{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new wn,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=rt(Ur.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=yS({latencyHint:t.latencyHint}),this._ticker=new SS(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(IS(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,n,r){return this._context.createBuffer(t,n,r)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,n){return this._context.createIIRFilter(t,n)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,n,r){return this._context.createPeriodicWave(t,n,r)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){return yt(Ls(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(t)}createMediaElementSource(t){return yt(Ls(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(t)}createMediaStreamDestination(){return yt(Ls(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){yt(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){yt(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){yt(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){yt(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,n){return bS(this.rawContext,t,n)}addAudioWorkletModule(t,n){return oe(this,void 0,void 0,function*(){yt(Nt(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(n)||this._workletModules.set(n,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(n)})}workletsAreReady(){return oe(this,void 0,void 0,function*(){const t=[];this._workletModules.forEach(n=>t.push(n)),yield Promise.all(t)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let n=0;if(this._latencyHint=t,mn(t))switch(t){case"interactive":n=.1;break;case"playback":n=.5;break;case"balanced":n=.25;break}this.lookAhead=n,this.updateInterval=n/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return Ls(this._context)?this._context.resume():Promise.resolve()}close(){return oe(this,void 0,void 0,function*(){Ls(this._context)&&(yield this._context.close()),this._initialized&&ES(this)})}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const n=this._context.createBuffer(1,128,this._context.sampleRate),r=n.getChannelData(0);for(let c=0;c<r.length;c++)r[c]=t;const a=this._context.createBufferSource();return a.channelCount=1,a.channelCountMode="explicit",a.buffer=n,a.loop=!0,a.start(0),this._constants.set(t,a),a}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=>this._constants[t].disconnect()),this}_timeoutLoop(){const t=this.now();let n=this._timeouts.peek();for(;this._timeouts.length&&n&&n.time<=t;)n.callback(),this._timeouts.shift(),n=this._timeouts.peek()}setTimeout(t,n){this._timeoutIds++;const r=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:r+n}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach(n=>{n.id===t&&this._timeouts.remove(n)}),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,n){const r=++this._timeoutIds,a=()=>{const c=this.now();this._timeouts.add({callback:()=>{t(),a()},id:r,time:c+n})};return a(),r}}class OS extends Tf{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,n,r){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,n){return{}}createPanner(){return{}}createPeriodicWave(t,n,r){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,n){return{}}get rawContext(){return{}}addAudioWorkletModule(t,n){return oe(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(t,n){return 0}clearTimeout(t){return this}setInterval(t,n){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}}function te(i,t){on(t)?t.forEach(n=>te(i,n)):Object.defineProperty(i,t,{enumerable:!0,writable:!1})}function bf(i,t){on(t)?t.forEach(n=>bf(i,n)):Object.defineProperty(i,t,{writable:!0})}const qt=()=>{};class Gt extends Pn{constructor(){super(),this.name="ToneAudioBuffer",this.onload=qt;const t=rt(Gt.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&gf(t.url)||t.url instanceof Gt?this.set(t.url):mn(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:qt,onload:qt,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Xe().sampleRate}set(t){return t instanceof Gt?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return oe(this,void 0,void 0,function*(){const n=Gt.load(t).then(r=>{this.set(r),this.onload(this)});Gt.downloads.push(n);try{yield n}finally{const r=Gt.downloads.indexOf(n);Gt.downloads.splice(r,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const n=on(t)&&t[0].length>0,r=n?t.length:1,a=n?t[0].length:t.length,c=Xe(),l=c.createBuffer(r,a,c.sampleRate),h=!n&&r===1?[t]:t;for(let f=0;f<r;f++)l.copyToChannel(h[f],f);return this._buffer=l,this}toMono(t){if(ds(t))this.fromArray(this.toArray(t));else{let n=new Float32Array(this.length);const r=this.numberOfChannels;for(let a=0;a<r;a++){const c=this.toArray(a);for(let l=0;l<c.length;l++)n[l]+=c[l]}n=n.map(a=>a/r),this.fromArray(n)}return this}toArray(t){if(ds(t))return this.getChannelData(t);if(this.numberOfChannels===1)return this.toArray(0);{const n=[];for(let r=0;r<this.numberOfChannels;r++)n[r]=this.getChannelData(r);return n}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,n=this.duration){const r=Math.floor(t*this.sampleRate),a=Math.floor(n*this.sampleRate);yt(r<a,"The start time must be less than the end time");const c=a-r,l=Xe().createBuffer(this.numberOfChannels,c,this.sampleRate);for(let h=0;h<this.numberOfChannels;h++)l.copyToChannel(this.getChannelData(h).subarray(r,a),h);return new Gt(l)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return new Gt().fromArray(t)}static fromUrl(t){return oe(this,void 0,void 0,function*(){return yield new Gt().load(t)})}static load(t){return oe(this,void 0,void 0,function*(){const n=t.match(/\[([^\]\[]+\|.+)\]$/);if(n){const h=n[1].split("|");let f=h[0];for(const d of h)if(Gt.supportsType(d)){f=d;break}t=t.replace(n[0],f)}const r=Gt.baseUrl===""||Gt.baseUrl.endsWith("/")?Gt.baseUrl:Gt.baseUrl+"/",a=yield fetch(r+t);if(!a.ok)throw new Error(`could not load url: ${t}`);const c=yield a.arrayBuffer();return yield Xe().decodeAudioData(c)})}static supportsType(t){const n=t.split("."),r=n[n.length-1];return document.createElement("audio").canPlayType("audio/"+r)!==""}static loaded(){return oe(this,void 0,void 0,function*(){for(yield Promise.resolve();Gt.downloads.length;)yield Gt.downloads[0]})}}Gt.baseUrl="";Gt.downloads=[];class _c extends Ur{constructor(){super({clockSource:"offline",context:Fi(arguments[0])?arguments[0]:wS(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:Fi(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=Fi(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return oe(this,void 0,void 0,function*(){let n=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,n++;const r=Math.floor(this.sampleRate/128);t&&n%r===0&&(yield new Promise(a=>setTimeout(a,1)))}})}render(t=!0){return oe(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(t);const n=yield this._context.startRendering();return new Gt(n)})}close(){return Promise.resolve()}}const Sf=new OS;let Bs=Sf;function Xe(){return Bs===Sf&&TS&&kS(new Ur),Bs}function kS(i){Ls(i)?Bs=new Ur(i):Fi(i)?Bs=new _c(i):Bs=i}function MS(){return Bs.resume()}if(hs&&!hs.TONE_SILENCE_LOGGING){const t=` * Tone.js v${Th} * `;console.log(`%c${t}`,"background: #000; color: #fff")}function RS(i){return Math.pow(10,i/20)}function DS(i){return 20*(Math.log(i)/Math.LN10)}function Cf(i){return Math.pow(2,i/12)}let uo=440;function PS(){return uo}function FS(i){uo=i}function Ka(i){return Math.round(Af(i))}function Af(i){return 69+12*Math.log2(i/uo)}function LS(i){return uo*Math.pow(2,(i-69)/12)}class mc extends Pn{constructor(t,n,r){super(),this.defaultUnits="s",this._val=n,this._units=r,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,n)=>{const r=parseInt(t,10),a=n==="."?1.5:1;return r===1?this._beatsToUnits(this._getTimeSignature())*a:this._beatsToUnits(4/r)*a},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const n=parseInt(t,10);return this._beatsToUnits(8/(Math.floor(n)*3))},regexp:/^(\d+)t$/i},tr:{method:(t,n,r)=>{let a=0;return t&&t!=="0"&&(a+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),n&&n!=="0"&&(a+=this._beatsToUnits(parseFloat(n))),r&&r!=="0"&&(a+=this._beatsToUnits(parseFloat(r)/4)),a},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof mc&&this.fromType(this._val),je(this._val))return this._noArg();if(mn(this._val)&&je(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(ls(this._val)){let t=0;for(const n in this._val)if(Nt(this._val[n])){const r=this._val[n];t+=new this.constructor(this.context,n).valueOf()*r}return t}if(Nt(this._units)){const t=this._expressions[this._units],n=this._val.toString().trim().match(t.regexp);return n?t.method.apply(this,n.slice(1)):t.method.call(this,this._val)}else return mn(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class rn extends mc{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const n=new rn(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(n))},regexp:/^@(.+)/}})}quantize(t,n=1){const r=new this.constructor(this.context,t).valueOf(),a=this.valueOf(),h=Math.round(a/r)*r-a;return a+h*n}toNotation(){const t=this.toSeconds(),n=["1m"];for(let c=1;c<9;c++){const l=Math.pow(2,c);n.push(l+"n."),n.push(l+"n"),n.push(l+"t")}n.push("0");let r=n[0],a=new rn(this.context,n[0]).toSeconds();return n.forEach(c=>{const l=new rn(this.context,c).toSeconds();Math.abs(l-t)<Math.abs(a-t)&&(r=c,a=l)}),r}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let n=this.valueOf()/t;n=parseFloat(n.toFixed(4));const r=Math.floor(n/this._getTimeSignature());let a=n%1*4;n=Math.floor(n)%this._getTimeSignature();const c=a.toString();return c.length>3&&(a=parseFloat(parseFloat(c).toFixed(3))),[r,n,a].join(":")}toTicks(){const t=this._beatsToUnits(1),n=this.valueOf()/t;return Math.round(n*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return Ka(this.toFrequency())}_now(){return this.context.now()}}class Qe extends rn{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return PS()}static set A4(t){FS(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return this.defaultUnits==="midi"?t:Qe.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,n){const a=WS[t.toLowerCase()]+(parseInt(n,10)+1)*12;return this.defaultUnits==="midi"?a:Qe.mtof(a)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,n,r){let a=1;return t&&t!=="0"&&(a*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),n&&n!=="0"&&(a*=this._beatsToUnits(parseFloat(n))),r&&r!=="0"&&(a*=this._beatsToUnits(parseFloat(r)/4)),a}}})}transpose(t){return new Qe(this.context,this.valueOf()*Cf(t))}harmonize(t){return t.map(n=>this.transpose(n))}toMidi(){return Ka(this.valueOf())}toNote(){const t=this.toFrequency(),n=Math.log2(t/Qe.A4);let r=Math.round(12*n)+57;const a=Math.floor(r/12);return a<0&&(r+=-12*a),VS[r%12]+a.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),n=this.valueOf()/t;return Math.floor(n*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(t*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return LS(t)}static ftom(t){return Ka(t)}}const WS={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},VS=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class gr extends rn{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Re extends Pn{constructor(){super();const t=rt(Re.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Xe()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new rn(this.context,t).toSeconds()}toFrequency(t){return new Qe(this.context,t).toFrequency()}toTicks(t){return new gr(this.context,t).toTicks()}_getPartialProperties(t){const n=this.get();return Object.keys(n).forEach(r=>{je(t[r])&&delete n[r]}),n}get(){const t=xS(this);return Object.keys(t).forEach(n=>{if(Reflect.has(this,n)){const r=this[n];Nt(r)&&Nt(r.value)&&Nt(r.setValueAtTime)?t[n]=r.value:r instanceof Re?t[n]=r._getPartialProperties(t[n]):on(r)||ds(r)||mn(r)||vS(r)?t[n]=r:delete t[n]}}),t}set(t){return Object.keys(t).forEach(n=>{Reflect.has(this,n)&&Nt(this[n])&&(this[n]&&Nt(this[n].value)&&Nt(this[n].setValueAtTime)?this[n].value!==t[n]&&(this[n].value=t[n]):this[n]instanceof Re?this[n].set(t[n]):this[n]=t[n])}),this}}class gc extends wn{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const n=this.get(t);return n!==null?n.state:this._initial}setStateAtTime(t,n,r){return Yn(n,0),this.add(Object.assign({},r,{state:t,time:n})),this}getLastState(t,n){const r=this._search(n);for(let a=r;a>=0;a--){const c=this._timeline[a];if(c.state===t)return c}}getNextState(t,n){const r=this._search(n);if(r!==-1)for(let a=r;a<this._timeline.length;a++){const c=this._timeline[a];if(c.state===t)return c}}}class Yt extends Re{constructor(){super(rt(Yt.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=rt(Yt.getDefaults(),arguments,["param","units","convert"]);for(yt(Nt(t.param)&&(ps(t.param)||t.param instanceof Yt),"param must be an AudioParam");!ps(t.param);)t.param=t.param._param;this._swappable=Nt(t.swappable)?t.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new wn(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,Nt(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Re.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return Nt(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return Nt(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(t,n){return this.units===n}_assertRange(t){return Nt(this.maxValue)&&Nt(this.minValue)&&Yn(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?RS(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&this.units==="decibels"?DS(t):t}setValueAtTime(t,n){const r=this.toSeconds(n),a=this._fromType(t);return yt(isFinite(a)&&isFinite(r),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(n)}`),this._assertRange(a),this.log(this.units,"setValueAtTime",t,r),this._events.add({time:r,type:"setValueAtTime",value:a}),this._param.setValueAtTime(a,r),this}getValueAtTime(t){const n=Math.max(this.toSeconds(t),0),r=this._events.getAfter(n),a=this._events.get(n);let c=this._initialValue;if(a===null)c=this._initialValue;else if(a.type==="setTargetAtTime"&&(r===null||r.type==="setValueAtTime")){const l=this._events.getBefore(a.time);let h;l===null?h=this._initialValue:h=l.value,a.type==="setTargetAtTime"&&(c=this._exponentialApproach(a.time,h,a.value,a.constant,n))}else if(r===null)c=a.value;else if(r.type==="linearRampToValueAtTime"||r.type==="exponentialRampToValueAtTime"){let l=a.value;if(a.type==="setTargetAtTime"){const h=this._events.getBefore(a.time);h===null?l=this._initialValue:l=h.value}r.type==="linearRampToValueAtTime"?c=this._linearInterpolate(a.time,l,r.time,r.value,n):c=this._exponentialInterpolate(a.time,l,r.time,r.value,n)}else c=a.value;return this._toType(c)}setRampPoint(t){t=this.toSeconds(t);let n=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),this._fromType(n)===0&&(n=this._toType(this._minOutput)),this.setValueAtTime(n,t),this}linearRampToValueAtTime(t,n){const r=this._fromType(t),a=this.toSeconds(n);return yt(isFinite(r)&&isFinite(a),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(n)}`),this._assertRange(r),this._events.add({time:a,type:"linearRampToValueAtTime",value:r}),this.log(this.units,"linearRampToValueAtTime",t,a),this._param.linearRampToValueAtTime(r,a),this}exponentialRampToValueAtTime(t,n){let r=this._fromType(t);r=sn(r,0)?this._minOutput:r,this._assertRange(r);const a=this.toSeconds(n);return yt(isFinite(r)&&isFinite(a),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(n)}`),this._events.add({time:a,type:"exponentialRampToValueAtTime",value:r}),this.log(this.units,"exponentialRampToValueAtTime",t,a),this._param.exponentialRampToValueAtTime(r,a),this}exponentialRampTo(t,n,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialRampToValueAtTime(t,r+this.toSeconds(n)),this}linearRampTo(t,n,r){return r=this.toSeconds(r),this.setRampPoint(r),this.linearRampToValueAtTime(t,r+this.toSeconds(n)),this}targetRampTo(t,n,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialApproachValueAtTime(t,r,n),this}exponentialApproachValueAtTime(t,n,r){n=this.toSeconds(n),r=this.toSeconds(r);const a=Math.log(r+1)/Math.log(200);return this.setTargetAtTime(t,n,a),this.cancelAndHoldAtTime(n+r*.9),this.linearRampToValueAtTime(t,n+r),this}setTargetAtTime(t,n,r){const a=this._fromType(t);yt(isFinite(r)&&r>0,"timeConstant must be a number greater than 0");const c=this.toSeconds(n);return this._assertRange(a),yt(isFinite(a)&&isFinite(c),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(n)}`),this._events.add({constant:r,time:c,type:"setTargetAtTime",value:a}),this.log(this.units,"setTargetAtTime",t,c,r),this._param.setTargetAtTime(a,c,r),this}setValueCurveAtTime(t,n,r,a=1){r=this.toSeconds(r),n=this.toSeconds(n);const c=this._fromType(t[0])*a;this.setValueAtTime(this._toType(c),n);const l=r/(t.length-1);for(let h=1;h<t.length;h++){const f=this._fromType(t[h])*a;this.linearRampToValueAtTime(this._toType(f),n+h*l)}return this}cancelScheduledValues(t){const n=this.toSeconds(t);return yt(isFinite(n),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(n),this._param.cancelScheduledValues(n),this.log(this.units,"cancelScheduledValues",n),this}cancelAndHoldAtTime(t){const n=this.toSeconds(t),r=this._fromType(this.getValueAtTime(n));yt(isFinite(n),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",n,"value="+r);const a=this._events.get(n),c=this._events.getAfter(n);return a&&sn(a.time,n)?c?(this._param.cancelScheduledValues(c.time),this._events.cancel(c.time)):(this._param.cancelAndHoldAtTime(n),this._events.cancel(n+this.sampleTime)):c&&(this._param.cancelScheduledValues(c.time),this._events.cancel(c.time),c.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(r),n):c.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(r),n)),this._events.add({time:n,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,n),this}rampTo(t,n=.1,r){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(t,n,r):this.linearRampTo(t,n,r),this}apply(t){const n=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(n),n);const r=this._events.get(n);if(r&&r.type==="setTargetAtTime"){const a=this._events.getAfter(r.time),c=a?a.time:n+2,l=(c-n)/10;for(let h=n;h<c;h+=l)t.linearRampToValueAtTime(this.getValueAtTime(h),h)}return this._events.forEachAfter(this.context.currentTime,a=>{a.type==="cancelScheduledValues"?t.cancelScheduledValues(a.time):a.type==="setTargetAtTime"?t.setTargetAtTime(a.value,a.time,a.constant):t[a.type](a.value,a.time)}),this}setParam(t){yt(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const n=this.input;return n.disconnect(this._param),this.apply(t),this._param=t,n.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,n,r,a,c){return r+(n-r)*Math.exp(-(c-t)/a)}_linearInterpolate(t,n,r,a,c){return n+(a-n)*((c-t)/(r-t))}_exponentialInterpolate(t,n,r,a,c){return n*Math.pow(a/n,(c-t)/(r-t))}}class Ct extends Re{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return Nt(this.input)?ps(this.input)||this.input instanceof Yt?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Nt(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return Nt(t)&&(t instanceof Ct||Zn(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach(r=>{r.channelCount=t.channelCount,r.channelCountMode=t.channelCountMode,r.channelInterpretation=t.channelInterpretation})}_getChannelProperties(){const t=this._getInternalNodes();yt(t.length>0,"ToneAudioNode does not have any internal nodes");const n=t[0];return{channelCount:n.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelInterpretation:t}))}connect(t,n=0,r=0){return js(this,t,n,r),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return mf("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,n=0,r=0){return qS(this,t,n,r),this}chain(...t){return Za(this,...t),this}fan(...t){return t.forEach(n=>this.connect(n)),this}dispose(){return super.dispose(),Nt(this.input)&&(this.input instanceof Ct?this.input.dispose():Zn(this.input)&&this.input.disconnect()),Nt(this.output)&&(this.output instanceof Ct?this.output.dispose():Zn(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Za(...i){const t=i.shift();i.reduce((n,r)=>(n instanceof Ct?n.connect(r):Zn(n)&&js(n,r),r),t)}function js(i,t,n=0,r=0){for(yt(Nt(i),"Cannot connect from undefined node"),yt(Nt(t),"Cannot connect to undefined node"),(t instanceof Ct||Zn(t))&&yt(t.numberOfInputs>0,"Cannot connect to node with no inputs"),yt(i.numberOfOutputs>0,"Cannot connect from node with no outputs");t instanceof Ct||t instanceof Yt;)Nt(t.input)&&(t=t.input);for(;i instanceof Ct;)Nt(i.output)&&(i=i.output);ps(t)?i.connect(t,n):i.connect(t,n,r)}function qS(i,t,n=0,r=0){if(Nt(t))for(;t instanceof Ct;)t=t.input;for(;!Zn(i);)Nt(i.output)&&(i=i.output);ps(t)?i.disconnect(t,n):Zn(t)?i.disconnect(t,n,r):i.disconnect()}class Ae extends Ct{constructor(){super(rt(Ae.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=rt(Ae.getDefaults(),arguments,["gain","units"]);this.gain=new Yt({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),te(this,"gain")}static getDefaults(){return Object.assign(Ct.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class $s extends Ct{constructor(t){super(t),this.onended=qt,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Ae({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(n){const r=this.toSeconds(n);return this._startTime!==-1&&r>=this._startTime&&(this._stopTime===-1||r<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(Ct.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:qt})}_startGain(t,n=1){yt(this._startTime===-1,"Source cannot be started more than once");const r=this.toSeconds(this._fadeIn);return this._startTime=t+r,this._startTime=Math.max(this._startTime,this.context.currentTime),r>0?(this._gainNode.gain.setValueAtTime(0,t),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(n,t+r):this._gainNode.gain.exponentialApproachValueAtTime(n,t,r)):this._gainNode.gain.setValueAtTime(n,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){yt(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const n=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+n,this._stopTime=Math.max(this._stopTime,this.context.currentTime),n>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,n,t):this._gainNode.gain.targetRampTo(0,n,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const r=this._curve==="exponential"?n*2:0;this._stopSource(this.now()+r),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==qt&&(this.onended(this),this.onended=qt,!this.context.isOffline)){const t=()=>this.dispose();typeof window.requestIdleCallback<"u"?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),yt(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class Ki extends $s{constructor(){super(rt(Ki.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=rt(Ki.getDefaults(),arguments,["offset"]);js(this._source,this._gainNode),this.offset=new Yt({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign($s.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const n=this.toSeconds(t);return this.log("start",n),this._startGain(n),this._source.start(n),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class le extends Ct{constructor(){super(rt(le.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=rt(le.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Ki({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Ct.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,n=0,r=0){return vc(this,t,n,r),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,n){return this._param.setValueAtTime(t,n),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,n){return this._param.linearRampToValueAtTime(t,n),this}exponentialRampToValueAtTime(t,n){return this._param.exponentialRampToValueAtTime(t,n),this}exponentialRampTo(t,n,r){return this._param.exponentialRampTo(t,n,r),this}linearRampTo(t,n,r){return this._param.linearRampTo(t,n,r),this}targetRampTo(t,n,r){return this._param.targetRampTo(t,n,r),this}exponentialApproachValueAtTime(t,n,r){return this._param.exponentialApproachValueAtTime(t,n,r),this}setTargetAtTime(t,n,r){return this._param.setTargetAtTime(t,n,r),this}setValueCurveAtTime(t,n,r,a){return this._param.setValueCurveAtTime(t,n,r,a),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,n,r){return this._param.rampTo(t,n,r),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function vc(i,t,n,r){(t instanceof Yt||ps(t)||t instanceof le&&t.override)&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof le&&(t.overridden=!0)),js(i,t,n,r)}class Zi extends Yt{constructor(){super(rt(Zi.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new wn(1/0),this._multiplier=1;const t=rt(Zi.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Yt.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,n,r){n=this.toSeconds(n),this.setRampPoint(n);const a=this._fromType(t),c=this._events.get(n),l=Math.round(Math.max(1/r,1));for(let h=0;h<=l;h++){const f=r*h+n,d=this._exponentialApproach(c.time,c.value,a,r,f);this.linearRampToValueAtTime(this._toType(d),f)}return this}setValueAtTime(t,n){const r=this.toSeconds(n);super.setValueAtTime(t,n);const a=this._events.get(r),c=this._events.previousEvent(a),l=this._getTicksUntilEvent(c,r);return a.ticks=Math.max(l,0),this}linearRampToValueAtTime(t,n){const r=this.toSeconds(n);super.linearRampToValueAtTime(t,n);const a=this._events.get(r),c=this._events.previousEvent(a),l=this._getTicksUntilEvent(c,r);return a.ticks=Math.max(l,0),this}exponentialRampToValueAtTime(t,n){n=this.toSeconds(n);const r=this._fromType(t),a=this._events.get(n),c=Math.round(Math.max((n-a.time)*10,1)),l=(n-a.time)/c;for(let h=0;h<=c;h++){const f=l*h+a.time,d=this._exponentialInterpolate(a.time,a.value,n,r,f);this.linearRampToValueAtTime(this._toType(d),f)}return this}_getTicksUntilEvent(t,n){if(t===null)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(je(t.ticks)){const l=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(l,t.time)}const r=this._fromType(this.getValueAtTime(t.time));let a=this._fromType(this.getValueAtTime(n));const c=this._events.get(n);return c&&c.time===n&&c.type==="setValueAtTime"&&(a=this._fromType(this.getValueAtTime(n-this.sampleTime))),.5*(n-t.time)*(r+a)+t.ticks}getTicksAtTime(t){const n=this.toSeconds(t),r=this._events.get(n);return Math.max(this._getTicksUntilEvent(r,n),0)}getDurationOfTicks(t,n){const r=this.toSeconds(n),a=this.getTicksAtTime(n);return this.getTimeOfTick(a+t)-r}getTimeOfTick(t){const n=this._events.get(t,"ticks"),r=this._events.getAfter(t,"ticks");if(n&&n.ticks===t)return n.time;if(n&&r&&r.type==="linearRampToValueAtTime"&&n.value!==r.value){const a=this._fromType(this.getValueAtTime(n.time)),l=(this._fromType(this.getValueAtTime(r.time))-a)/(r.time-n.time),h=Math.sqrt(Math.pow(a,2)-2*l*(n.ticks-t)),f=(-a+h)/l,d=(-a-h)/l;return(f>0?f:d)+n.time}else return n?n.value===0?1/0:n.time+(t-n.ticks)/n.value:t/this._initialValue}ticksToTime(t,n){return this.getDurationOfTicks(t,n)}timeToTicks(t,n){const r=this.toSeconds(n),a=this.toSeconds(t),c=this.getTicksAtTime(r);return this.getTicksAtTime(r+a)-c}_fromType(t){return this.units==="bpm"&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return this.units==="bpm"&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const n=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(n,0)}}class Yi extends le{constructor(){super(rt(Yi.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=rt(Yi.getDefaults(),arguments,["value"]);this.input=this._param=new Zi({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(le.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,n){return this._param.ticksToTime(t,n)}timeToTicks(t,n){return this._param.timeToTicks(t,n)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,n){return this._param.getDurationOfTicks(t,n)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class Xi extends Re{constructor(){super(rt(Xi.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new gc,this._tickOffset=new wn;const t=rt(Xi.getDefaults(),arguments,["frequency"]);this.frequency=new Yi({context:this.context,units:t.units,value:t.frequency}),te(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Re.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,n){const r=this.toSeconds(t);return this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),Nt(n)&&this.setTicksAtTime(n,r)),this}stop(t){const n=this.toSeconds(t);if(this._state.getValueAtTime(n)==="stopped"){const r=this._state.get(n);r&&r.time>0&&(this._tickOffset.cancel(r.time),this._state.cancel(r.time))}return this._state.cancel(n),this._state.setStateAtTime("stopped",n),this.setTicksAtTime(0,n),this}pause(t){const n=this.toSeconds(t);return this._state.getValueAtTime(n)==="started"&&this._state.setStateAtTime("paused",n),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const n=this.toSeconds(t),r=this._state.getLastState("stopped",n),a={state:"paused",time:n};this._state.add(a);let c=r,l=0;return this._state.forEachBetween(r.time,n+this.sampleTime,h=>{let f=c.time;const d=this._tickOffset.get(h.time);d&&d.time>=c.time&&(l=d.ticks,f=d.time),c.state==="started"&&h.state!=="started"&&(l+=this.frequency.getTicksAtTime(h.time)-this.frequency.getTicksAtTime(f)),c=h}),this._state.remove(a),l}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const n=this.now(),r=this.frequency.timeToTicks(t,n);this.setTicksAtTime(r,n)}getSecondsAtTime(t){t=this.toSeconds(t);const n=this._state.getLastState("stopped",t),r={state:"paused",time:t};this._state.add(r);let a=n,c=0;return this._state.forEachBetween(n.time,t+this.sampleTime,l=>{let h=a.time;const f=this._tickOffset.get(l.time);f&&f.time>=a.time&&(c=f.seconds,h=f.time),a.state==="started"&&l.state!=="started"&&(c+=l.time-h),a=l}),this._state.remove(r),c}setTicksAtTime(t,n){return n=this.toSeconds(n),this._tickOffset.cancel(n),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,n),ticks:t,time:n}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,n=this.now()){const r=this._tickOffset.get(n),a=this._state.get(n),c=Math.max(r.time,a.time),l=this.frequency.getTicksAtTime(c)+t-r.ticks;return this.frequency.getTimeOfTick(l)}forEachTickBetween(t,n,r){let a=this._state.get(t);this._state.forEachBetween(t,n,l=>{a&&a.state==="started"&&l.state!=="started"&&this.forEachTickBetween(Math.max(a.time,t),l.time-this.sampleTime,r),a=l});let c=null;if(a&&a.state==="started"){const l=Math.max(a.time,t),h=this.frequency.getTicksAtTime(l),f=this.frequency.getTicksAtTime(a.time),d=h-f;let _=Math.ceil(d)-d;_=sn(_,1)?0:_;let v=this.frequency.getTimeOfTick(h+_);for(;v<n;){try{r(v,Math.round(this.getTicksAtTime(v)))}catch(b){c=b;break}v+=this.frequency.getDurationOfTicks(1,v)}}if(c)throw c;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class Tr extends Re{constructor(){super(rt(Tr.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=qt,this._lastUpdate=0,this._state=new gc("stopped"),this._boundLoop=this._loop.bind(this);const t=rt(Tr.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new Xi({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,te(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Re.getDefaults(),{callback:qt,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,n){pf(this.context);const r=this.toSeconds(t);return this.log("start",r),this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),this._tickSource.start(r,n),r<this._lastUpdate&&this.emit("start",r,n)),this}stop(t){const n=this.toSeconds(t);return this.log("stop",n),this._state.cancel(n),this._state.setStateAtTime("stopped",n),this._tickSource.stop(n),n<this._lastUpdate&&this.emit("stop",n),this}pause(t){const n=this.toSeconds(t);return this._state.getValueAtTime(n)==="started"&&(this._state.setStateAtTime("paused",n),this._tickSource.pause(n),n<this._lastUpdate&&this.emit("pause",n)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,n){return this._tickSource.setTicksAtTime(t,n),this}getTimeOfTick(t,n=this.now()){return this._tickSource.getTimeOfTick(t,n)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,n){const r=this.toSeconds(n),a=this.getTicksAtTime(r);return this._tickSource.getTimeOfTick(a+t,r)}_loop(){const t=this._lastUpdate,n=this.now();this._lastUpdate=n,this.log("loop",t,n),t!==n&&(this._state.forEachBetween(t,n,r=>{switch(r.state){case"started":const a=this._tickSource.getTicksAtTime(r.time);this.emit("start",r.time,a);break;case"stopped":r.time!==0&&this.emit("stop",r.time);break;case"paused":this.emit("pause",r.time);break}}),this._tickSource.forEachTickBetween(t,n,(r,a)=>{this.callback(r,a)}))}getStateAtTime(t){const n=this.toSeconds(t);return this._state.getValueAtTime(n)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Br.mixin(Tr);class yc extends Pn{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=rt(yc.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(n=>{this._loadingCount++;const r=t.urls[n];this.add(n,r,this._bufferLoaded.bind(this,t.onload),t.onerror)})}static getDefaults(){return{baseUrl:"",onerror:qt,onload:qt,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return yt(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,this._loadingCount===0&&t&&t()}get loaded(){return Array.from(this._buffers).every(([t,n])=>n.loaded)}add(t,n,r=qt,a=qt){return mn(n)?this._buffers.set(t.toString(),new Gt(this.baseUrl+n,r,a)):this._buffers.set(t.toString(),new Gt(n,r,a)),this}dispose(){return super.dispose(),this._buffers.forEach(t=>t.dispose()),this._buffers.clear(),this}}class kn extends gr{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class BS extends Re{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new wn,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,n){return this._events.add({callback:t,time:this.toSeconds(n)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const n=this._events.shift();n&&t-n.time<=this.expiration&&n.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}ao(i=>{i.draw=new BS({context:i})});co(i=>{i.draw.dispose()});class US extends Pn{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){yt(Nt(t.time),"Events must have a time property"),yt(Nt(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let n=new GS(t.time,t.time+t.duration,t);for(this._root===null?this._root=n:this._root.insert(n),this._length++;n!==null;)n.updateHeight(),n.updateMax(),this._rebalance(n),n=n.parent;return this}remove(t){if(this._root!==null){const n=[];this._root.search(t.time,n);for(const r of n)if(r.event===t){this._removeNode(r),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,n=>this.remove(n)),this}_setRoot(t){this._root=t,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(t,n){t.parent!==null?(t.isLeftChild()?t.parent.left=n:t.parent.right=n,this._rebalance(t.parent)):this._setRoot(n)}_removeNode(t){if(t.left===null&&t.right===null)this._replaceNodeInParent(t,null);else if(t.right===null)this._replaceNodeInParent(t,t.left);else if(t.left===null)this._replaceNodeInParent(t,t.right);else{const n=t.getBalance();let r,a=null;if(n>0)if(t.left.right===null)r=t.left,r.right=t.right,a=r;else{for(r=t.left.right;r.right!==null;)r=r.right;r.parent&&(r.parent.right=r.left,a=r.parent,r.left=t.left,r.right=t.right)}else if(t.right.left===null)r=t.right,r.left=t.left,a=r;else{for(r=t.right.left;r.left!==null;)r=r.left;r.parent&&(r.parent.left=r.right,a=r.parent,r.left=t.left,r.right=t.right)}t.parent!==null?t.isLeftChild()?t.parent.left=r:t.parent.right=r:this._setRoot(r),a&&this._rebalance(a)}t.dispose()}_rotateLeft(t){const n=t.parent,r=t.isLeftChild(),a=t.right;a&&(t.right=a.left,a.left=t),n!==null?r?n.left=a:n.right=a:this._setRoot(a)}_rotateRight(t){const n=t.parent,r=t.isLeftChild(),a=t.left;a&&(t.left=a.right,a.right=t),n!==null?r?n.left=a:n.right=a:this._setRoot(a)}_rebalance(t){const n=t.getBalance();n>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):n<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(this._root!==null){const n=[];if(this._root.search(t,n),n.length>0){let r=n[0];for(let a=1;a<n.length;a++)n[a].low>r.low&&(r=n[a]);return r.event}}return null}forEach(t){if(this._root!==null){const n=[];this._root.traverse(r=>n.push(r)),n.forEach(r=>{r.event&&t(r.event)})}return this}forEachAtTime(t,n){if(this._root!==null){const r=[];this._root.search(t,r),r.forEach(a=>{a.event&&n(a.event)})}return this}forEachFrom(t,n){if(this._root!==null){const r=[];this._root.searchAfter(t,r),r.forEach(a=>{a.event&&n(a.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(t=>t.dispose()),this._root=null,this}}class GS{constructor(t,n,r){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=r,this.low=t,this.high=n,this.max=this.high}insert(t){t.low<=this.low?this.left===null?this.left=t:this.left.insert(t):this.right===null?this.right=t:this.right.insert(t)}search(t,n){t>this.max||(this.left!==null&&this.left.search(t,n),this.low<=t&&this.high>t&&n.push(this),!(this.low>t)&&this.right!==null&&this.right.search(t,n))}searchAfter(t,n){this.low>=t&&(n.push(this),this.left!==null&&this.left.searchAfter(t,n)),this.right!==null&&this.right.searchAfter(t,n)}traverse(t){t(this),this.left!==null&&this.left.traverse(t),this.right!==null&&this.right.traverse(t)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return this.left!==null&&this.right!==null?t=this.left.height-this.right.height:this.left!==null?t=this.left.height+1:this.right!==null&&(t=-(this.right.height+1)),t}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,t!==null&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,t!==null&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class _s extends Ct{constructor(){super(rt(_s.getDefaults(),arguments,["volume"])),this.name="Volume";const t=rt(_s.getDefaults(),arguments,["volume"]);this.input=this.output=new Ae({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,te(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(Ct.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Qi extends Ct{constructor(){super(rt(Qi.getDefaults(),arguments)),this.name="Destination",this.input=new _s({context:this.context}),this.output=new Ae({context:this.context}),this.volume=this.input.volume;const t=rt(Qi.getDefaults(),arguments);Za(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Ct.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Za(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}ao(i=>{i.destination=new Qi({context:i})});co(i=>{i.destination.dispose()});class $S extends Pn{constructor(t){super(),this.name="TimelineValue",this._timeline=new wn({memory:10}),this._initialValue=t}set(t,n){return this._timeline.add({value:t,time:n}),this}get(t){const n=this._timeline.get(t);return n?n.value:this._initialValue}}class Xn{constructor(t,n){this.id=Xn._eventId++;const r=Object.assign(Xn.getDefaults(),n);this.transport=t,this.callback=r.callback,this._once=r.once,this.time=r.time}static getDefaults(){return{callback:qt,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}Xn._eventId=0;class wc extends Xn{constructor(t,n){super(t,n),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const r=Object.assign(wc.getDefaults(),n);this.duration=new kn(t.context,r.duration).valueOf(),this._interval=new kn(t.context,r.interval).valueOf(),this._nextTick=r.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Xn.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const n=this.transport.getTicksAtTime(t);n>=this.time&&n>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new kn(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const n=this.transport.getTicksAtTime(t);n>this.time&&(this._nextTick=this.time+Math.ceil((n-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new kn(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new kn(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class br extends Re{constructor(){super(rt(br.getDefaults(),arguments)),this.name="Transport",this._loop=new $S(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new wn,this._repeatedEvents=new US,this._syncedSignals=[],this._swingAmount=0;const t=rt(br.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new Tr({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),te(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(Re.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,n){if(this._loop.get(t)&&n>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),n=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&n%this._ppq!==0&&n%(this._swingTicks*2)!==0){const r=n%(this._swingTicks*2)/(this._swingTicks*2),a=Math.sin(r*Math.PI)*this._swingAmount;t+=new kn(this.context,this._swingTicks*2/3).toSeconds()*a}this._timeline.forEachAtTime(n,r=>r.invoke(t))}schedule(t,n){const r=new Xn(this,{callback:t,time:new gr(this.context,n).toTicks()});return this._addEvent(r,this._timeline)}scheduleRepeat(t,n,r,a=1/0){const c=new wc(this,{callback:t,duration:new rn(this.context,a).toTicks(),interval:new rn(this.context,n).toTicks(),time:new gr(this.context,r).toTicks()});return this._addEvent(c,this._repeatedEvents)}scheduleOnce(t,n){const r=new Xn(this,{callback:t,once:!0,time:new gr(this.context,n).toTicks()});return this._addEvent(r,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const n=this._scheduledEvents[t.toString()];n.timeline.remove(n.event),n.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,n){return this._scheduledEvents[t.id.toString()]={event:t,timeline:n},n.add(t),t.id}cancel(t=0){const n=this.toTicks(t);return this._timeline.forEachFrom(n,r=>this.clear(r.id)),this._repeatedEvents.forEachFrom(n,r=>this.clear(r.id)),this}_bindClockEvents(){this._clock.on("start",(t,n)=>{n=new kn(this.context,n).toSeconds(),this.emit("start",t,n)}),this._clock.on("stop",t=>{this.emit("stop",t)}),this._clock.on("pause",t=>{this.emit("pause",t)})}get state(){return this._clock.getStateAtTime(this.now())}start(t,n){let r;return Nt(n)&&(r=this.toTicks(n)),this._clock.start(t,r),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),this._clock.getStateAtTime(t)!=="started"?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){on(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new rn(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new rn(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,n){return this.loopStart=t,this.loopEnd=n,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new kn(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),n=this._clock.getTicksAtTime(t);return new kn(this.context,n).toBarsBeatsSixteenths()}set position(t){const n=this.toTicks(t);this.ticks=n}get seconds(){return this._clock.seconds}set seconds(t){const n=this.now(),r=this._clock.frequency.timeToTicks(t,n);this.ticks=r}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const n=this.now();if(this.state==="started"){const r=this._clock.getTicksAtTime(n),a=this._clock.frequency.getDurationOfTicks(Math.ceil(r)-r,n),c=n+a;this.emit("stop",c),this._clock.setTicksAtTime(t,c),this.emit("start",c,this._clock.getSecondsAtTime(c))}else this._clock.setTicksAtTime(t,n)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),this.state!=="started")return 0;{const n=this.now(),r=this.getTicksAtTime(n),a=t-r%t;return this._clock.nextTickTime(a,n)}}syncSignal(t,n){if(!n){const a=this.now();if(t.getValueAtTime(a)!==0){const c=this.bpm.getValueAtTime(a),l=1/(60/c/this.PPQ);n=t.getValueAtTime(a)/l}else n=0}const r=new Ae(n);return this.bpm.connect(r),r.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:r,signal:t}),t.value=0,this}unsyncSignal(t){for(let n=this._syncedSignals.length-1;n>=0;n--){const r=this._syncedSignals[n];r.signal===t&&(r.ratio.dispose(),r.signal.value=r.initial,this._syncedSignals.splice(n,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),bf(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Br.mixin(br);ao(i=>{i.transport=new br({context:i})});co(i=>{i.transport.dispose()});class Be extends Ct{constructor(t){super(t),this.input=void 0,this._state=new gc("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=qt,this._syncedStop=qt,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new _s({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,te(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(Ct.getDefaults(),{mute:!1,onstop:qt,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,n,r){let a=je(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(a=this._clampToCurrentTime(a),!this._synced&&this._state.getValueAtTime(a)==="started")yt(zi(a,this._state.get(a).time),"Start time must be strictly greater than previous start time"),this._state.cancel(a),this._state.setStateAtTime("started",a),this.log("restart",a),this.restart(a,n,r);else if(this.log("start",a),this._state.setStateAtTime("started",a),this._synced){const c=this._state.get(a);c&&(c.offset=this.toSeconds(qs(n,0)),c.duration=r?this.toSeconds(r):void 0);const l=this.context.transport.schedule(h=>{this._start(h,n,r)},a);this._scheduled.push(l),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>a&&this._syncedStart(this.now(),this.context.transport.seconds)}else pf(this.context),this._start(a,n,r);return this}stop(t){let n=je(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(n=this._clampToCurrentTime(n),this._state.getValueAtTime(n)==="started"||Nt(this._state.getNextState("started",n))){if(this.log("stop",n),!this._synced)this._stop(n);else{const r=this.context.transport.schedule(this._stop.bind(this),n);this._scheduled.push(r)}this._state.cancel(n),this._state.setStateAtTime("stopped",n)}return this}restart(t,n,r){return t=this.toSeconds(t),this._state.getValueAtTime(t)==="started"&&(this._state.cancel(t),this._restart(t,n,r)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,n)=>{if(n>0){const r=this._state.get(n);if(r&&r.state==="started"&&r.time!==n){const a=n-this.toSeconds(r.time);let c;r.duration&&(c=this.toSeconds(r.duration)-a),this._start(t,this.toSeconds(r.offset)+a,c)}}},this._syncedStop=t=>{const n=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));this._state.getValueAtTime(n)==="started"&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=>this.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=qt,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Sr extends $s{constructor(){super(rt(Sr.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=rt(Sr.getDefaults(),arguments,["url","onload"]);js(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Yt({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new Gt(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign($s.getDefaults(),{url:new Gt,loop:!1,loopEnd:0,loopStart:0,onload:qt,onerror:qt,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,n,r,a=1){yt(this.buffer.loaded,"buffer is either not set or not loaded");const c=this.toSeconds(t);this._startGain(c,a),this.loop?n=qs(n,this.loopStart):n=qs(n,0);let l=Math.max(this.toSeconds(n),0);if(this.loop){const h=this.toSeconds(this.loopEnd)||this.buffer.duration,f=this.toSeconds(this.loopStart),d=h-f;za(l,h)&&(l=(l-f)%d+f),sn(l,this.buffer.duration)&&(l=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,vf(l,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(c,l)),Nt(r)){let h=this.toSeconds(r);h=Math.max(h,0),this.stop(c+h)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function Ts(i,t){return oe(this,void 0,void 0,function*(){const n=t/i.context.sampleRate,r=new _c(1,n,i.context.sampleRate);return new i.constructor(Object.assign(i.get(),{frequency:2/n,detune:0,context:r})).toDestination().start(0),(yield r.render()).getChannelData(0)})}class ji extends $s{constructor(){super(rt(ji.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=rt(ji.getDefaults(),arguments,["frequency","type"]);js(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new Yt({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new Yt({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),te(this,["frequency","detune"])}static getDefaults(){return Object.assign($s.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const n=this.toSeconds(t);return this.log("start",n),this._startGain(n),this._oscillator.start(n),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class re extends Be{constructor(){super(rt(re.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=rt(re.getDefaults(),arguments,["frequency","type"]);this.frequency=new le({context:this.context,units:"frequency",value:t.frequency}),te(this,"frequency"),this.detune=new le({context:this.context,units:"cents",value:t.detune}),te(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&t.type!=="custom"&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(Be.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const n=this.toSeconds(t),r=new ji({context:this.context,onended:()=>this.onstop(this)});this._oscillator=r,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(n)}_stop(t){const n=this.toSeconds(t);this._oscillator&&this._oscillator.stop(n)}_restart(t){const n=this.toSeconds(t);return this.log("restart",n),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(n),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return re._periodicWaveCache.find(n=>n.phase===this._phase&&AS(n.partials,this._partials));{const t=re._periodicWaveCache.find(n=>n.type===this._type&&n.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const n=["sine","square","sawtooth","triangle"].indexOf(t)!==-1;if(this._phase===0&&n)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=t);else{const r=this._getCachedPeriodicWave();if(Nt(r)){const{partials:a,wave:c}=r;this._wave=c,this._partials=a,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[a,c]=this._getRealImaginary(t,this._phase),l=this.context.createPeriodicWave(a,c);this._wave=l,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),re._periodicWaveCache.push({imag:c,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:a,type:this._type,wave:this._wave}),re._periodicWaveCache.length>100&&re._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&this._type!=="custom"&&t!=="custom"?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){Yn(t,0);let n=this._type;const r=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(r&&(n=r[1]),this._type!=="custom")t===0?this.type=n:this.type=n+t.toString();else{const a=new Float32Array(t);this._partials.forEach((c,l)=>a[l]=c),this._partials=Array.from(a),this.type=this._type}}_getRealImaginary(t,n){let a=2048;const c=new Float32Array(a),l=new Float32Array(a);let h=1;if(t==="custom"){if(h=this._partials.length+1,this._partialCount=this._partials.length,a=h,this._partials.length===0)return[c,l]}else{const f=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);f?(h=parseInt(f[2],10)+1,this._partialCount=parseInt(f[2],10),t=f[1],h=Math.max(h,2),a=h):this._partialCount=0,this._partials=[]}for(let f=1;f<a;++f){const d=2/(f*Math.PI);let _;switch(t){case"sine":_=f<=h?1:0,this._partials[f-1]=_;break;case"square":_=f&1?2*d:0,this._partials[f-1]=_;break;case"sawtooth":_=d*(f&1?1:-1),this._partials[f-1]=_;break;case"triangle":f&1?_=2*(d*d)*(f-1>>1&1?-1:1):_=0,this._partials[f-1]=_;break;case"custom":_=this._partials[f-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}_!==0?(c[f]=-_*Math.sin(n*f),l[f]=_*Math.cos(n*f)):(c[f]=0,l[f]=0)}return[c,l]}_inverseFFT(t,n,r){let a=0;const c=t.length;for(let l=0;l<c;l++)a+=t[l]*Math.cos(l*r)+n[l]*Math.sin(l*r);return a}getInitialValue(){const[t,n]=this._getRealImaginary(this._type,0);let r=0;const a=Math.PI*2,c=32;for(let l=0;l<c;l++)r=Math.max(this._inverseFFT(t,n,l/c*a),r);return NS(-this._inverseFFT(t,n,this._phase)/r,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return oe(this,void 0,void 0,function*(){return Ts(this,t)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}re._periodicWaveCache=[];class lo extends Ct{constructor(){super(Object.assign(rt(lo.getDefaults(),arguments,["context"])))}connect(t,n=0,r=0){return vc(this,t,n,r),this}}class Cr extends lo{constructor(){super(Object.assign(rt(Cr.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=rt(Cr.getDefaults(),arguments,["mapping","length"]);on(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):gS(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(le.getDefaults(),{length:1024})}setMap(t,n=1024){const r=new Float32Array(n);for(let a=0,c=n;a<c;a++){const l=a/(c-1)*2-1;r[a]=t(l,a)}return this.curve=r,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){const n=["none","2x","4x"].some(r=>r.includes(t));yt(n,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class HS extends lo{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Cr({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class ms extends le{constructor(){super(Object.assign(rt(ms.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=rt(ms.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Ae({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(le.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Ar extends Be{constructor(){super(rt(Ar.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new HS({context:this.context}),this._modulationNode=new Ae({context:this.context});const t=rt(Ar.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new re({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new re({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new ms({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),te(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(re.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return oe(this,void 0,void 0,function*(){return Ts(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class xr extends Be{constructor(){super(rt(xr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Ae({context:this.context,gain:0});const t=rt(xr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new re({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new le({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new re({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new ms({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new ms({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),te(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(re.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return oe(this,void 0,void 0,function*(){return Ts(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Hs extends Be{constructor(){super(rt(Hs.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Ae({context:this.context,gain:0}),this._thresh=new Cr({context:this.context,mapping:n=>n<=0?-1:1});const t=rt(Hs.getDefaults(),arguments,["frequency","width"]);this.width=new le({context:this.context,units:"audioRange",value:t.width}),this._triangle=new re({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),te(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Be.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return oe(this,void 0,void 0,function*(){return Ts(this,t)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Nr extends Be{constructor(){super(rt(Nr.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=rt(Nr.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new le({context:this.context,units:"frequency",value:t.frequency}),this.detune=new le({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,te(this,["frequency","detune"])}static getDefaults(){return Object.assign(re.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach(n=>n.start(t))}_stop(t){t=this.toSeconds(t),this._forEach(n=>n.stop(t))}_restart(t){this._forEach(n=>n.restart(t))}_forEach(t){for(let n=0;n<this._oscillators.length;n++)t(this._oscillators[n],n)}get type(){return this._type}set type(t){this._type=t,this._forEach(n=>n.type=t)}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const n=-t/2,r=t/(this._oscillators.length-1);this._forEach((a,c)=>a.detune.value=n+r*c)}}get count(){return this._oscillators.length}set count(t){if(Yn(t,1),this._oscillators.length!==t){this._forEach(n=>n.dispose()),this._oscillators=[];for(let n=0;n<t;n++){const r=new re({context:this.context,volume:-6-t*1.1,type:this._type,phase:this._phase+n/t*360,partialCount:this._partialCount,onstop:n===0?()=>this.onstop(this):qt});this.type==="custom"&&(r.partials=this._partials),this.frequency.connect(r.frequency),this.detune.connect(r.detune),r.detune.overridden=!1,r.connect(this.output),this._oscillators[n]=r}this.spread=this._spread,this.state==="started"&&this._forEach(n=>n.start())}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach((n,r)=>n.phase=this._phase+r/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach(n=>n.baseType=t),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach(n=>n.partials=t))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach(n=>n.partialCount=t),this._type=this._oscillators[0].type}asArray(t=1024){return oe(this,void 0,void 0,function*(){return Ts(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=>t.dispose()),this}}class Ir extends Be{constructor(){super(rt(Ir.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new ms({context:this.context,value:2});const t=rt(Ir.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Hs({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new re({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),te(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Be.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return oe(this,void 0,void 0,function*(){return Ts(this,t)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const mh={am:Ar,fat:Nr,fm:xr,oscillator:re,pulse:Hs,pwm:Ir};class Er extends Be{constructor(){super(rt(Er.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=rt(Er.getDefaults(),arguments,["frequency","type"]);this.frequency=new le({context:this.context,units:"frequency",value:t.frequency}),this.detune=new le({context:this.context,units:"cents",value:t.detune}),te(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(re.getDefaults(),xr.getDefaults(),Ar.getDefaults(),Nr.getDefaults(),Hs.getDefaults(),Ir.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some(n=>this._sourceType===n)&&(t=this._sourceType),t+this._oscillator.type}set type(t){t.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):t==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):t==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const n=mh[t],r=this.now();if(this._oscillator){const a=this._oscillator;a.stop(r),this.context.setTimeout(()=>a.dispose(),this.blockTime)}this._oscillator=new n({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(r)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let n="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(n=this._oscillator.type),t==="fm"?this.type="fm"+n:t==="am"?this.type="am"+n:t==="fat"?this.type="fat"+n:t==="oscillator"?this.type=n:t==="pulse"?this.type="pulse":t==="pwm"&&(this.type="pwm")}_getOscType(t,n){return t instanceof mh[n]}get baseType(){return this._oscillator.baseType}set baseType(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&t!=="pulse"&&t!=="pwm"&&(this._oscillator.baseType=t)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(t){this._getOscType(this._oscillator,"fat")&&ds(t)&&(this._oscillator.count=t)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(t){this._getOscType(this._oscillator,"fat")&&ds(t)&&(this._oscillator.spread=t)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&mn(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(t=1024){return oe(this,void 0,void 0,function*(){return Ts(this,t)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function xf(i,t=1/0){const n=new WeakMap;return function(r,a){Reflect.defineProperty(r,a,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(c){Yn(c,i,t),n.set(this,c)}})}}function Fn(i,t=1/0){const n=new WeakMap;return function(r,a){Reflect.defineProperty(r,a,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(c){Yn(this.toSeconds(c),i,t),n.set(this,c)}})}}class Or extends Be{constructor(){super(rt(Or.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=rt(Or.getDefaults(),arguments,["url","onload"]);this._buffer=new Gt({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Be.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:qt,onerror:qt,playbackRate:1,reverse:!1})}load(t){return oe(this,void 0,void 0,function*(){return yield this._buffer.load(t),this._onload(),this})}_onload(t=qt){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,n,r){return super.start(t,n,r),this}_start(t,n,r){this._loop?n=qs(n,this._loopStart):n=qs(n,0);const a=this.toSeconds(n),c=r;r=qs(r,Math.max(this._buffer.duration-a,0));let l=this.toSeconds(r);l=l/this._playbackRate,t=this.toSeconds(t);const h=new Sr({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(t+l),this._state.setStateAtTime("stopped",t+l,{implicitEnd:!0})),this._activeSources.add(h),this._loop&&je(c)?h.start(t,a):h.start(t,a,l-this.toSeconds(this.fadeOut))}_stop(t){const n=this.toSeconds(t);this._activeSources.forEach(r=>r.stop(n))}restart(t,n,r){return super.restart(t,n,r),this}_restart(t,n,r){this._stop(t),this._start(t,n,r)}seek(t,n){const r=this.toSeconds(n);if(this._state.getValueAtTime(r)==="started"){const a=this.toSeconds(t);this._stop(r),this._start(r,a)}return this}setLoopPoints(t,n){return this.loopStart=t,this.loopEnd=n,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&Yn(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(n=>{n.loopStart=t})}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&Yn(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(n=>{n.loopEnd=t})}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(n=>{n.loop=t}),t)){const n=this._state.getNextState("stopped",this.now());n&&this._state.cancel(n.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const n=this.now(),r=this._state.getNextState("stopped",n);r&&r.implicitEnd&&(this._state.cancel(r.time),this._activeSources.forEach(a=>a.cancelStop())),this._activeSources.forEach(a=>{a.playbackRate.setValueAtTime(t,n)})}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(t=>t.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}ln([Fn(0)],Or.prototype,"fadeIn",void 0);ln([Fn(0)],Or.prototype,"fadeOut",void 0);class Rn extends Ct{constructor(){super(rt(Rn.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new le({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=rt(Rn.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(Ct.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,n){if(mn(t))return t;{let r;for(r in Di)if(Di[r][n]===t)return r;return t}}_setCurve(t,n,r){if(mn(r)&&Reflect.has(Di,r)){const a=Di[r];ls(a)?t!=="_decayCurve"&&(this[t]=a[n]):this[t]=a}else if(on(r)&&t!=="_decayCurve")this[t]=r;else throw new Error("Envelope: invalid curve: "+r)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){yt(["linear","exponential"].some(n=>n===t),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,n=1){this.log("triggerAttack",t,n),t=this.toSeconds(t);let a=this.toSeconds(this.attack);const c=this.toSeconds(this.decay),l=this.getValueAtTime(t);if(l>0){const h=1/a;a=(1-l)/h}if(a<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(n,t);else if(this._attackCurve==="linear")this._sig.linearRampTo(n,a,t);else if(this._attackCurve==="exponential")this._sig.targetRampTo(n,a,t);else{this._sig.cancelAndHoldAtTime(t);let h=this._attackCurve;for(let f=1;f<h.length;f++)if(h[f-1]<=l&&l<=h[f]){h=this._attackCurve.slice(f),h[0]=l;break}this._sig.setValueCurveAtTime(h,t,a,n)}if(c&&this.sustain<1){const h=n*this.sustain,f=t+a;this.log("decay",f),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(h,c+f):this._sig.exponentialApproachValueAtTime(h,f,c)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const n=this.getValueAtTime(t);if(n>0){const r=this.toSeconds(this.release);r<this.sampleTime?this._sig.setValueAtTime(0,t):this._releaseCurve==="linear"?this._sig.linearRampTo(0,r,t):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,r,t):(yt(on(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,r,n))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,n,r=1){return n=this.toSeconds(n),this.triggerAttack(n,r),this.triggerRelease(n+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,n=0,r=0){return vc(this,t,n,r),this}asArray(t=1024){return oe(this,void 0,void 0,function*(){const n=t/this.context.sampleRate,r=new _c(1,n,this.context.sampleRate),a=this.toSeconds(this.attack)+this.toSeconds(this.decay),c=a+this.toSeconds(this.release),l=c*.1,h=c+l,f=new this.constructor(Object.assign(this.get(),{attack:n*this.toSeconds(this.attack)/h,decay:n*this.toSeconds(this.decay)/h,release:n*this.toSeconds(this.release)/h,context:r}));return f._sig.toDestination(),f.triggerAttackRelease(n*(a+l)/h,0),(yield r.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}ln([Fn(0)],Rn.prototype,"attack",void 0);ln([Fn(0)],Rn.prototype,"decay",void 0);ln([xf(0,1)],Rn.prototype,"sustain",void 0);ln([Fn(0)],Rn.prototype,"release",void 0);const Di=(()=>{let t,n;const r=[];for(t=0;t<128;t++)r[t]=Math.sin(t/(128-1)*(Math.PI/2));const a=[],c=6.4;for(t=0;t<128-1;t++){n=t/(128-1);const b=Math.sin(n*(Math.PI*2)*c-Math.PI/2)+1;a[t]=b/10+n*.83}a[128-1]=1;const l=[],h=5;for(t=0;t<128;t++)l[t]=Math.ceil(t/(128-1)*h)/h;const f=[];for(t=0;t<128;t++)n=t/(128-1),f[t]=.5*(1-Math.cos(Math.PI*n));const d=[];for(t=0;t<128;t++){n=t/(128-1);const b=Math.pow(n,3)*4+.2,S=Math.cos(b*Math.PI*2*n);d[t]=Math.abs(S*(1-n))}function _(b){const S=new Array(b.length);for(let w=0;w<b.length;w++)S[w]=1-b[w];return S}function v(b){return b.slice(0).reverse()}return{bounce:{In:_(d),Out:d},cosine:{In:r,Out:v(r)},exponential:"exponential",linear:"linear",ripple:{In:a,Out:_(a)},sine:{In:f,Out:_(f)},step:{In:l,Out:_(l)}}})();class gs extends Ct{constructor(){super(rt(gs.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=rt(gs.getDefaults(),arguments);this._volume=this.output=new _s({context:this.context,volume:t.volume}),this.volume=this._volume.volume,te(this,"volume")}static getDefaults(){return Object.assign(Ct.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,n){const r=this["_original_"+t]=this[t];this[t]=(...a)=>{const c=a[n],l=this.context.transport.schedule(h=>{a[n]=h,r.apply(this,a)},c);this._scheduledEvents.push(l)}}unsync(){return this._scheduledEvents.forEach(t=>this.context.transport.clear(t)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,n,r,a){const c=this.toSeconds(r),l=this.toSeconds(n);return this.triggerAttack(t,c,a),this.triggerRelease(c+l),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class vs extends gs{constructor(){super(rt(vs.getDefaults(),arguments));const t=rt(vs.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(gs.getDefaults(),{detune:0,onsilence:qt,portamento:0})}triggerAttack(t,n,r=1){this.log("triggerAttack",t,n,r);const a=this.toSeconds(n);return this._triggerEnvelopeAttack(a,r),this.setNote(t,a),this}triggerRelease(t){this.log("triggerRelease",t);const n=this.toSeconds(t);return this._triggerEnvelopeRelease(n),this}setNote(t,n){const r=this.toSeconds(n),a=t instanceof Qe?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(r)>.05){const c=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(a,c,r)}else this.frequency.setValueAtTime(a,r);return this}}ln([Fn(0)],vs.prototype,"portamento",void 0);class Tc extends Rn{constructor(){super(rt(Tc.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Ae({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class zs extends vs{constructor(){super(rt(zs.getDefaults(),arguments)),this.name="Synth";const t=rt(zs.getDefaults(),arguments);this.oscillator=new Er(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Tc(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),te(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(vs.getDefaults(),{envelope:Object.assign(_h(Rn.getDefaults(),Object.keys(Ct.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(_h(Er.getDefaults(),[...Object.keys(Be.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,n){if(this.envelope.triggerAttack(t,n),this.oscillator.start(t),this.envelope.sustain===0){const r=this.toSeconds(this.envelope.attack),a=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+r+a)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class kr extends zs{constructor(){super(rt(kr.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=rt(kr.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,te(this,["oscillator","envelope"])}static getDefaults(){return Vs(vs.getDefaults(),zs.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,n){const r=this.toSeconds(n),a=this.toFrequency(t instanceof Qe?t.toFrequency():t),c=a*this.octaves;return this.oscillator.frequency.setValueAtTime(c,r),this.oscillator.frequency.exponentialRampToValueAtTime(a,r+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}ln([xf(0)],kr.prototype,"octaves",void 0);ln([Fn(0)],kr.prototype,"pitchDecay",void 0);const Nf=new Set;function bc(i){Nf.add(i)}function If(i,t){const n=`registerProcessor("${i}", ${t})`;Nf.add(n)}const zS=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;bc(zS);const KS=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;bc(KS);const ZS=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;bc(ZS);const YS="feedback-comb-filter",XS=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;If(YS,XS);class Mr extends gs{constructor(){super(rt(Mr.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=rt(Mr.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),n={};Object.keys(t.urls).forEach(r=>{const a=parseInt(r,10);if(yt(Ri(r)||ds(a)&&isFinite(a),`url key is neither a note or midi pitch: ${r}`),Ri(r)){const c=new Qe(this.context,r).toMidi();n[c]=t.urls[r]}else ds(a)&&isFinite(a)&&(n[a]=t.urls[a])}),this._buffers=new yc({urls:n,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(gs.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:qt,onerror:qt,release:.1,urls:{}})}_findClosest(t){let r=0;for(;r<96;){if(this._buffers.has(t+r))return-r;if(this._buffers.has(t-r))return r;r++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,n,r=1){return this.log("triggerAttack",t,n,r),Array.isArray(t)||(t=[t]),t.forEach(a=>{const c=Af(new Qe(this.context,a).toFrequency()),l=Math.round(c),h=c-l,f=this._findClosest(l),d=l-f,_=this._buffers.get(d),v=Cf(f+h),b=new Sr({url:_,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:v}).connect(this.output);b.start(n,0,_.duration/v,r),on(this._activeSources.get(l))||this._activeSources.set(l,[]),this._activeSources.get(l).push(b),b.onended=()=>{if(this._activeSources&&this._activeSources.has(l)){const S=this._activeSources.get(l),w=S.indexOf(b);w!==-1&&S.splice(w,1)}}}),this}triggerRelease(t,n){return this.log("triggerRelease",t,n),Array.isArray(t)||(t=[t]),t.forEach(r=>{const a=new Qe(this.context,r).toMidi();if(this._activeSources.has(a)&&this._activeSources.get(a).length){const c=this._activeSources.get(a);n=this.toSeconds(n),c.forEach(l=>{l.stop(n)}),this._activeSources.set(a,[])}}),this}releaseAll(t){const n=this.toSeconds(t);return this._activeSources.forEach(r=>{for(;r.length;)r.shift().stop(n)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,n,r,a=1){const c=this.toSeconds(r);return this.triggerAttack(t,c,a),on(n)?(yt(on(t),"notes must be an array when duration is array"),t.forEach((l,h)=>{const f=n[Math.min(h,n.length-1)];this.triggerRelease(l,c+this.toSeconds(f))})):this.triggerRelease(t,c+this.toSeconds(n)),this}add(t,n,r){if(yt(Ri(t)||isFinite(t),`note must be a pitch or midi: ${t}`),Ri(t)){const a=new Qe(this.context,t).toMidi();this._buffers.add(a,n,r)}else this._buffers.add(t,n,r);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=>{t.forEach(n=>n.dispose())}),this._activeSources.clear(),this}}ln([Fn(0)],Mr.prototype,"attack",void 0);ln([Fn(0)],Mr.prototype,"release",void 0);class Ji extends Ct{constructor(){super(Object.assign(rt(Ji.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=rt(Ji.getDefaults(),arguments,["pan"]);this.pan=new Yt({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",te(this,"pan")}static getDefaults(){return Object.assign(Ct.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const QS="bit-crusher",jS=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;If(QS,jS);class se extends Ct{constructor(){super(rt(se.getDefaults(),arguments,["solo"])),this.name="Solo";const t=rt(se.getDefaults(),arguments,["solo"]);this.input=this.output=new Ae({context:this.context}),se._allSolos.has(this.context)||se._allSolos.set(this.context,new Set),se._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(Ct.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),se._allSolos.get(this.context).forEach(n=>n._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){se._soloed.has(this.context)||se._soloed.set(this.context,new Set),se._soloed.get(this.context).add(this)}_removeSolo(){se._soloed.has(this.context)&&se._soloed.get(this.context).delete(this)}_isSoloed(){return se._soloed.has(this.context)&&se._soloed.get(this.context).has(this)}_noSolos(){return!se._soloed.has(this.context)||se._soloed.has(this.context)&&se._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),se._allSolos.get(this.context).delete(this),this._removeSolo(),this}}se._allSolos=new Map;se._soloed=new Map;class to extends Ct{constructor(){super(rt(to.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=rt(to.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Ji({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new _s({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,te(this,["pan","volume"])}static getDefaults(){return Object.assign(Ct.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class us extends Ct{constructor(){super(rt(us.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=rt(us.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new se({solo:t.solo,context:this.context}),this._panVol=this.output=new to({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),te(this,["pan","volume"])}static getDefaults(){return Object.assign(Ct.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return us.buses.has(t)||us.buses.set(t,new Ae({context:this.context})),us.buses.get(t)}send(t,n=0){const r=this._getBus(t),a=new Ae({context:this.context,units:"decibels",gain:n});return this.connect(a),a.connect(r),a}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}us.buses=new Map;class JS extends Ct{constructor(){super(...arguments),this.name="Listener",this.positionX=new Yt({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Yt({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Yt({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Yt({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Yt({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Yt({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Yt({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Yt({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Yt({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Ct.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}ao(i=>{i.listener=new JS({context:i})});co(i=>{i.listener.dispose()});function tC(){return Xe().now()}Xe().transport;Xe().destination;Xe().destination;Xe().listener;Xe().draw;Xe();var gh={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(i,t){(function(){var n,r="4.17.21",a=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",h="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",d=500,_="__lodash_placeholder__",v=1,b=2,S=4,w=1,N=2,A=1,k=2,V=4,H=8,z=16,I=32,R=64,F=128,W=256,tt=512,Z=30,J="...",K=800,it=16,j=1,y=2,C=3,E=1/0,P=9007199254740991,D=17976931348623157e292,G=0/0,q=4294967295,X=q-1,ut=q>>>1,wt=[["ary",F],["bind",A],["bindKey",k],["curry",H],["curryRight",z],["flip",tt],["partial",I],["partialRight",R],["rearg",W]],at="[object Arguments]",et="[object Array]",It="[object AsyncFunction]",Y="[object Boolean]",_t="[object Date]",Ot="[object DOMException]",Wt="[object Error]",he="[object Function]",bt="[object GeneratorFunction]",Bt="[object Map]",nt="[object Number]",lt="[object Null]",kt="[object Object]",Mt="[object Promise]",At="[object Proxy]",Ft="[object RegExp]",Kt="[object Set]",Ne="[object String]",hn="[object Symbol]",Js="[object Undefined]",Jn="[object WeakMap]",ho="[object WeakSet]",tr="[object ArrayBuffer]",bs="[object DataView]",fo="[object Float32Array]",po="[object Float64Array]",_o="[object Int8Array]",mo="[object Int16Array]",go="[object Int32Array]",vo="[object Uint8Array]",yo="[object Uint8ClampedArray]",wo="[object Uint16Array]",To="[object Uint32Array]",Of=/\b__p \+= '';/g,kf=/\b(__p \+=) '' \+/g,Mf=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Sc=/&(?:amp|lt|gt|quot|#39);/g,Cc=/[&<>"']/g,Rf=RegExp(Sc.source),Df=RegExp(Cc.source),Pf=/<%-([\s\S]+?)%>/g,Ff=/<%([\s\S]+?)%>/g,Ac=/<%=([\s\S]+?)%>/g,Lf=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Wf=/^\w*$/,Vf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bo=/[\\^$.*+?()[\]{}|]/g,qf=RegExp(bo.source),So=/^\s+/,Bf=/\s/,Uf=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Gf=/\{\n\/\* \[wrapped with (.+)\] \*/,$f=/,? & /,Hf=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,zf=/[()=,{}\[\]\/\s]/,Kf=/\\(\\)?/g,Zf=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xc=/\w*$/,Yf=/^[-+]0x[0-9a-f]+$/i,Xf=/^0b[01]+$/i,Qf=/^\[object .+?Constructor\]$/,jf=/^0o[0-7]+$/i,Jf=/^(?:0|[1-9]\d*)$/,td=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Gr=/($^)/,ed=/['\n\r\u2028\u2029\\]/g,$r="\\ud800-\\udfff",nd="\\u0300-\\u036f",sd="\\ufe20-\\ufe2f",rd="\\u20d0-\\u20ff",Nc=nd+sd+rd,Ic="\\u2700-\\u27bf",Ec="a-z\\xdf-\\xf6\\xf8-\\xff",id="\\xac\\xb1\\xd7\\xf7",od="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ad="\\u2000-\\u206f",cd=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Oc="A-Z\\xc0-\\xd6\\xd8-\\xde",kc="\\ufe0e\\ufe0f",Mc=id+od+ad+cd,Co="['\u2019]",ud="["+$r+"]",Rc="["+Mc+"]",Hr="["+Nc+"]",Dc="\\d+",ld="["+Ic+"]",Pc="["+Ec+"]",Fc="[^"+$r+Mc+Dc+Ic+Ec+Oc+"]",Ao="\\ud83c[\\udffb-\\udfff]",hd="(?:"+Hr+"|"+Ao+")",Lc="[^"+$r+"]",xo="(?:\\ud83c[\\udde6-\\uddff]){2}",No="[\\ud800-\\udbff][\\udc00-\\udfff]",Ss="["+Oc+"]",Wc="\\u200d",Vc="(?:"+Pc+"|"+Fc+")",fd="(?:"+Ss+"|"+Fc+")",qc="(?:"+Co+"(?:d|ll|m|re|s|t|ve))?",Bc="(?:"+Co+"(?:D|LL|M|RE|S|T|VE))?",Uc=hd+"?",Gc="["+kc+"]?",dd="(?:"+Wc+"(?:"+[Lc,xo,No].join("|")+")"+Gc+Uc+")*",pd="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",_d="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",$c=Gc+Uc+dd,md="(?:"+[ld,xo,No].join("|")+")"+$c,gd="(?:"+[Lc+Hr+"?",Hr,xo,No,ud].join("|")+")",vd=RegExp(Co,"g"),yd=RegExp(Hr,"g"),Io=RegExp(Ao+"(?="+Ao+")|"+gd+$c,"g"),wd=RegExp([Ss+"?"+Pc+"+"+qc+"(?="+[Rc,Ss,"$"].join("|")+")",fd+"+"+Bc+"(?="+[Rc,Ss+Vc,"$"].join("|")+")",Ss+"?"+Vc+"+"+qc,Ss+"+"+Bc,_d,pd,Dc,md].join("|"),"g"),Td=RegExp("["+Wc+$r+Nc+kc+"]"),bd=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Sd=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Cd=-1,Ht={};Ht[fo]=Ht[po]=Ht[_o]=Ht[mo]=Ht[go]=Ht[vo]=Ht[yo]=Ht[wo]=Ht[To]=!0,Ht[at]=Ht[et]=Ht[tr]=Ht[Y]=Ht[bs]=Ht[_t]=Ht[Wt]=Ht[he]=Ht[Bt]=Ht[nt]=Ht[kt]=Ht[Ft]=Ht[Kt]=Ht[Ne]=Ht[Jn]=!1;var Ut={};Ut[at]=Ut[et]=Ut[tr]=Ut[bs]=Ut[Y]=Ut[_t]=Ut[fo]=Ut[po]=Ut[_o]=Ut[mo]=Ut[go]=Ut[Bt]=Ut[nt]=Ut[kt]=Ut[Ft]=Ut[Kt]=Ut[Ne]=Ut[hn]=Ut[vo]=Ut[yo]=Ut[wo]=Ut[To]=!0,Ut[Wt]=Ut[he]=Ut[Jn]=!1;var Ad={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},xd={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Nd={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Id={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ed=parseFloat,Od=parseInt,Hc=typeof mr=="object"&&mr&&mr.Object===Object&&mr,kd=typeof self=="object"&&self&&self.Object===Object&&self,pe=Hc||kd||Function("return this")(),Eo=t&&!t.nodeType&&t,ts=Eo&&!0&&i&&!i.nodeType&&i,zc=ts&&ts.exports===Eo,Oo=zc&&Hc.process,Ue=function(){try{var O=ts&&ts.require&&ts.require("util").types;return O||Oo&&Oo.binding&&Oo.binding("util")}catch{}}(),Kc=Ue&&Ue.isArrayBuffer,Zc=Ue&&Ue.isDate,Yc=Ue&&Ue.isMap,Xc=Ue&&Ue.isRegExp,Qc=Ue&&Ue.isSet,jc=Ue&&Ue.isTypedArray;function Pe(O,B,L){switch(L.length){case 0:return O.call(B);case 1:return O.call(B,L[0]);case 2:return O.call(B,L[0],L[1]);case 3:return O.call(B,L[0],L[1],L[2])}return O.apply(B,L)}function Md(O,B,L,ot){for(var pt=-1,Rt=O==null?0:O.length;++pt<Rt;){var ae=O[pt];B(ot,ae,L(ae),O)}return ot}function Ge(O,B){for(var L=-1,ot=O==null?0:O.length;++L<ot&&B(O[L],L,O)!==!1;);return O}function Rd(O,B){for(var L=O==null?0:O.length;L--&&B(O[L],L,O)!==!1;);return O}function Jc(O,B){for(var L=-1,ot=O==null?0:O.length;++L<ot;)if(!B(O[L],L,O))return!1;return!0}function Ln(O,B){for(var L=-1,ot=O==null?0:O.length,pt=0,Rt=[];++L<ot;){var ae=O[L];B(ae,L,O)&&(Rt[pt++]=ae)}return Rt}function zr(O,B){var L=O==null?0:O.length;return!!L&&Cs(O,B,0)>-1}function ko(O,B,L){for(var ot=-1,pt=O==null?0:O.length;++ot<pt;)if(L(B,O[ot]))return!0;return!1}function Zt(O,B){for(var L=-1,ot=O==null?0:O.length,pt=Array(ot);++L<ot;)pt[L]=B(O[L],L,O);return pt}function Wn(O,B){for(var L=-1,ot=B.length,pt=O.length;++L<ot;)O[pt+L]=B[L];return O}function Mo(O,B,L,ot){var pt=-1,Rt=O==null?0:O.length;for(ot&&Rt&&(L=O[++pt]);++pt<Rt;)L=B(L,O[pt],pt,O);return L}function Dd(O,B,L,ot){var pt=O==null?0:O.length;for(ot&&pt&&(L=O[--pt]);pt--;)L=B(L,O[pt],pt,O);return L}function Ro(O,B){for(var L=-1,ot=O==null?0:O.length;++L<ot;)if(B(O[L],L,O))return!0;return!1}var Pd=Do("length");function Fd(O){return O.split("")}function Ld(O){return O.match(Hf)||[]}function tu(O,B,L){var ot;return L(O,function(pt,Rt,ae){if(B(pt,Rt,ae))return ot=Rt,!1}),ot}function Kr(O,B,L,ot){for(var pt=O.length,Rt=L+(ot?1:-1);ot?Rt--:++Rt<pt;)if(B(O[Rt],Rt,O))return Rt;return-1}function Cs(O,B,L){return B===B?Yd(O,B,L):Kr(O,eu,L)}function Wd(O,B,L,ot){for(var pt=L-1,Rt=O.length;++pt<Rt;)if(ot(O[pt],B))return pt;return-1}function eu(O){return O!==O}function nu(O,B){var L=O==null?0:O.length;return L?Fo(O,B)/L:G}function Do(O){return function(B){return B==null?n:B[O]}}function Po(O){return function(B){return O==null?n:O[B]}}function su(O,B,L,ot,pt){return pt(O,function(Rt,ae,Vt){L=ot?(ot=!1,Rt):B(L,Rt,ae,Vt)}),L}function Vd(O,B){var L=O.length;for(O.sort(B);L--;)O[L]=O[L].value;return O}function Fo(O,B){for(var L,ot=-1,pt=O.length;++ot<pt;){var Rt=B(O[ot]);Rt!==n&&(L=L===n?Rt:L+Rt)}return L}function Lo(O,B){for(var L=-1,ot=Array(O);++L<O;)ot[L]=B(L);return ot}function qd(O,B){return Zt(B,function(L){return[L,O[L]]})}function ru(O){return O&&O.slice(0,cu(O)+1).replace(So,"")}function Fe(O){return function(B){return O(B)}}function Wo(O,B){return Zt(B,function(L){return O[L]})}function er(O,B){return O.has(B)}function iu(O,B){for(var L=-1,ot=O.length;++L<ot&&Cs(B,O[L],0)>-1;);return L}function ou(O,B){for(var L=O.length;L--&&Cs(B,O[L],0)>-1;);return L}function Bd(O,B){for(var L=O.length,ot=0;L--;)O[L]===B&&++ot;return ot}var Ud=Po(Ad),Gd=Po(xd);function $d(O){return"\\"+Id[O]}function Hd(O,B){return O==null?n:O[B]}function As(O){return Td.test(O)}function zd(O){return bd.test(O)}function Kd(O){for(var B,L=[];!(B=O.next()).done;)L.push(B.value);return L}function Vo(O){var B=-1,L=Array(O.size);return O.forEach(function(ot,pt){L[++B]=[pt,ot]}),L}function au(O,B){return function(L){return O(B(L))}}function Vn(O,B){for(var L=-1,ot=O.length,pt=0,Rt=[];++L<ot;){var ae=O[L];(ae===B||ae===_)&&(O[L]=_,Rt[pt++]=L)}return Rt}function Zr(O){var B=-1,L=Array(O.size);return O.forEach(function(ot){L[++B]=ot}),L}function Zd(O){var B=-1,L=Array(O.size);return O.forEach(function(ot){L[++B]=[ot,ot]}),L}function Yd(O,B,L){for(var ot=L-1,pt=O.length;++ot<pt;)if(O[ot]===B)return ot;return-1}function Xd(O,B,L){for(var ot=L+1;ot--;)if(O[ot]===B)return ot;return ot}function xs(O){return As(O)?jd(O):Pd(O)}function Je(O){return As(O)?Jd(O):Fd(O)}function cu(O){for(var B=O.length;B--&&Bf.test(O.charAt(B)););return B}var Qd=Po(Nd);function jd(O){for(var B=Io.lastIndex=0;Io.test(O);)++B;return B}function Jd(O){return O.match(Io)||[]}function tp(O){return O.match(wd)||[]}var ep=function O(B){B=B==null?pe:Ns.defaults(pe.Object(),B,Ns.pick(pe,Sd));var L=B.Array,ot=B.Date,pt=B.Error,Rt=B.Function,ae=B.Math,Vt=B.Object,qo=B.RegExp,np=B.String,$e=B.TypeError,Yr=L.prototype,sp=Rt.prototype,Is=Vt.prototype,Xr=B["__core-js_shared__"],Qr=sp.toString,Pt=Is.hasOwnProperty,rp=0,uu=function(){var e=/[^.]+$/.exec(Xr&&Xr.keys&&Xr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),jr=Is.toString,ip=Qr.call(Vt),op=pe._,ap=qo("^"+Qr.call(Pt).replace(bo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Jr=zc?B.Buffer:n,qn=B.Symbol,ti=B.Uint8Array,lu=Jr?Jr.allocUnsafe:n,ei=au(Vt.getPrototypeOf,Vt),hu=Vt.create,fu=Is.propertyIsEnumerable,ni=Yr.splice,du=qn?qn.isConcatSpreadable:n,nr=qn?qn.iterator:n,es=qn?qn.toStringTag:n,si=function(){try{var e=os(Vt,"defineProperty");return e({},"",{}),e}catch{}}(),cp=B.clearTimeout!==pe.clearTimeout&&B.clearTimeout,up=ot&&ot.now!==pe.Date.now&&ot.now,lp=B.setTimeout!==pe.setTimeout&&B.setTimeout,ri=ae.ceil,ii=ae.floor,Bo=Vt.getOwnPropertySymbols,hp=Jr?Jr.isBuffer:n,pu=B.isFinite,fp=Yr.join,dp=au(Vt.keys,Vt),ce=ae.max,ge=ae.min,pp=ot.now,_p=B.parseInt,_u=ae.random,mp=Yr.reverse,Uo=os(B,"DataView"),sr=os(B,"Map"),Go=os(B,"Promise"),Es=os(B,"Set"),rr=os(B,"WeakMap"),ir=os(Vt,"create"),oi=rr&&new rr,Os={},gp=as(Uo),vp=as(sr),yp=as(Go),wp=as(Es),Tp=as(rr),ai=qn?qn.prototype:n,or=ai?ai.valueOf:n,mu=ai?ai.toString:n;function m(e){if(jt(e)&&!mt(e)&&!(e instanceof xt)){if(e instanceof He)return e;if(Pt.call(e,"__wrapped__"))return gl(e)}return new He(e)}var ks=function(){function e(){}return function(s){if(!Qt(s))return{};if(hu)return hu(s);e.prototype=s;var o=new e;return e.prototype=n,o}}();function ci(){}function He(e,s){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=n}m.templateSettings={escape:Pf,evaluate:Ff,interpolate:Ac,variable:"",imports:{_:m}},m.prototype=ci.prototype,m.prototype.constructor=m,He.prototype=ks(ci.prototype),He.prototype.constructor=He;function xt(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=q,this.__views__=[]}function bp(){var e=new xt(this.__wrapped__);return e.__actions__=Ie(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ie(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ie(this.__views__),e}function Sp(){if(this.__filtered__){var e=new xt(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Cp(){var e=this.__wrapped__.value(),s=this.__dir__,o=mt(e),u=s<0,p=o?e.length:0,g=F_(0,p,this.__views__),T=g.start,x=g.end,M=x-T,U=u?x:T-1,$=this.__iteratees__,Q=$.length,st=0,ct=ge(M,this.__takeCount__);if(!o||!u&&p==M&&ct==M)return qu(e,this.__actions__);var ft=[];t:for(;M--&&st<ct;){U+=s;for(var vt=-1,dt=e[U];++vt<Q;){var St=$[vt],Et=St.iteratee,Ve=St.type,be=Et(dt);if(Ve==y)dt=be;else if(!be){if(Ve==j)continue t;break t}}ft[st++]=dt}return ft}xt.prototype=ks(ci.prototype),xt.prototype.constructor=xt;function ns(e){var s=-1,o=e==null?0:e.length;for(this.clear();++s<o;){var u=e[s];this.set(u[0],u[1])}}function Ap(){this.__data__=ir?ir(null):{},this.size=0}function xp(e){var s=this.has(e)&&delete this.__data__[e];return this.size-=s?1:0,s}function Np(e){var s=this.__data__;if(ir){var o=s[e];return o===f?n:o}return Pt.call(s,e)?s[e]:n}function Ip(e){var s=this.__data__;return ir?s[e]!==n:Pt.call(s,e)}function Ep(e,s){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=ir&&s===n?f:s,this}ns.prototype.clear=Ap,ns.prototype.delete=xp,ns.prototype.get=Np,ns.prototype.has=Ip,ns.prototype.set=Ep;function Tn(e){var s=-1,o=e==null?0:e.length;for(this.clear();++s<o;){var u=e[s];this.set(u[0],u[1])}}function Op(){this.__data__=[],this.size=0}function kp(e){var s=this.__data__,o=ui(s,e);if(o<0)return!1;var u=s.length-1;return o==u?s.pop():ni.call(s,o,1),--this.size,!0}function Mp(e){var s=this.__data__,o=ui(s,e);return o<0?n:s[o][1]}function Rp(e){return ui(this.__data__,e)>-1}function Dp(e,s){var o=this.__data__,u=ui(o,e);return u<0?(++this.size,o.push([e,s])):o[u][1]=s,this}Tn.prototype.clear=Op,Tn.prototype.delete=kp,Tn.prototype.get=Mp,Tn.prototype.has=Rp,Tn.prototype.set=Dp;function bn(e){var s=-1,o=e==null?0:e.length;for(this.clear();++s<o;){var u=e[s];this.set(u[0],u[1])}}function Pp(){this.size=0,this.__data__={hash:new ns,map:new(sr||Tn),string:new ns}}function Fp(e){var s=Ti(this,e).delete(e);return this.size-=s?1:0,s}function Lp(e){return Ti(this,e).get(e)}function Wp(e){return Ti(this,e).has(e)}function Vp(e,s){var o=Ti(this,e),u=o.size;return o.set(e,s),this.size+=o.size==u?0:1,this}bn.prototype.clear=Pp,bn.prototype.delete=Fp,bn.prototype.get=Lp,bn.prototype.has=Wp,bn.prototype.set=Vp;function ss(e){var s=-1,o=e==null?0:e.length;for(this.__data__=new bn;++s<o;)this.add(e[s])}function qp(e){return this.__data__.set(e,f),this}function Bp(e){return this.__data__.has(e)}ss.prototype.add=ss.prototype.push=qp,ss.prototype.has=Bp;function tn(e){var s=this.__data__=new Tn(e);this.size=s.size}function Up(){this.__data__=new Tn,this.size=0}function Gp(e){var s=this.__data__,o=s.delete(e);return this.size=s.size,o}function $p(e){return this.__data__.get(e)}function Hp(e){return this.__data__.has(e)}function zp(e,s){var o=this.__data__;if(o instanceof Tn){var u=o.__data__;if(!sr||u.length<a-1)return u.push([e,s]),this.size=++o.size,this;o=this.__data__=new bn(u)}return o.set(e,s),this.size=o.size,this}tn.prototype.clear=Up,tn.prototype.delete=Gp,tn.prototype.get=$p,tn.prototype.has=Hp,tn.prototype.set=zp;function gu(e,s){var o=mt(e),u=!o&&cs(e),p=!o&&!u&&Hn(e),g=!o&&!u&&!p&&Ps(e),T=o||u||p||g,x=T?Lo(e.length,np):[],M=x.length;for(var U in e)(s||Pt.call(e,U))&&!(T&&(U=="length"||p&&(U=="offset"||U=="parent")||g&&(U=="buffer"||U=="byteLength"||U=="byteOffset")||xn(U,M)))&&x.push(U);return x}function vu(e){var s=e.length;return s?e[ta(0,s-1)]:n}function Kp(e,s){return bi(Ie(e),rs(s,0,e.length))}function Zp(e){return bi(Ie(e))}function $o(e,s,o){(o!==n&&!en(e[s],o)||o===n&&!(s in e))&&Sn(e,s,o)}function ar(e,s,o){var u=e[s];(!(Pt.call(e,s)&&en(u,o))||o===n&&!(s in e))&&Sn(e,s,o)}function ui(e,s){for(var o=e.length;o--;)if(en(e[o][0],s))return o;return-1}function Yp(e,s,o,u){return Bn(e,function(p,g,T){s(u,p,o(p),T)}),u}function yu(e,s){return e&&dn(s,fe(s),e)}function Xp(e,s){return e&&dn(s,Oe(s),e)}function Sn(e,s,o){s=="__proto__"&&si?si(e,s,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[s]=o}function Ho(e,s){for(var o=-1,u=s.length,p=L(u),g=e==null;++o<u;)p[o]=g?n:Aa(e,s[o]);return p}function rs(e,s,o){return e===e&&(o!==n&&(e=e<=o?e:o),s!==n&&(e=e>=s?e:s)),e}function ze(e,s,o,u,p,g){var T,x=s&v,M=s&b,U=s&S;if(o&&(T=p?o(e,u,p,g):o(e)),T!==n)return T;if(!Qt(e))return e;var $=mt(e);if($){if(T=W_(e),!x)return Ie(e,T)}else{var Q=ve(e),st=Q==he||Q==bt;if(Hn(e))return Gu(e,x);if(Q==kt||Q==at||st&&!p){if(T=M||st?{}:cl(e),!x)return M?N_(e,Xp(T,e)):x_(e,yu(T,e))}else{if(!Ut[Q])return p?e:{};T=V_(e,Q,x)}}g||(g=new tn);var ct=g.get(e);if(ct)return ct;g.set(e,T),Ll(e)?e.forEach(function(dt){T.add(ze(dt,s,o,dt,e,g))}):Pl(e)&&e.forEach(function(dt,St){T.set(St,ze(dt,s,o,St,e,g))});var ft=U?M?ha:la:M?Oe:fe,vt=$?n:ft(e);return Ge(vt||e,function(dt,St){vt&&(St=dt,dt=e[St]),ar(T,St,ze(dt,s,o,St,e,g))}),T}function Qp(e){var s=fe(e);return function(o){return wu(o,e,s)}}function wu(e,s,o){var u=o.length;if(e==null)return!u;for(e=Vt(e);u--;){var p=o[u],g=s[p],T=e[p];if(T===n&&!(p in e)||!g(T))return!1}return!0}function Tu(e,s,o){if(typeof e!="function")throw new $e(l);return pr(function(){e.apply(n,o)},s)}function cr(e,s,o,u){var p=-1,g=zr,T=!0,x=e.length,M=[],U=s.length;if(!x)return M;o&&(s=Zt(s,Fe(o))),u?(g=ko,T=!1):s.length>=a&&(g=er,T=!1,s=new ss(s));t:for(;++p<x;){var $=e[p],Q=o==null?$:o($);if($=u||$!==0?$:0,T&&Q===Q){for(var st=U;st--;)if(s[st]===Q)continue t;M.push($)}else g(s,Q,u)||M.push($)}return M}var Bn=Zu(fn),bu=Zu(Ko,!0);function jp(e,s){var o=!0;return Bn(e,function(u,p,g){return o=!!s(u,p,g),o}),o}function li(e,s,o){for(var u=-1,p=e.length;++u<p;){var g=e[u],T=s(g);if(T!=null&&(x===n?T===T&&!We(T):o(T,x)))var x=T,M=g}return M}function Jp(e,s,o,u){var p=e.length;for(o=gt(o),o<0&&(o=-o>p?0:p+o),u=u===n||u>p?p:gt(u),u<0&&(u+=p),u=o>u?0:Vl(u);o<u;)e[o++]=s;return e}function Su(e,s){var o=[];return Bn(e,function(u,p,g){s(u,p,g)&&o.push(u)}),o}function _e(e,s,o,u,p){var g=-1,T=e.length;for(o||(o=B_),p||(p=[]);++g<T;){var x=e[g];s>0&&o(x)?s>1?_e(x,s-1,o,u,p):Wn(p,x):u||(p[p.length]=x)}return p}var zo=Yu(),Cu=Yu(!0);function fn(e,s){return e&&zo(e,s,fe)}function Ko(e,s){return e&&Cu(e,s,fe)}function hi(e,s){return Ln(s,function(o){return Nn(e[o])})}function is(e,s){s=Gn(s,e);for(var o=0,u=s.length;e!=null&&o<u;)e=e[pn(s[o++])];return o&&o==u?e:n}function Au(e,s,o){var u=s(e);return mt(e)?u:Wn(u,o(e))}function we(e){return e==null?e===n?Js:lt:es&&es in Vt(e)?P_(e):Z_(e)}function Zo(e,s){return e>s}function t_(e,s){return e!=null&&Pt.call(e,s)}function e_(e,s){return e!=null&&s in Vt(e)}function n_(e,s,o){return e>=ge(s,o)&&e<ce(s,o)}function Yo(e,s,o){for(var u=o?ko:zr,p=e[0].length,g=e.length,T=g,x=L(g),M=1/0,U=[];T--;){var $=e[T];T&&s&&($=Zt($,Fe(s))),M=ge($.length,M),x[T]=!o&&(s||p>=120&&$.length>=120)?new ss(T&&$):n}$=e[0];var Q=-1,st=x[0];t:for(;++Q<p&&U.length<M;){var ct=$[Q],ft=s?s(ct):ct;if(ct=o||ct!==0?ct:0,!(st?er(st,ft):u(U,ft,o))){for(T=g;--T;){var vt=x[T];if(!(vt?er(vt,ft):u(e[T],ft,o)))continue t}st&&st.push(ft),U.push(ct)}}return U}function s_(e,s,o,u){return fn(e,function(p,g,T){s(u,o(p),g,T)}),u}function ur(e,s,o){s=Gn(s,e),e=fl(e,s);var u=e==null?e:e[pn(Ze(s))];return u==null?n:Pe(u,e,o)}function xu(e){return jt(e)&&we(e)==at}function r_(e){return jt(e)&&we(e)==tr}function i_(e){return jt(e)&&we(e)==_t}function lr(e,s,o,u,p){return e===s?!0:e==null||s==null||!jt(e)&&!jt(s)?e!==e&&s!==s:o_(e,s,o,u,lr,p)}function o_(e,s,o,u,p,g){var T=mt(e),x=mt(s),M=T?et:ve(e),U=x?et:ve(s);M=M==at?kt:M,U=U==at?kt:U;var $=M==kt,Q=U==kt,st=M==U;if(st&&Hn(e)){if(!Hn(s))return!1;T=!0,$=!1}if(st&&!$)return g||(g=new tn),T||Ps(e)?il(e,s,o,u,p,g):R_(e,s,M,o,u,p,g);if(!(o&w)){var ct=$&&Pt.call(e,"__wrapped__"),ft=Q&&Pt.call(s,"__wrapped__");if(ct||ft){var vt=ct?e.value():e,dt=ft?s.value():s;return g||(g=new tn),p(vt,dt,o,u,g)}}return st?(g||(g=new tn),D_(e,s,o,u,p,g)):!1}function a_(e){return jt(e)&&ve(e)==Bt}function Xo(e,s,o,u){var p=o.length,g=p,T=!u;if(e==null)return!g;for(e=Vt(e);p--;){var x=o[p];if(T&&x[2]?x[1]!==e[x[0]]:!(x[0]in e))return!1}for(;++p<g;){x=o[p];var M=x[0],U=e[M],$=x[1];if(T&&x[2]){if(U===n&&!(M in e))return!1}else{var Q=new tn;if(u)var st=u(U,$,M,e,s,Q);if(!(st===n?lr($,U,w|N,u,Q):st))return!1}}return!0}function Nu(e){if(!Qt(e)||G_(e))return!1;var s=Nn(e)?ap:Qf;return s.test(as(e))}function c_(e){return jt(e)&&we(e)==Ft}function u_(e){return jt(e)&&ve(e)==Kt}function l_(e){return jt(e)&&Ii(e.length)&&!!Ht[we(e)]}function Iu(e){return typeof e=="function"?e:e==null?ke:typeof e=="object"?mt(e)?ku(e[0],e[1]):Ou(e):Xl(e)}function Qo(e){if(!dr(e))return dp(e);var s=[];for(var o in Vt(e))Pt.call(e,o)&&o!="constructor"&&s.push(o);return s}function h_(e){if(!Qt(e))return K_(e);var s=dr(e),o=[];for(var u in e)u=="constructor"&&(s||!Pt.call(e,u))||o.push(u);return o}function jo(e,s){return e<s}function Eu(e,s){var o=-1,u=Ee(e)?L(e.length):[];return Bn(e,function(p,g,T){u[++o]=s(p,g,T)}),u}function Ou(e){var s=da(e);return s.length==1&&s[0][2]?ll(s[0][0],s[0][1]):function(o){return o===e||Xo(o,e,s)}}function ku(e,s){return _a(e)&&ul(s)?ll(pn(e),s):function(o){var u=Aa(o,e);return u===n&&u===s?xa(o,e):lr(s,u,w|N)}}function fi(e,s,o,u,p){e!==s&&zo(s,function(g,T){if(p||(p=new tn),Qt(g))f_(e,s,T,o,fi,u,p);else{var x=u?u(ga(e,T),g,T+"",e,s,p):n;x===n&&(x=g),$o(e,T,x)}},Oe)}function f_(e,s,o,u,p,g,T){var x=ga(e,o),M=ga(s,o),U=T.get(M);if(U){$o(e,o,U);return}var $=g?g(x,M,o+"",e,s,T):n,Q=$===n;if(Q){var st=mt(M),ct=!st&&Hn(M),ft=!st&&!ct&&Ps(M);$=M,st||ct||ft?mt(x)?$=x:ee(x)?$=Ie(x):ct?(Q=!1,$=Gu(M,!0)):ft?(Q=!1,$=$u(M,!0)):$=[]:_r(M)||cs(M)?($=x,cs(x)?$=ql(x):(!Qt(x)||Nn(x))&&($=cl(M))):Q=!1}Q&&(T.set(M,$),p($,M,u,g,T),T.delete(M)),$o(e,o,$)}function Mu(e,s){var o=e.length;if(!!o)return s+=s<0?o:0,xn(s,o)?e[s]:n}function Ru(e,s,o){s.length?s=Zt(s,function(g){return mt(g)?function(T){return is(T,g.length===1?g[0]:g)}:g}):s=[ke];var u=-1;s=Zt(s,Fe(ht()));var p=Eu(e,function(g,T,x){var M=Zt(s,function(U){return U(g)});return{criteria:M,index:++u,value:g}});return Vd(p,function(g,T){return A_(g,T,o)})}function d_(e,s){return Du(e,s,function(o,u){return xa(e,u)})}function Du(e,s,o){for(var u=-1,p=s.length,g={};++u<p;){var T=s[u],x=is(e,T);o(x,T)&&hr(g,Gn(T,e),x)}return g}function p_(e){return function(s){return is(s,e)}}function Jo(e,s,o,u){var p=u?Wd:Cs,g=-1,T=s.length,x=e;for(e===s&&(s=Ie(s)),o&&(x=Zt(e,Fe(o)));++g<T;)for(var M=0,U=s[g],$=o?o(U):U;(M=p(x,$,M,u))>-1;)x!==e&&ni.call(x,M,1),ni.call(e,M,1);return e}function Pu(e,s){for(var o=e?s.length:0,u=o-1;o--;){var p=s[o];if(o==u||p!==g){var g=p;xn(p)?ni.call(e,p,1):sa(e,p)}}return e}function ta(e,s){return e+ii(_u()*(s-e+1))}function __(e,s,o,u){for(var p=-1,g=ce(ri((s-e)/(o||1)),0),T=L(g);g--;)T[u?g:++p]=e,e+=o;return T}function ea(e,s){var o="";if(!e||s<1||s>P)return o;do s%2&&(o+=e),s=ii(s/2),s&&(e+=e);while(s);return o}function Tt(e,s){return va(hl(e,s,ke),e+"")}function m_(e){return vu(Fs(e))}function g_(e,s){var o=Fs(e);return bi(o,rs(s,0,o.length))}function hr(e,s,o,u){if(!Qt(e))return e;s=Gn(s,e);for(var p=-1,g=s.length,T=g-1,x=e;x!=null&&++p<g;){var M=pn(s[p]),U=o;if(M==="__proto__"||M==="constructor"||M==="prototype")return e;if(p!=T){var $=x[M];U=u?u($,M,x):n,U===n&&(U=Qt($)?$:xn(s[p+1])?[]:{})}ar(x,M,U),x=x[M]}return e}var Fu=oi?function(e,s){return oi.set(e,s),e}:ke,v_=si?function(e,s){return si(e,"toString",{configurable:!0,enumerable:!1,value:Ia(s),writable:!0})}:ke;function y_(e){return bi(Fs(e))}function Ke(e,s,o){var u=-1,p=e.length;s<0&&(s=-s>p?0:p+s),o=o>p?p:o,o<0&&(o+=p),p=s>o?0:o-s>>>0,s>>>=0;for(var g=L(p);++u<p;)g[u]=e[u+s];return g}function w_(e,s){var o;return Bn(e,function(u,p,g){return o=s(u,p,g),!o}),!!o}function di(e,s,o){var u=0,p=e==null?u:e.length;if(typeof s=="number"&&s===s&&p<=ut){for(;u<p;){var g=u+p>>>1,T=e[g];T!==null&&!We(T)&&(o?T<=s:T<s)?u=g+1:p=g}return p}return na(e,s,ke,o)}function na(e,s,o,u){var p=0,g=e==null?0:e.length;if(g===0)return 0;s=o(s);for(var T=s!==s,x=s===null,M=We(s),U=s===n;p<g;){var $=ii((p+g)/2),Q=o(e[$]),st=Q!==n,ct=Q===null,ft=Q===Q,vt=We(Q);if(T)var dt=u||ft;else U?dt=ft&&(u||st):x?dt=ft&&st&&(u||!ct):M?dt=ft&&st&&!ct&&(u||!vt):ct||vt?dt=!1:dt=u?Q<=s:Q<s;dt?p=$+1:g=$}return ge(g,X)}function Lu(e,s){for(var o=-1,u=e.length,p=0,g=[];++o<u;){var T=e[o],x=s?s(T):T;if(!o||!en(x,M)){var M=x;g[p++]=T===0?0:T}}return g}function Wu(e){return typeof e=="number"?e:We(e)?G:+e}function Le(e){if(typeof e=="string")return e;if(mt(e))return Zt(e,Le)+"";if(We(e))return mu?mu.call(e):"";var s=e+"";return s=="0"&&1/e==-E?"-0":s}function Un(e,s,o){var u=-1,p=zr,g=e.length,T=!0,x=[],M=x;if(o)T=!1,p=ko;else if(g>=a){var U=s?null:k_(e);if(U)return Zr(U);T=!1,p=er,M=new ss}else M=s?[]:x;t:for(;++u<g;){var $=e[u],Q=s?s($):$;if($=o||$!==0?$:0,T&&Q===Q){for(var st=M.length;st--;)if(M[st]===Q)continue t;s&&M.push(Q),x.push($)}else p(M,Q,o)||(M!==x&&M.push(Q),x.push($))}return x}function sa(e,s){return s=Gn(s,e),e=fl(e,s),e==null||delete e[pn(Ze(s))]}function Vu(e,s,o,u){return hr(e,s,o(is(e,s)),u)}function pi(e,s,o,u){for(var p=e.length,g=u?p:-1;(u?g--:++g<p)&&s(e[g],g,e););return o?Ke(e,u?0:g,u?g+1:p):Ke(e,u?g+1:0,u?p:g)}function qu(e,s){var o=e;return o instanceof xt&&(o=o.value()),Mo(s,function(u,p){return p.func.apply(p.thisArg,Wn([u],p.args))},o)}function ra(e,s,o){var u=e.length;if(u<2)return u?Un(e[0]):[];for(var p=-1,g=L(u);++p<u;)for(var T=e[p],x=-1;++x<u;)x!=p&&(g[p]=cr(g[p]||T,e[x],s,o));return Un(_e(g,1),s,o)}function Bu(e,s,o){for(var u=-1,p=e.length,g=s.length,T={};++u<p;){var x=u<g?s[u]:n;o(T,e[u],x)}return T}function ia(e){return ee(e)?e:[]}function oa(e){return typeof e=="function"?e:ke}function Gn(e,s){return mt(e)?e:_a(e,s)?[e]:ml(Dt(e))}var T_=Tt;function $n(e,s,o){var u=e.length;return o=o===n?u:o,!s&&o>=u?e:Ke(e,s,o)}var Uu=cp||function(e){return pe.clearTimeout(e)};function Gu(e,s){if(s)return e.slice();var o=e.length,u=lu?lu(o):new e.constructor(o);return e.copy(u),u}function aa(e){var s=new e.constructor(e.byteLength);return new ti(s).set(new ti(e)),s}function b_(e,s){var o=s?aa(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function S_(e){var s=new e.constructor(e.source,xc.exec(e));return s.lastIndex=e.lastIndex,s}function C_(e){return or?Vt(or.call(e)):{}}function $u(e,s){var o=s?aa(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function Hu(e,s){if(e!==s){var o=e!==n,u=e===null,p=e===e,g=We(e),T=s!==n,x=s===null,M=s===s,U=We(s);if(!x&&!U&&!g&&e>s||g&&T&&M&&!x&&!U||u&&T&&M||!o&&M||!p)return 1;if(!u&&!g&&!U&&e<s||U&&o&&p&&!u&&!g||x&&o&&p||!T&&p||!M)return-1}return 0}function A_(e,s,o){for(var u=-1,p=e.criteria,g=s.criteria,T=p.length,x=o.length;++u<T;){var M=Hu(p[u],g[u]);if(M){if(u>=x)return M;var U=o[u];return M*(U=="desc"?-1:1)}}return e.index-s.index}function zu(e,s,o,u){for(var p=-1,g=e.length,T=o.length,x=-1,M=s.length,U=ce(g-T,0),$=L(M+U),Q=!u;++x<M;)$[x]=s[x];for(;++p<T;)(Q||p<g)&&($[o[p]]=e[p]);for(;U--;)$[x++]=e[p++];return $}function Ku(e,s,o,u){for(var p=-1,g=e.length,T=-1,x=o.length,M=-1,U=s.length,$=ce(g-x,0),Q=L($+U),st=!u;++p<$;)Q[p]=e[p];for(var ct=p;++M<U;)Q[ct+M]=s[M];for(;++T<x;)(st||p<g)&&(Q[ct+o[T]]=e[p++]);return Q}function Ie(e,s){var o=-1,u=e.length;for(s||(s=L(u));++o<u;)s[o]=e[o];return s}function dn(e,s,o,u){var p=!o;o||(o={});for(var g=-1,T=s.length;++g<T;){var x=s[g],M=u?u(o[x],e[x],x,o,e):n;M===n&&(M=e[x]),p?Sn(o,x,M):ar(o,x,M)}return o}function x_(e,s){return dn(e,pa(e),s)}function N_(e,s){return dn(e,ol(e),s)}function _i(e,s){return function(o,u){var p=mt(o)?Md:Yp,g=s?s():{};return p(o,e,ht(u,2),g)}}function Ms(e){return Tt(function(s,o){var u=-1,p=o.length,g=p>1?o[p-1]:n,T=p>2?o[2]:n;for(g=e.length>3&&typeof g=="function"?(p--,g):n,T&&Te(o[0],o[1],T)&&(g=p<3?n:g,p=1),s=Vt(s);++u<p;){var x=o[u];x&&e(s,x,u,g)}return s})}function Zu(e,s){return function(o,u){if(o==null)return o;if(!Ee(o))return e(o,u);for(var p=o.length,g=s?p:-1,T=Vt(o);(s?g--:++g<p)&&u(T[g],g,T)!==!1;);return o}}function Yu(e){return function(s,o,u){for(var p=-1,g=Vt(s),T=u(s),x=T.length;x--;){var M=T[e?x:++p];if(o(g[M],M,g)===!1)break}return s}}function I_(e,s,o){var u=s&A,p=fr(e);function g(){var T=this&&this!==pe&&this instanceof g?p:e;return T.apply(u?o:this,arguments)}return g}function Xu(e){return function(s){s=Dt(s);var o=As(s)?Je(s):n,u=o?o[0]:s.charAt(0),p=o?$n(o,1).join(""):s.slice(1);return u[e]()+p}}function Rs(e){return function(s){return Mo(Zl(Kl(s).replace(vd,"")),e,"")}}function fr(e){return function(){var s=arguments;switch(s.length){case 0:return new e;case 1:return new e(s[0]);case 2:return new e(s[0],s[1]);case 3:return new e(s[0],s[1],s[2]);case 4:return new e(s[0],s[1],s[2],s[3]);case 5:return new e(s[0],s[1],s[2],s[3],s[4]);case 6:return new e(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new e(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var o=ks(e.prototype),u=e.apply(o,s);return Qt(u)?u:o}}function E_(e,s,o){var u=fr(e);function p(){for(var g=arguments.length,T=L(g),x=g,M=Ds(p);x--;)T[x]=arguments[x];var U=g<3&&T[0]!==M&&T[g-1]!==M?[]:Vn(T,M);if(g-=U.length,g<o)return el(e,s,mi,p.placeholder,n,T,U,n,n,o-g);var $=this&&this!==pe&&this instanceof p?u:e;return Pe($,this,T)}return p}function Qu(e){return function(s,o,u){var p=Vt(s);if(!Ee(s)){var g=ht(o,3);s=fe(s),o=function(x){return g(p[x],x,p)}}var T=e(s,o,u);return T>-1?p[g?s[T]:T]:n}}function ju(e){return An(function(s){var o=s.length,u=o,p=He.prototype.thru;for(e&&s.reverse();u--;){var g=s[u];if(typeof g!="function")throw new $e(l);if(p&&!T&&wi(g)=="wrapper")var T=new He([],!0)}for(u=T?u:o;++u<o;){g=s[u];var x=wi(g),M=x=="wrapper"?fa(g):n;M&&ma(M[0])&&M[1]==(F|H|I|W)&&!M[4].length&&M[9]==1?T=T[wi(M[0])].apply(T,M[3]):T=g.length==1&&ma(g)?T[x]():T.thru(g)}return function(){var U=arguments,$=U[0];if(T&&U.length==1&&mt($))return T.plant($).value();for(var Q=0,st=o?s[Q].apply(this,U):$;++Q<o;)st=s[Q].call(this,st);return st}})}function mi(e,s,o,u,p,g,T,x,M,U){var $=s&F,Q=s&A,st=s&k,ct=s&(H|z),ft=s&tt,vt=st?n:fr(e);function dt(){for(var St=arguments.length,Et=L(St),Ve=St;Ve--;)Et[Ve]=arguments[Ve];if(ct)var be=Ds(dt),qe=Bd(Et,be);if(u&&(Et=zu(Et,u,p,ct)),g&&(Et=Ku(Et,g,T,ct)),St-=qe,ct&&St<U){var ne=Vn(Et,be);return el(e,s,mi,dt.placeholder,o,Et,ne,x,M,U-St)}var nn=Q?o:this,En=st?nn[e]:e;return St=Et.length,x?Et=Y_(Et,x):ft&&St>1&&Et.reverse(),$&&M<St&&(Et.length=M),this&&this!==pe&&this instanceof dt&&(En=vt||fr(En)),En.apply(nn,Et)}return dt}function Ju(e,s){return function(o,u){return s_(o,e,s(u),{})}}function gi(e,s){return function(o,u){var p;if(o===n&&u===n)return s;if(o!==n&&(p=o),u!==n){if(p===n)return u;typeof o=="string"||typeof u=="string"?(o=Le(o),u=Le(u)):(o=Wu(o),u=Wu(u)),p=e(o,u)}return p}}function ca(e){return An(function(s){return s=Zt(s,Fe(ht())),Tt(function(o){var u=this;return e(s,function(p){return Pe(p,u,o)})})})}function vi(e,s){s=s===n?" ":Le(s);var o=s.length;if(o<2)return o?ea(s,e):s;var u=ea(s,ri(e/xs(s)));return As(s)?$n(Je(u),0,e).join(""):u.slice(0,e)}function O_(e,s,o,u){var p=s&A,g=fr(e);function T(){for(var x=-1,M=arguments.length,U=-1,$=u.length,Q=L($+M),st=this&&this!==pe&&this instanceof T?g:e;++U<$;)Q[U]=u[U];for(;M--;)Q[U++]=arguments[++x];return Pe(st,p?o:this,Q)}return T}function tl(e){return function(s,o,u){return u&&typeof u!="number"&&Te(s,o,u)&&(o=u=n),s=In(s),o===n?(o=s,s=0):o=In(o),u=u===n?s<o?1:-1:In(u),__(s,o,u,e)}}function yi(e){return function(s,o){return typeof s=="string"&&typeof o=="string"||(s=Ye(s),o=Ye(o)),e(s,o)}}function el(e,s,o,u,p,g,T,x,M,U){var $=s&H,Q=$?T:n,st=$?n:T,ct=$?g:n,ft=$?n:g;s|=$?I:R,s&=~($?R:I),s&V||(s&=~(A|k));var vt=[e,s,p,ct,Q,ft,st,x,M,U],dt=o.apply(n,vt);return ma(e)&&dl(dt,vt),dt.placeholder=u,pl(dt,e,s)}function ua(e){var s=ae[e];return function(o,u){if(o=Ye(o),u=u==null?0:ge(gt(u),292),u&&pu(o)){var p=(Dt(o)+"e").split("e"),g=s(p[0]+"e"+(+p[1]+u));return p=(Dt(g)+"e").split("e"),+(p[0]+"e"+(+p[1]-u))}return s(o)}}var k_=Es&&1/Zr(new Es([,-0]))[1]==E?function(e){return new Es(e)}:ka;function nl(e){return function(s){var o=ve(s);return o==Bt?Vo(s):o==Kt?Zd(s):qd(s,e(s))}}function Cn(e,s,o,u,p,g,T,x){var M=s&k;if(!M&&typeof e!="function")throw new $e(l);var U=u?u.length:0;if(U||(s&=~(I|R),u=p=n),T=T===n?T:ce(gt(T),0),x=x===n?x:gt(x),U-=p?p.length:0,s&R){var $=u,Q=p;u=p=n}var st=M?n:fa(e),ct=[e,s,o,u,p,$,Q,g,T,x];if(st&&z_(ct,st),e=ct[0],s=ct[1],o=ct[2],u=ct[3],p=ct[4],x=ct[9]=ct[9]===n?M?0:e.length:ce(ct[9]-U,0),!x&&s&(H|z)&&(s&=~(H|z)),!s||s==A)var ft=I_(e,s,o);else s==H||s==z?ft=E_(e,s,x):(s==I||s==(A|I))&&!p.length?ft=O_(e,s,o,u):ft=mi.apply(n,ct);var vt=st?Fu:dl;return pl(vt(ft,ct),e,s)}function sl(e,s,o,u){return e===n||en(e,Is[o])&&!Pt.call(u,o)?s:e}function rl(e,s,o,u,p,g){return Qt(e)&&Qt(s)&&(g.set(s,e),fi(e,s,n,rl,g),g.delete(s)),e}function M_(e){return _r(e)?n:e}function il(e,s,o,u,p,g){var T=o&w,x=e.length,M=s.length;if(x!=M&&!(T&&M>x))return!1;var U=g.get(e),$=g.get(s);if(U&&$)return U==s&&$==e;var Q=-1,st=!0,ct=o&N?new ss:n;for(g.set(e,s),g.set(s,e);++Q<x;){var ft=e[Q],vt=s[Q];if(u)var dt=T?u(vt,ft,Q,s,e,g):u(ft,vt,Q,e,s,g);if(dt!==n){if(dt)continue;st=!1;break}if(ct){if(!Ro(s,function(St,Et){if(!er(ct,Et)&&(ft===St||p(ft,St,o,u,g)))return ct.push(Et)})){st=!1;break}}else if(!(ft===vt||p(ft,vt,o,u,g))){st=!1;break}}return g.delete(e),g.delete(s),st}function R_(e,s,o,u,p,g,T){switch(o){case bs:if(e.byteLength!=s.byteLength||e.byteOffset!=s.byteOffset)return!1;e=e.buffer,s=s.buffer;case tr:return!(e.byteLength!=s.byteLength||!g(new ti(e),new ti(s)));case Y:case _t:case nt:return en(+e,+s);case Wt:return e.name==s.name&&e.message==s.message;case Ft:case Ne:return e==s+"";case Bt:var x=Vo;case Kt:var M=u&w;if(x||(x=Zr),e.size!=s.size&&!M)return!1;var U=T.get(e);if(U)return U==s;u|=N,T.set(e,s);var $=il(x(e),x(s),u,p,g,T);return T.delete(e),$;case hn:if(or)return or.call(e)==or.call(s)}return!1}function D_(e,s,o,u,p,g){var T=o&w,x=la(e),M=x.length,U=la(s),$=U.length;if(M!=$&&!T)return!1;for(var Q=M;Q--;){var st=x[Q];if(!(T?st in s:Pt.call(s,st)))return!1}var ct=g.get(e),ft=g.get(s);if(ct&&ft)return ct==s&&ft==e;var vt=!0;g.set(e,s),g.set(s,e);for(var dt=T;++Q<M;){st=x[Q];var St=e[st],Et=s[st];if(u)var Ve=T?u(Et,St,st,s,e,g):u(St,Et,st,e,s,g);if(!(Ve===n?St===Et||p(St,Et,o,u,g):Ve)){vt=!1;break}dt||(dt=st=="constructor")}if(vt&&!dt){var be=e.constructor,qe=s.constructor;be!=qe&&"constructor"in e&&"constructor"in s&&!(typeof be=="function"&&be instanceof be&&typeof qe=="function"&&qe instanceof qe)&&(vt=!1)}return g.delete(e),g.delete(s),vt}function An(e){return va(hl(e,n,wl),e+"")}function la(e){return Au(e,fe,pa)}function ha(e){return Au(e,Oe,ol)}var fa=oi?function(e){return oi.get(e)}:ka;function wi(e){for(var s=e.name+"",o=Os[s],u=Pt.call(Os,s)?o.length:0;u--;){var p=o[u],g=p.func;if(g==null||g==e)return p.name}return s}function Ds(e){var s=Pt.call(m,"placeholder")?m:e;return s.placeholder}function ht(){var e=m.iteratee||Ea;return e=e===Ea?Iu:e,arguments.length?e(arguments[0],arguments[1]):e}function Ti(e,s){var o=e.__data__;return U_(s)?o[typeof s=="string"?"string":"hash"]:o.map}function da(e){for(var s=fe(e),o=s.length;o--;){var u=s[o],p=e[u];s[o]=[u,p,ul(p)]}return s}function os(e,s){var o=Hd(e,s);return Nu(o)?o:n}function P_(e){var s=Pt.call(e,es),o=e[es];try{e[es]=n;var u=!0}catch{}var p=jr.call(e);return u&&(s?e[es]=o:delete e[es]),p}var pa=Bo?function(e){return e==null?[]:(e=Vt(e),Ln(Bo(e),function(s){return fu.call(e,s)}))}:Ma,ol=Bo?function(e){for(var s=[];e;)Wn(s,pa(e)),e=ei(e);return s}:Ma,ve=we;(Uo&&ve(new Uo(new ArrayBuffer(1)))!=bs||sr&&ve(new sr)!=Bt||Go&&ve(Go.resolve())!=Mt||Es&&ve(new Es)!=Kt||rr&&ve(new rr)!=Jn)&&(ve=function(e){var s=we(e),o=s==kt?e.constructor:n,u=o?as(o):"";if(u)switch(u){case gp:return bs;case vp:return Bt;case yp:return Mt;case wp:return Kt;case Tp:return Jn}return s});function F_(e,s,o){for(var u=-1,p=o.length;++u<p;){var g=o[u],T=g.size;switch(g.type){case"drop":e+=T;break;case"dropRight":s-=T;break;case"take":s=ge(s,e+T);break;case"takeRight":e=ce(e,s-T);break}}return{start:e,end:s}}function L_(e){var s=e.match(Gf);return s?s[1].split($f):[]}function al(e,s,o){s=Gn(s,e);for(var u=-1,p=s.length,g=!1;++u<p;){var T=pn(s[u]);if(!(g=e!=null&&o(e,T)))break;e=e[T]}return g||++u!=p?g:(p=e==null?0:e.length,!!p&&Ii(p)&&xn(T,p)&&(mt(e)||cs(e)))}function W_(e){var s=e.length,o=new e.constructor(s);return s&&typeof e[0]=="string"&&Pt.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function cl(e){return typeof e.constructor=="function"&&!dr(e)?ks(ei(e)):{}}function V_(e,s,o){var u=e.constructor;switch(s){case tr:return aa(e);case Y:case _t:return new u(+e);case bs:return b_(e,o);case fo:case po:case _o:case mo:case go:case vo:case yo:case wo:case To:return $u(e,o);case Bt:return new u;case nt:case Ne:return new u(e);case Ft:return S_(e);case Kt:return new u;case hn:return C_(e)}}function q_(e,s){var o=s.length;if(!o)return e;var u=o-1;return s[u]=(o>1?"& ":"")+s[u],s=s.join(o>2?", ":" "),e.replace(Uf,`{
/* [wrapped with `+s+`] */
`)}function B_(e){return mt(e)||cs(e)||!!(du&&e&&e[du])}function xn(e,s){var o=typeof e;return s=s==null?P:s,!!s&&(o=="number"||o!="symbol"&&Jf.test(e))&&e>-1&&e%1==0&&e<s}function Te(e,s,o){if(!Qt(o))return!1;var u=typeof s;return(u=="number"?Ee(o)&&xn(s,o.length):u=="string"&&s in o)?en(o[s],e):!1}function _a(e,s){if(mt(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||We(e)?!0:Wf.test(e)||!Lf.test(e)||s!=null&&e in Vt(s)}function U_(e){var s=typeof e;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?e!=="__proto__":e===null}function ma(e){var s=wi(e),o=m[s];if(typeof o!="function"||!(s in xt.prototype))return!1;if(e===o)return!0;var u=fa(o);return!!u&&e===u[0]}function G_(e){return!!uu&&uu in e}var $_=Xr?Nn:Ra;function dr(e){var s=e&&e.constructor,o=typeof s=="function"&&s.prototype||Is;return e===o}function ul(e){return e===e&&!Qt(e)}function ll(e,s){return function(o){return o==null?!1:o[e]===s&&(s!==n||e in Vt(o))}}function H_(e){var s=xi(e,function(u){return o.size===d&&o.clear(),u}),o=s.cache;return s}function z_(e,s){var o=e[1],u=s[1],p=o|u,g=p<(A|k|F),T=u==F&&o==H||u==F&&o==W&&e[7].length<=s[8]||u==(F|W)&&s[7].length<=s[8]&&o==H;if(!(g||T))return e;u&A&&(e[2]=s[2],p|=o&A?0:V);var x=s[3];if(x){var M=e[3];e[3]=M?zu(M,x,s[4]):x,e[4]=M?Vn(e[3],_):s[4]}return x=s[5],x&&(M=e[5],e[5]=M?Ku(M,x,s[6]):x,e[6]=M?Vn(e[5],_):s[6]),x=s[7],x&&(e[7]=x),u&F&&(e[8]=e[8]==null?s[8]:ge(e[8],s[8])),e[9]==null&&(e[9]=s[9]),e[0]=s[0],e[1]=p,e}function K_(e){var s=[];if(e!=null)for(var o in Vt(e))s.push(o);return s}function Z_(e){return jr.call(e)}function hl(e,s,o){return s=ce(s===n?e.length-1:s,0),function(){for(var u=arguments,p=-1,g=ce(u.length-s,0),T=L(g);++p<g;)T[p]=u[s+p];p=-1;for(var x=L(s+1);++p<s;)x[p]=u[p];return x[s]=o(T),Pe(e,this,x)}}function fl(e,s){return s.length<2?e:is(e,Ke(s,0,-1))}function Y_(e,s){for(var o=e.length,u=ge(s.length,o),p=Ie(e);u--;){var g=s[u];e[u]=xn(g,o)?p[g]:n}return e}function ga(e,s){if(!(s==="constructor"&&typeof e[s]=="function")&&s!="__proto__")return e[s]}var dl=_l(Fu),pr=lp||function(e,s){return pe.setTimeout(e,s)},va=_l(v_);function pl(e,s,o){var u=s+"";return va(e,q_(u,X_(L_(u),o)))}function _l(e){var s=0,o=0;return function(){var u=pp(),p=it-(u-o);if(o=u,p>0){if(++s>=K)return arguments[0]}else s=0;return e.apply(n,arguments)}}function bi(e,s){var o=-1,u=e.length,p=u-1;for(s=s===n?u:s;++o<s;){var g=ta(o,p),T=e[g];e[g]=e[o],e[o]=T}return e.length=s,e}var ml=H_(function(e){var s=[];return e.charCodeAt(0)===46&&s.push(""),e.replace(Vf,function(o,u,p,g){s.push(p?g.replace(Kf,"$1"):u||o)}),s});function pn(e){if(typeof e=="string"||We(e))return e;var s=e+"";return s=="0"&&1/e==-E?"-0":s}function as(e){if(e!=null){try{return Qr.call(e)}catch{}try{return e+""}catch{}}return""}function X_(e,s){return Ge(wt,function(o){var u="_."+o[0];s&o[1]&&!zr(e,u)&&e.push(u)}),e.sort()}function gl(e){if(e instanceof xt)return e.clone();var s=new He(e.__wrapped__,e.__chain__);return s.__actions__=Ie(e.__actions__),s.__index__=e.__index__,s.__values__=e.__values__,s}function Q_(e,s,o){(o?Te(e,s,o):s===n)?s=1:s=ce(gt(s),0);var u=e==null?0:e.length;if(!u||s<1)return[];for(var p=0,g=0,T=L(ri(u/s));p<u;)T[g++]=Ke(e,p,p+=s);return T}function j_(e){for(var s=-1,o=e==null?0:e.length,u=0,p=[];++s<o;){var g=e[s];g&&(p[u++]=g)}return p}function J_(){var e=arguments.length;if(!e)return[];for(var s=L(e-1),o=arguments[0],u=e;u--;)s[u-1]=arguments[u];return Wn(mt(o)?Ie(o):[o],_e(s,1))}var tm=Tt(function(e,s){return ee(e)?cr(e,_e(s,1,ee,!0)):[]}),em=Tt(function(e,s){var o=Ze(s);return ee(o)&&(o=n),ee(e)?cr(e,_e(s,1,ee,!0),ht(o,2)):[]}),nm=Tt(function(e,s){var o=Ze(s);return ee(o)&&(o=n),ee(e)?cr(e,_e(s,1,ee,!0),n,o):[]});function sm(e,s,o){var u=e==null?0:e.length;return u?(s=o||s===n?1:gt(s),Ke(e,s<0?0:s,u)):[]}function rm(e,s,o){var u=e==null?0:e.length;return u?(s=o||s===n?1:gt(s),s=u-s,Ke(e,0,s<0?0:s)):[]}function im(e,s){return e&&e.length?pi(e,ht(s,3),!0,!0):[]}function om(e,s){return e&&e.length?pi(e,ht(s,3),!0):[]}function am(e,s,o,u){var p=e==null?0:e.length;return p?(o&&typeof o!="number"&&Te(e,s,o)&&(o=0,u=p),Jp(e,s,o,u)):[]}function vl(e,s,o){var u=e==null?0:e.length;if(!u)return-1;var p=o==null?0:gt(o);return p<0&&(p=ce(u+p,0)),Kr(e,ht(s,3),p)}function yl(e,s,o){var u=e==null?0:e.length;if(!u)return-1;var p=u-1;return o!==n&&(p=gt(o),p=o<0?ce(u+p,0):ge(p,u-1)),Kr(e,ht(s,3),p,!0)}function wl(e){var s=e==null?0:e.length;return s?_e(e,1):[]}function cm(e){var s=e==null?0:e.length;return s?_e(e,E):[]}function um(e,s){var o=e==null?0:e.length;return o?(s=s===n?1:gt(s),_e(e,s)):[]}function lm(e){for(var s=-1,o=e==null?0:e.length,u={};++s<o;){var p=e[s];u[p[0]]=p[1]}return u}function Tl(e){return e&&e.length?e[0]:n}function hm(e,s,o){var u=e==null?0:e.length;if(!u)return-1;var p=o==null?0:gt(o);return p<0&&(p=ce(u+p,0)),Cs(e,s,p)}function fm(e){var s=e==null?0:e.length;return s?Ke(e,0,-1):[]}var dm=Tt(function(e){var s=Zt(e,ia);return s.length&&s[0]===e[0]?Yo(s):[]}),pm=Tt(function(e){var s=Ze(e),o=Zt(e,ia);return s===Ze(o)?s=n:o.pop(),o.length&&o[0]===e[0]?Yo(o,ht(s,2)):[]}),_m=Tt(function(e){var s=Ze(e),o=Zt(e,ia);return s=typeof s=="function"?s:n,s&&o.pop(),o.length&&o[0]===e[0]?Yo(o,n,s):[]});function mm(e,s){return e==null?"":fp.call(e,s)}function Ze(e){var s=e==null?0:e.length;return s?e[s-1]:n}function gm(e,s,o){var u=e==null?0:e.length;if(!u)return-1;var p=u;return o!==n&&(p=gt(o),p=p<0?ce(u+p,0):ge(p,u-1)),s===s?Xd(e,s,p):Kr(e,eu,p,!0)}function vm(e,s){return e&&e.length?Mu(e,gt(s)):n}var ym=Tt(bl);function bl(e,s){return e&&e.length&&s&&s.length?Jo(e,s):e}function wm(e,s,o){return e&&e.length&&s&&s.length?Jo(e,s,ht(o,2)):e}function Tm(e,s,o){return e&&e.length&&s&&s.length?Jo(e,s,n,o):e}var bm=An(function(e,s){var o=e==null?0:e.length,u=Ho(e,s);return Pu(e,Zt(s,function(p){return xn(p,o)?+p:p}).sort(Hu)),u});function Sm(e,s){var o=[];if(!(e&&e.length))return o;var u=-1,p=[],g=e.length;for(s=ht(s,3);++u<g;){var T=e[u];s(T,u,e)&&(o.push(T),p.push(u))}return Pu(e,p),o}function ya(e){return e==null?e:mp.call(e)}function Cm(e,s,o){var u=e==null?0:e.length;return u?(o&&typeof o!="number"&&Te(e,s,o)?(s=0,o=u):(s=s==null?0:gt(s),o=o===n?u:gt(o)),Ke(e,s,o)):[]}function Am(e,s){return di(e,s)}function xm(e,s,o){return na(e,s,ht(o,2))}function Nm(e,s){var o=e==null?0:e.length;if(o){var u=di(e,s);if(u<o&&en(e[u],s))return u}return-1}function Im(e,s){return di(e,s,!0)}function Em(e,s,o){return na(e,s,ht(o,2),!0)}function Om(e,s){var o=e==null?0:e.length;if(o){var u=di(e,s,!0)-1;if(en(e[u],s))return u}return-1}function km(e){return e&&e.length?Lu(e):[]}function Mm(e,s){return e&&e.length?Lu(e,ht(s,2)):[]}function Rm(e){var s=e==null?0:e.length;return s?Ke(e,1,s):[]}function Dm(e,s,o){return e&&e.length?(s=o||s===n?1:gt(s),Ke(e,0,s<0?0:s)):[]}function Pm(e,s,o){var u=e==null?0:e.length;return u?(s=o||s===n?1:gt(s),s=u-s,Ke(e,s<0?0:s,u)):[]}function Fm(e,s){return e&&e.length?pi(e,ht(s,3),!1,!0):[]}function Lm(e,s){return e&&e.length?pi(e,ht(s,3)):[]}var Wm=Tt(function(e){return Un(_e(e,1,ee,!0))}),Vm=Tt(function(e){var s=Ze(e);return ee(s)&&(s=n),Un(_e(e,1,ee,!0),ht(s,2))}),qm=Tt(function(e){var s=Ze(e);return s=typeof s=="function"?s:n,Un(_e(e,1,ee,!0),n,s)});function Bm(e){return e&&e.length?Un(e):[]}function Um(e,s){return e&&e.length?Un(e,ht(s,2)):[]}function Gm(e,s){return s=typeof s=="function"?s:n,e&&e.length?Un(e,n,s):[]}function wa(e){if(!(e&&e.length))return[];var s=0;return e=Ln(e,function(o){if(ee(o))return s=ce(o.length,s),!0}),Lo(s,function(o){return Zt(e,Do(o))})}function Sl(e,s){if(!(e&&e.length))return[];var o=wa(e);return s==null?o:Zt(o,function(u){return Pe(s,n,u)})}var $m=Tt(function(e,s){return ee(e)?cr(e,s):[]}),Hm=Tt(function(e){return ra(Ln(e,ee))}),zm=Tt(function(e){var s=Ze(e);return ee(s)&&(s=n),ra(Ln(e,ee),ht(s,2))}),Km=Tt(function(e){var s=Ze(e);return s=typeof s=="function"?s:n,ra(Ln(e,ee),n,s)}),Zm=Tt(wa);function Ym(e,s){return Bu(e||[],s||[],ar)}function Xm(e,s){return Bu(e||[],s||[],hr)}var Qm=Tt(function(e){var s=e.length,o=s>1?e[s-1]:n;return o=typeof o=="function"?(e.pop(),o):n,Sl(e,o)});function Cl(e){var s=m(e);return s.__chain__=!0,s}function jm(e,s){return s(e),e}function Si(e,s){return s(e)}var Jm=An(function(e){var s=e.length,o=s?e[0]:0,u=this.__wrapped__,p=function(g){return Ho(g,e)};return s>1||this.__actions__.length||!(u instanceof xt)||!xn(o)?this.thru(p):(u=u.slice(o,+o+(s?1:0)),u.__actions__.push({func:Si,args:[p],thisArg:n}),new He(u,this.__chain__).thru(function(g){return s&&!g.length&&g.push(n),g}))});function tg(){return Cl(this)}function eg(){return new He(this.value(),this.__chain__)}function ng(){this.__values__===n&&(this.__values__=Wl(this.value()));var e=this.__index__>=this.__values__.length,s=e?n:this.__values__[this.__index__++];return{done:e,value:s}}function sg(){return this}function rg(e){for(var s,o=this;o instanceof ci;){var u=gl(o);u.__index__=0,u.__values__=n,s?p.__wrapped__=u:s=u;var p=u;o=o.__wrapped__}return p.__wrapped__=e,s}function ig(){var e=this.__wrapped__;if(e instanceof xt){var s=e;return this.__actions__.length&&(s=new xt(this)),s=s.reverse(),s.__actions__.push({func:Si,args:[ya],thisArg:n}),new He(s,this.__chain__)}return this.thru(ya)}function og(){return qu(this.__wrapped__,this.__actions__)}var ag=_i(function(e,s,o){Pt.call(e,o)?++e[o]:Sn(e,o,1)});function cg(e,s,o){var u=mt(e)?Jc:jp;return o&&Te(e,s,o)&&(s=n),u(e,ht(s,3))}function ug(e,s){var o=mt(e)?Ln:Su;return o(e,ht(s,3))}var lg=Qu(vl),hg=Qu(yl);function fg(e,s){return _e(Ci(e,s),1)}function dg(e,s){return _e(Ci(e,s),E)}function pg(e,s,o){return o=o===n?1:gt(o),_e(Ci(e,s),o)}function Al(e,s){var o=mt(e)?Ge:Bn;return o(e,ht(s,3))}function xl(e,s){var o=mt(e)?Rd:bu;return o(e,ht(s,3))}var _g=_i(function(e,s,o){Pt.call(e,o)?e[o].push(s):Sn(e,o,[s])});function mg(e,s,o,u){e=Ee(e)?e:Fs(e),o=o&&!u?gt(o):0;var p=e.length;return o<0&&(o=ce(p+o,0)),Ei(e)?o<=p&&e.indexOf(s,o)>-1:!!p&&Cs(e,s,o)>-1}var gg=Tt(function(e,s,o){var u=-1,p=typeof s=="function",g=Ee(e)?L(e.length):[];return Bn(e,function(T){g[++u]=p?Pe(s,T,o):ur(T,s,o)}),g}),vg=_i(function(e,s,o){Sn(e,o,s)});function Ci(e,s){var o=mt(e)?Zt:Eu;return o(e,ht(s,3))}function yg(e,s,o,u){return e==null?[]:(mt(s)||(s=s==null?[]:[s]),o=u?n:o,mt(o)||(o=o==null?[]:[o]),Ru(e,s,o))}var wg=_i(function(e,s,o){e[o?0:1].push(s)},function(){return[[],[]]});function Tg(e,s,o){var u=mt(e)?Mo:su,p=arguments.length<3;return u(e,ht(s,4),o,p,Bn)}function bg(e,s,o){var u=mt(e)?Dd:su,p=arguments.length<3;return u(e,ht(s,4),o,p,bu)}function Sg(e,s){var o=mt(e)?Ln:Su;return o(e,Ni(ht(s,3)))}function Cg(e){var s=mt(e)?vu:m_;return s(e)}function Ag(e,s,o){(o?Te(e,s,o):s===n)?s=1:s=gt(s);var u=mt(e)?Kp:g_;return u(e,s)}function xg(e){var s=mt(e)?Zp:y_;return s(e)}function Ng(e){if(e==null)return 0;if(Ee(e))return Ei(e)?xs(e):e.length;var s=ve(e);return s==Bt||s==Kt?e.size:Qo(e).length}function Ig(e,s,o){var u=mt(e)?Ro:w_;return o&&Te(e,s,o)&&(s=n),u(e,ht(s,3))}var Eg=Tt(function(e,s){if(e==null)return[];var o=s.length;return o>1&&Te(e,s[0],s[1])?s=[]:o>2&&Te(s[0],s[1],s[2])&&(s=[s[0]]),Ru(e,_e(s,1),[])}),Ai=up||function(){return pe.Date.now()};function Og(e,s){if(typeof s!="function")throw new $e(l);return e=gt(e),function(){if(--e<1)return s.apply(this,arguments)}}function Nl(e,s,o){return s=o?n:s,s=e&&s==null?e.length:s,Cn(e,F,n,n,n,n,s)}function Il(e,s){var o;if(typeof s!="function")throw new $e(l);return e=gt(e),function(){return--e>0&&(o=s.apply(this,arguments)),e<=1&&(s=n),o}}var Ta=Tt(function(e,s,o){var u=A;if(o.length){var p=Vn(o,Ds(Ta));u|=I}return Cn(e,u,s,o,p)}),El=Tt(function(e,s,o){var u=A|k;if(o.length){var p=Vn(o,Ds(El));u|=I}return Cn(s,u,e,o,p)});function Ol(e,s,o){s=o?n:s;var u=Cn(e,H,n,n,n,n,n,s);return u.placeholder=Ol.placeholder,u}function kl(e,s,o){s=o?n:s;var u=Cn(e,z,n,n,n,n,n,s);return u.placeholder=kl.placeholder,u}function Ml(e,s,o){var u,p,g,T,x,M,U=0,$=!1,Q=!1,st=!0;if(typeof e!="function")throw new $e(l);s=Ye(s)||0,Qt(o)&&($=!!o.leading,Q="maxWait"in o,g=Q?ce(Ye(o.maxWait)||0,s):g,st="trailing"in o?!!o.trailing:st);function ct(ne){var nn=u,En=p;return u=p=n,U=ne,T=e.apply(En,nn),T}function ft(ne){return U=ne,x=pr(St,s),$?ct(ne):T}function vt(ne){var nn=ne-M,En=ne-U,Ql=s-nn;return Q?ge(Ql,g-En):Ql}function dt(ne){var nn=ne-M,En=ne-U;return M===n||nn>=s||nn<0||Q&&En>=g}function St(){var ne=Ai();if(dt(ne))return Et(ne);x=pr(St,vt(ne))}function Et(ne){return x=n,st&&u?ct(ne):(u=p=n,T)}function Ve(){x!==n&&Uu(x),U=0,u=M=p=x=n}function be(){return x===n?T:Et(Ai())}function qe(){var ne=Ai(),nn=dt(ne);if(u=arguments,p=this,M=ne,nn){if(x===n)return ft(M);if(Q)return Uu(x),x=pr(St,s),ct(M)}return x===n&&(x=pr(St,s)),T}return qe.cancel=Ve,qe.flush=be,qe}var kg=Tt(function(e,s){return Tu(e,1,s)}),Mg=Tt(function(e,s,o){return Tu(e,Ye(s)||0,o)});function Rg(e){return Cn(e,tt)}function xi(e,s){if(typeof e!="function"||s!=null&&typeof s!="function")throw new $e(l);var o=function(){var u=arguments,p=s?s.apply(this,u):u[0],g=o.cache;if(g.has(p))return g.get(p);var T=e.apply(this,u);return o.cache=g.set(p,T)||g,T};return o.cache=new(xi.Cache||bn),o}xi.Cache=bn;function Ni(e){if(typeof e!="function")throw new $e(l);return function(){var s=arguments;switch(s.length){case 0:return!e.call(this);case 1:return!e.call(this,s[0]);case 2:return!e.call(this,s[0],s[1]);case 3:return!e.call(this,s[0],s[1],s[2])}return!e.apply(this,s)}}function Dg(e){return Il(2,e)}var Pg=T_(function(e,s){s=s.length==1&&mt(s[0])?Zt(s[0],Fe(ht())):Zt(_e(s,1),Fe(ht()));var o=s.length;return Tt(function(u){for(var p=-1,g=ge(u.length,o);++p<g;)u[p]=s[p].call(this,u[p]);return Pe(e,this,u)})}),ba=Tt(function(e,s){var o=Vn(s,Ds(ba));return Cn(e,I,n,s,o)}),Rl=Tt(function(e,s){var o=Vn(s,Ds(Rl));return Cn(e,R,n,s,o)}),Fg=An(function(e,s){return Cn(e,W,n,n,n,s)});function Lg(e,s){if(typeof e!="function")throw new $e(l);return s=s===n?s:gt(s),Tt(e,s)}function Wg(e,s){if(typeof e!="function")throw new $e(l);return s=s==null?0:ce(gt(s),0),Tt(function(o){var u=o[s],p=$n(o,0,s);return u&&Wn(p,u),Pe(e,this,p)})}function Vg(e,s,o){var u=!0,p=!0;if(typeof e!="function")throw new $e(l);return Qt(o)&&(u="leading"in o?!!o.leading:u,p="trailing"in o?!!o.trailing:p),Ml(e,s,{leading:u,maxWait:s,trailing:p})}function qg(e){return Nl(e,1)}function Bg(e,s){return ba(oa(s),e)}function Ug(){if(!arguments.length)return[];var e=arguments[0];return mt(e)?e:[e]}function Gg(e){return ze(e,S)}function $g(e,s){return s=typeof s=="function"?s:n,ze(e,S,s)}function Hg(e){return ze(e,v|S)}function zg(e,s){return s=typeof s=="function"?s:n,ze(e,v|S,s)}function Kg(e,s){return s==null||wu(e,s,fe(s))}function en(e,s){return e===s||e!==e&&s!==s}var Zg=yi(Zo),Yg=yi(function(e,s){return e>=s}),cs=xu(function(){return arguments}())?xu:function(e){return jt(e)&&Pt.call(e,"callee")&&!fu.call(e,"callee")},mt=L.isArray,Xg=Kc?Fe(Kc):r_;function Ee(e){return e!=null&&Ii(e.length)&&!Nn(e)}function ee(e){return jt(e)&&Ee(e)}function Qg(e){return e===!0||e===!1||jt(e)&&we(e)==Y}var Hn=hp||Ra,jg=Zc?Fe(Zc):i_;function Jg(e){return jt(e)&&e.nodeType===1&&!_r(e)}function t0(e){if(e==null)return!0;if(Ee(e)&&(mt(e)||typeof e=="string"||typeof e.splice=="function"||Hn(e)||Ps(e)||cs(e)))return!e.length;var s=ve(e);if(s==Bt||s==Kt)return!e.size;if(dr(e))return!Qo(e).length;for(var o in e)if(Pt.call(e,o))return!1;return!0}function e0(e,s){return lr(e,s)}function n0(e,s,o){o=typeof o=="function"?o:n;var u=o?o(e,s):n;return u===n?lr(e,s,n,o):!!u}function Sa(e){if(!jt(e))return!1;var s=we(e);return s==Wt||s==Ot||typeof e.message=="string"&&typeof e.name=="string"&&!_r(e)}function s0(e){return typeof e=="number"&&pu(e)}function Nn(e){if(!Qt(e))return!1;var s=we(e);return s==he||s==bt||s==It||s==At}function Dl(e){return typeof e=="number"&&e==gt(e)}function Ii(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=P}function Qt(e){var s=typeof e;return e!=null&&(s=="object"||s=="function")}function jt(e){return e!=null&&typeof e=="object"}var Pl=Yc?Fe(Yc):a_;function r0(e,s){return e===s||Xo(e,s,da(s))}function i0(e,s,o){return o=typeof o=="function"?o:n,Xo(e,s,da(s),o)}function o0(e){return Fl(e)&&e!=+e}function a0(e){if($_(e))throw new pt(c);return Nu(e)}function c0(e){return e===null}function u0(e){return e==null}function Fl(e){return typeof e=="number"||jt(e)&&we(e)==nt}function _r(e){if(!jt(e)||we(e)!=kt)return!1;var s=ei(e);if(s===null)return!0;var o=Pt.call(s,"constructor")&&s.constructor;return typeof o=="function"&&o instanceof o&&Qr.call(o)==ip}var Ca=Xc?Fe(Xc):c_;function l0(e){return Dl(e)&&e>=-P&&e<=P}var Ll=Qc?Fe(Qc):u_;function Ei(e){return typeof e=="string"||!mt(e)&&jt(e)&&we(e)==Ne}function We(e){return typeof e=="symbol"||jt(e)&&we(e)==hn}var Ps=jc?Fe(jc):l_;function h0(e){return e===n}function f0(e){return jt(e)&&ve(e)==Jn}function d0(e){return jt(e)&&we(e)==ho}var p0=yi(jo),_0=yi(function(e,s){return e<=s});function Wl(e){if(!e)return[];if(Ee(e))return Ei(e)?Je(e):Ie(e);if(nr&&e[nr])return Kd(e[nr]());var s=ve(e),o=s==Bt?Vo:s==Kt?Zr:Fs;return o(e)}function In(e){if(!e)return e===0?e:0;if(e=Ye(e),e===E||e===-E){var s=e<0?-1:1;return s*D}return e===e?e:0}function gt(e){var s=In(e),o=s%1;return s===s?o?s-o:s:0}function Vl(e){return e?rs(gt(e),0,q):0}function Ye(e){if(typeof e=="number")return e;if(We(e))return G;if(Qt(e)){var s=typeof e.valueOf=="function"?e.valueOf():e;e=Qt(s)?s+"":s}if(typeof e!="string")return e===0?e:+e;e=ru(e);var o=Xf.test(e);return o||jf.test(e)?Od(e.slice(2),o?2:8):Yf.test(e)?G:+e}function ql(e){return dn(e,Oe(e))}function m0(e){return e?rs(gt(e),-P,P):e===0?e:0}function Dt(e){return e==null?"":Le(e)}var g0=Ms(function(e,s){if(dr(s)||Ee(s)){dn(s,fe(s),e);return}for(var o in s)Pt.call(s,o)&&ar(e,o,s[o])}),Bl=Ms(function(e,s){dn(s,Oe(s),e)}),Oi=Ms(function(e,s,o,u){dn(s,Oe(s),e,u)}),v0=Ms(function(e,s,o,u){dn(s,fe(s),e,u)}),y0=An(Ho);function w0(e,s){var o=ks(e);return s==null?o:yu(o,s)}var T0=Tt(function(e,s){e=Vt(e);var o=-1,u=s.length,p=u>2?s[2]:n;for(p&&Te(s[0],s[1],p)&&(u=1);++o<u;)for(var g=s[o],T=Oe(g),x=-1,M=T.length;++x<M;){var U=T[x],$=e[U];($===n||en($,Is[U])&&!Pt.call(e,U))&&(e[U]=g[U])}return e}),b0=Tt(function(e){return e.push(n,rl),Pe(Ul,n,e)});function S0(e,s){return tu(e,ht(s,3),fn)}function C0(e,s){return tu(e,ht(s,3),Ko)}function A0(e,s){return e==null?e:zo(e,ht(s,3),Oe)}function x0(e,s){return e==null?e:Cu(e,ht(s,3),Oe)}function N0(e,s){return e&&fn(e,ht(s,3))}function I0(e,s){return e&&Ko(e,ht(s,3))}function E0(e){return e==null?[]:hi(e,fe(e))}function O0(e){return e==null?[]:hi(e,Oe(e))}function Aa(e,s,o){var u=e==null?n:is(e,s);return u===n?o:u}function k0(e,s){return e!=null&&al(e,s,t_)}function xa(e,s){return e!=null&&al(e,s,e_)}var M0=Ju(function(e,s,o){s!=null&&typeof s.toString!="function"&&(s=jr.call(s)),e[s]=o},Ia(ke)),R0=Ju(function(e,s,o){s!=null&&typeof s.toString!="function"&&(s=jr.call(s)),Pt.call(e,s)?e[s].push(o):e[s]=[o]},ht),D0=Tt(ur);function fe(e){return Ee(e)?gu(e):Qo(e)}function Oe(e){return Ee(e)?gu(e,!0):h_(e)}function P0(e,s){var o={};return s=ht(s,3),fn(e,function(u,p,g){Sn(o,s(u,p,g),u)}),o}function F0(e,s){var o={};return s=ht(s,3),fn(e,function(u,p,g){Sn(o,p,s(u,p,g))}),o}var L0=Ms(function(e,s,o){fi(e,s,o)}),Ul=Ms(function(e,s,o,u){fi(e,s,o,u)}),W0=An(function(e,s){var o={};if(e==null)return o;var u=!1;s=Zt(s,function(g){return g=Gn(g,e),u||(u=g.length>1),g}),dn(e,ha(e),o),u&&(o=ze(o,v|b|S,M_));for(var p=s.length;p--;)sa(o,s[p]);return o});function V0(e,s){return Gl(e,Ni(ht(s)))}var q0=An(function(e,s){return e==null?{}:d_(e,s)});function Gl(e,s){if(e==null)return{};var o=Zt(ha(e),function(u){return[u]});return s=ht(s),Du(e,o,function(u,p){return s(u,p[0])})}function B0(e,s,o){s=Gn(s,e);var u=-1,p=s.length;for(p||(p=1,e=n);++u<p;){var g=e==null?n:e[pn(s[u])];g===n&&(u=p,g=o),e=Nn(g)?g.call(e):g}return e}function U0(e,s,o){return e==null?e:hr(e,s,o)}function G0(e,s,o,u){return u=typeof u=="function"?u:n,e==null?e:hr(e,s,o,u)}var $l=nl(fe),Hl=nl(Oe);function $0(e,s,o){var u=mt(e),p=u||Hn(e)||Ps(e);if(s=ht(s,4),o==null){var g=e&&e.constructor;p?o=u?new g:[]:Qt(e)?o=Nn(g)?ks(ei(e)):{}:o={}}return(p?Ge:fn)(e,function(T,x,M){return s(o,T,x,M)}),o}function H0(e,s){return e==null?!0:sa(e,s)}function z0(e,s,o){return e==null?e:Vu(e,s,oa(o))}function K0(e,s,o,u){return u=typeof u=="function"?u:n,e==null?e:Vu(e,s,oa(o),u)}function Fs(e){return e==null?[]:Wo(e,fe(e))}function Z0(e){return e==null?[]:Wo(e,Oe(e))}function Y0(e,s,o){return o===n&&(o=s,s=n),o!==n&&(o=Ye(o),o=o===o?o:0),s!==n&&(s=Ye(s),s=s===s?s:0),rs(Ye(e),s,o)}function X0(e,s,o){return s=In(s),o===n?(o=s,s=0):o=In(o),e=Ye(e),n_(e,s,o)}function Q0(e,s,o){if(o&&typeof o!="boolean"&&Te(e,s,o)&&(s=o=n),o===n&&(typeof s=="boolean"?(o=s,s=n):typeof e=="boolean"&&(o=e,e=n)),e===n&&s===n?(e=0,s=1):(e=In(e),s===n?(s=e,e=0):s=In(s)),e>s){var u=e;e=s,s=u}if(o||e%1||s%1){var p=_u();return ge(e+p*(s-e+Ed("1e-"+((p+"").length-1))),s)}return ta(e,s)}var j0=Rs(function(e,s,o){return s=s.toLowerCase(),e+(o?zl(s):s)});function zl(e){return Na(Dt(e).toLowerCase())}function Kl(e){return e=Dt(e),e&&e.replace(td,Ud).replace(yd,"")}function J0(e,s,o){e=Dt(e),s=Le(s);var u=e.length;o=o===n?u:rs(gt(o),0,u);var p=o;return o-=s.length,o>=0&&e.slice(o,p)==s}function tv(e){return e=Dt(e),e&&Df.test(e)?e.replace(Cc,Gd):e}function ev(e){return e=Dt(e),e&&qf.test(e)?e.replace(bo,"\\$&"):e}var nv=Rs(function(e,s,o){return e+(o?"-":"")+s.toLowerCase()}),sv=Rs(function(e,s,o){return e+(o?" ":"")+s.toLowerCase()}),rv=Xu("toLowerCase");function iv(e,s,o){e=Dt(e),s=gt(s);var u=s?xs(e):0;if(!s||u>=s)return e;var p=(s-u)/2;return vi(ii(p),o)+e+vi(ri(p),o)}function ov(e,s,o){e=Dt(e),s=gt(s);var u=s?xs(e):0;return s&&u<s?e+vi(s-u,o):e}function av(e,s,o){e=Dt(e),s=gt(s);var u=s?xs(e):0;return s&&u<s?vi(s-u,o)+e:e}function cv(e,s,o){return o||s==null?s=0:s&&(s=+s),_p(Dt(e).replace(So,""),s||0)}function uv(e,s,o){return(o?Te(e,s,o):s===n)?s=1:s=gt(s),ea(Dt(e),s)}function lv(){var e=arguments,s=Dt(e[0]);return e.length<3?s:s.replace(e[1],e[2])}var hv=Rs(function(e,s,o){return e+(o?"_":"")+s.toLowerCase()});function fv(e,s,o){return o&&typeof o!="number"&&Te(e,s,o)&&(s=o=n),o=o===n?q:o>>>0,o?(e=Dt(e),e&&(typeof s=="string"||s!=null&&!Ca(s))&&(s=Le(s),!s&&As(e))?$n(Je(e),0,o):e.split(s,o)):[]}var dv=Rs(function(e,s,o){return e+(o?" ":"")+Na(s)});function pv(e,s,o){return e=Dt(e),o=o==null?0:rs(gt(o),0,e.length),s=Le(s),e.slice(o,o+s.length)==s}function _v(e,s,o){var u=m.templateSettings;o&&Te(e,s,o)&&(s=n),e=Dt(e),s=Oi({},s,u,sl);var p=Oi({},s.imports,u.imports,sl),g=fe(p),T=Wo(p,g),x,M,U=0,$=s.interpolate||Gr,Q="__p += '",st=qo((s.escape||Gr).source+"|"+$.source+"|"+($===Ac?Zf:Gr).source+"|"+(s.evaluate||Gr).source+"|$","g"),ct="//# sourceURL="+(Pt.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Cd+"]")+`
`;e.replace(st,function(dt,St,Et,Ve,be,qe){return Et||(Et=Ve),Q+=e.slice(U,qe).replace(ed,$d),St&&(x=!0,Q+=`' +
__e(`+St+`) +
'`),be&&(M=!0,Q+=`';
`+be+`;
__p += '`),Et&&(Q+=`' +
((__t = (`+Et+`)) == null ? '' : __t) +
'`),U=qe+dt.length,dt}),Q+=`';
`;var ft=Pt.call(s,"variable")&&s.variable;if(!ft)Q=`with (obj) {
`+Q+`
}
`;else if(zf.test(ft))throw new pt(h);Q=(M?Q.replace(Of,""):Q).replace(kf,"$1").replace(Mf,"$1;"),Q="function("+(ft||"obj")+`) {
`+(ft?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(x?", __e = _.escape":"")+(M?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Q+`return __p
}`;var vt=Yl(function(){return Rt(g,ct+"return "+Q).apply(n,T)});if(vt.source=Q,Sa(vt))throw vt;return vt}function mv(e){return Dt(e).toLowerCase()}function gv(e){return Dt(e).toUpperCase()}function vv(e,s,o){if(e=Dt(e),e&&(o||s===n))return ru(e);if(!e||!(s=Le(s)))return e;var u=Je(e),p=Je(s),g=iu(u,p),T=ou(u,p)+1;return $n(u,g,T).join("")}function yv(e,s,o){if(e=Dt(e),e&&(o||s===n))return e.slice(0,cu(e)+1);if(!e||!(s=Le(s)))return e;var u=Je(e),p=ou(u,Je(s))+1;return $n(u,0,p).join("")}function wv(e,s,o){if(e=Dt(e),e&&(o||s===n))return e.replace(So,"");if(!e||!(s=Le(s)))return e;var u=Je(e),p=iu(u,Je(s));return $n(u,p).join("")}function Tv(e,s){var o=Z,u=J;if(Qt(s)){var p="separator"in s?s.separator:p;o="length"in s?gt(s.length):o,u="omission"in s?Le(s.omission):u}e=Dt(e);var g=e.length;if(As(e)){var T=Je(e);g=T.length}if(o>=g)return e;var x=o-xs(u);if(x<1)return u;var M=T?$n(T,0,x).join(""):e.slice(0,x);if(p===n)return M+u;if(T&&(x+=M.length-x),Ca(p)){if(e.slice(x).search(p)){var U,$=M;for(p.global||(p=qo(p.source,Dt(xc.exec(p))+"g")),p.lastIndex=0;U=p.exec($);)var Q=U.index;M=M.slice(0,Q===n?x:Q)}}else if(e.indexOf(Le(p),x)!=x){var st=M.lastIndexOf(p);st>-1&&(M=M.slice(0,st))}return M+u}function bv(e){return e=Dt(e),e&&Rf.test(e)?e.replace(Sc,Qd):e}var Sv=Rs(function(e,s,o){return e+(o?" ":"")+s.toUpperCase()}),Na=Xu("toUpperCase");function Zl(e,s,o){return e=Dt(e),s=o?n:s,s===n?zd(e)?tp(e):Ld(e):e.match(s)||[]}var Yl=Tt(function(e,s){try{return Pe(e,n,s)}catch(o){return Sa(o)?o:new pt(o)}}),Cv=An(function(e,s){return Ge(s,function(o){o=pn(o),Sn(e,o,Ta(e[o],e))}),e});function Av(e){var s=e==null?0:e.length,o=ht();return e=s?Zt(e,function(u){if(typeof u[1]!="function")throw new $e(l);return[o(u[0]),u[1]]}):[],Tt(function(u){for(var p=-1;++p<s;){var g=e[p];if(Pe(g[0],this,u))return Pe(g[1],this,u)}})}function xv(e){return Qp(ze(e,v))}function Ia(e){return function(){return e}}function Nv(e,s){return e==null||e!==e?s:e}var Iv=ju(),Ev=ju(!0);function ke(e){return e}function Ea(e){return Iu(typeof e=="function"?e:ze(e,v))}function Ov(e){return Ou(ze(e,v))}function kv(e,s){return ku(e,ze(s,v))}var Mv=Tt(function(e,s){return function(o){return ur(o,e,s)}}),Rv=Tt(function(e,s){return function(o){return ur(e,o,s)}});function Oa(e,s,o){var u=fe(s),p=hi(s,u);o==null&&!(Qt(s)&&(p.length||!u.length))&&(o=s,s=e,e=this,p=hi(s,fe(s)));var g=!(Qt(o)&&"chain"in o)||!!o.chain,T=Nn(e);return Ge(p,function(x){var M=s[x];e[x]=M,T&&(e.prototype[x]=function(){var U=this.__chain__;if(g||U){var $=e(this.__wrapped__),Q=$.__actions__=Ie(this.__actions__);return Q.push({func:M,args:arguments,thisArg:e}),$.__chain__=U,$}return M.apply(e,Wn([this.value()],arguments))})}),e}function Dv(){return pe._===this&&(pe._=op),this}function ka(){}function Pv(e){return e=gt(e),Tt(function(s){return Mu(s,e)})}var Fv=ca(Zt),Lv=ca(Jc),Wv=ca(Ro);function Xl(e){return _a(e)?Do(pn(e)):p_(e)}function Vv(e){return function(s){return e==null?n:is(e,s)}}var qv=tl(),Bv=tl(!0);function Ma(){return[]}function Ra(){return!1}function Uv(){return{}}function Gv(){return""}function $v(){return!0}function Hv(e,s){if(e=gt(e),e<1||e>P)return[];var o=q,u=ge(e,q);s=ht(s),e-=q;for(var p=Lo(u,s);++o<e;)s(o);return p}function zv(e){return mt(e)?Zt(e,pn):We(e)?[e]:Ie(ml(Dt(e)))}function Kv(e){var s=++rp;return Dt(e)+s}var Zv=gi(function(e,s){return e+s},0),Yv=ua("ceil"),Xv=gi(function(e,s){return e/s},1),Qv=ua("floor");function jv(e){return e&&e.length?li(e,ke,Zo):n}function Jv(e,s){return e&&e.length?li(e,ht(s,2),Zo):n}function t1(e){return nu(e,ke)}function e1(e,s){return nu(e,ht(s,2))}function n1(e){return e&&e.length?li(e,ke,jo):n}function s1(e,s){return e&&e.length?li(e,ht(s,2),jo):n}var r1=gi(function(e,s){return e*s},1),i1=ua("round"),o1=gi(function(e,s){return e-s},0);function a1(e){return e&&e.length?Fo(e,ke):0}function c1(e,s){return e&&e.length?Fo(e,ht(s,2)):0}return m.after=Og,m.ary=Nl,m.assign=g0,m.assignIn=Bl,m.assignInWith=Oi,m.assignWith=v0,m.at=y0,m.before=Il,m.bind=Ta,m.bindAll=Cv,m.bindKey=El,m.castArray=Ug,m.chain=Cl,m.chunk=Q_,m.compact=j_,m.concat=J_,m.cond=Av,m.conforms=xv,m.constant=Ia,m.countBy=ag,m.create=w0,m.curry=Ol,m.curryRight=kl,m.debounce=Ml,m.defaults=T0,m.defaultsDeep=b0,m.defer=kg,m.delay=Mg,m.difference=tm,m.differenceBy=em,m.differenceWith=nm,m.drop=sm,m.dropRight=rm,m.dropRightWhile=im,m.dropWhile=om,m.fill=am,m.filter=ug,m.flatMap=fg,m.flatMapDeep=dg,m.flatMapDepth=pg,m.flatten=wl,m.flattenDeep=cm,m.flattenDepth=um,m.flip=Rg,m.flow=Iv,m.flowRight=Ev,m.fromPairs=lm,m.functions=E0,m.functionsIn=O0,m.groupBy=_g,m.initial=fm,m.intersection=dm,m.intersectionBy=pm,m.intersectionWith=_m,m.invert=M0,m.invertBy=R0,m.invokeMap=gg,m.iteratee=Ea,m.keyBy=vg,m.keys=fe,m.keysIn=Oe,m.map=Ci,m.mapKeys=P0,m.mapValues=F0,m.matches=Ov,m.matchesProperty=kv,m.memoize=xi,m.merge=L0,m.mergeWith=Ul,m.method=Mv,m.methodOf=Rv,m.mixin=Oa,m.negate=Ni,m.nthArg=Pv,m.omit=W0,m.omitBy=V0,m.once=Dg,m.orderBy=yg,m.over=Fv,m.overArgs=Pg,m.overEvery=Lv,m.overSome=Wv,m.partial=ba,m.partialRight=Rl,m.partition=wg,m.pick=q0,m.pickBy=Gl,m.property=Xl,m.propertyOf=Vv,m.pull=ym,m.pullAll=bl,m.pullAllBy=wm,m.pullAllWith=Tm,m.pullAt=bm,m.range=qv,m.rangeRight=Bv,m.rearg=Fg,m.reject=Sg,m.remove=Sm,m.rest=Lg,m.reverse=ya,m.sampleSize=Ag,m.set=U0,m.setWith=G0,m.shuffle=xg,m.slice=Cm,m.sortBy=Eg,m.sortedUniq=km,m.sortedUniqBy=Mm,m.split=fv,m.spread=Wg,m.tail=Rm,m.take=Dm,m.takeRight=Pm,m.takeRightWhile=Fm,m.takeWhile=Lm,m.tap=jm,m.throttle=Vg,m.thru=Si,m.toArray=Wl,m.toPairs=$l,m.toPairsIn=Hl,m.toPath=zv,m.toPlainObject=ql,m.transform=$0,m.unary=qg,m.union=Wm,m.unionBy=Vm,m.unionWith=qm,m.uniq=Bm,m.uniqBy=Um,m.uniqWith=Gm,m.unset=H0,m.unzip=wa,m.unzipWith=Sl,m.update=z0,m.updateWith=K0,m.values=Fs,m.valuesIn=Z0,m.without=$m,m.words=Zl,m.wrap=Bg,m.xor=Hm,m.xorBy=zm,m.xorWith=Km,m.zip=Zm,m.zipObject=Ym,m.zipObjectDeep=Xm,m.zipWith=Qm,m.entries=$l,m.entriesIn=Hl,m.extend=Bl,m.extendWith=Oi,Oa(m,m),m.add=Zv,m.attempt=Yl,m.camelCase=j0,m.capitalize=zl,m.ceil=Yv,m.clamp=Y0,m.clone=Gg,m.cloneDeep=Hg,m.cloneDeepWith=zg,m.cloneWith=$g,m.conformsTo=Kg,m.deburr=Kl,m.defaultTo=Nv,m.divide=Xv,m.endsWith=J0,m.eq=en,m.escape=tv,m.escapeRegExp=ev,m.every=cg,m.find=lg,m.findIndex=vl,m.findKey=S0,m.findLast=hg,m.findLastIndex=yl,m.findLastKey=C0,m.floor=Qv,m.forEach=Al,m.forEachRight=xl,m.forIn=A0,m.forInRight=x0,m.forOwn=N0,m.forOwnRight=I0,m.get=Aa,m.gt=Zg,m.gte=Yg,m.has=k0,m.hasIn=xa,m.head=Tl,m.identity=ke,m.includes=mg,m.indexOf=hm,m.inRange=X0,m.invoke=D0,m.isArguments=cs,m.isArray=mt,m.isArrayBuffer=Xg,m.isArrayLike=Ee,m.isArrayLikeObject=ee,m.isBoolean=Qg,m.isBuffer=Hn,m.isDate=jg,m.isElement=Jg,m.isEmpty=t0,m.isEqual=e0,m.isEqualWith=n0,m.isError=Sa,m.isFinite=s0,m.isFunction=Nn,m.isInteger=Dl,m.isLength=Ii,m.isMap=Pl,m.isMatch=r0,m.isMatchWith=i0,m.isNaN=o0,m.isNative=a0,m.isNil=u0,m.isNull=c0,m.isNumber=Fl,m.isObject=Qt,m.isObjectLike=jt,m.isPlainObject=_r,m.isRegExp=Ca,m.isSafeInteger=l0,m.isSet=Ll,m.isString=Ei,m.isSymbol=We,m.isTypedArray=Ps,m.isUndefined=h0,m.isWeakMap=f0,m.isWeakSet=d0,m.join=mm,m.kebabCase=nv,m.last=Ze,m.lastIndexOf=gm,m.lowerCase=sv,m.lowerFirst=rv,m.lt=p0,m.lte=_0,m.max=jv,m.maxBy=Jv,m.mean=t1,m.meanBy=e1,m.min=n1,m.minBy=s1,m.stubArray=Ma,m.stubFalse=Ra,m.stubObject=Uv,m.stubString=Gv,m.stubTrue=$v,m.multiply=r1,m.nth=vm,m.noConflict=Dv,m.noop=ka,m.now=Ai,m.pad=iv,m.padEnd=ov,m.padStart=av,m.parseInt=cv,m.random=Q0,m.reduce=Tg,m.reduceRight=bg,m.repeat=uv,m.replace=lv,m.result=B0,m.round=i1,m.runInContext=O,m.sample=Cg,m.size=Ng,m.snakeCase=hv,m.some=Ig,m.sortedIndex=Am,m.sortedIndexBy=xm,m.sortedIndexOf=Nm,m.sortedLastIndex=Im,m.sortedLastIndexBy=Em,m.sortedLastIndexOf=Om,m.startCase=dv,m.startsWith=pv,m.subtract=o1,m.sum=a1,m.sumBy=c1,m.template=_v,m.times=Hv,m.toFinite=In,m.toInteger=gt,m.toLength=Vl,m.toLower=mv,m.toNumber=Ye,m.toSafeInteger=m0,m.toString=Dt,m.toUpper=gv,m.trim=vv,m.trimEnd=yv,m.trimStart=wv,m.truncate=Tv,m.unescape=bv,m.uniqueId=Kv,m.upperCase=Sv,m.upperFirst=Na,m.each=Al,m.eachRight=xl,m.first=Tl,Oa(m,function(){var e={};return fn(m,function(s,o){Pt.call(m.prototype,o)||(e[o]=s)}),e}(),{chain:!1}),m.VERSION=r,Ge(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){m[e].placeholder=m}),Ge(["drop","take"],function(e,s){xt.prototype[e]=function(o){o=o===n?1:ce(gt(o),0);var u=this.__filtered__&&!s?new xt(this):this.clone();return u.__filtered__?u.__takeCount__=ge(o,u.__takeCount__):u.__views__.push({size:ge(o,q),type:e+(u.__dir__<0?"Right":"")}),u},xt.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),Ge(["filter","map","takeWhile"],function(e,s){var o=s+1,u=o==j||o==C;xt.prototype[e]=function(p){var g=this.clone();return g.__iteratees__.push({iteratee:ht(p,3),type:o}),g.__filtered__=g.__filtered__||u,g}}),Ge(["head","last"],function(e,s){var o="take"+(s?"Right":"");xt.prototype[e]=function(){return this[o](1).value()[0]}}),Ge(["initial","tail"],function(e,s){var o="drop"+(s?"":"Right");xt.prototype[e]=function(){return this.__filtered__?new xt(this):this[o](1)}}),xt.prototype.compact=function(){return this.filter(ke)},xt.prototype.find=function(e){return this.filter(e).head()},xt.prototype.findLast=function(e){return this.reverse().find(e)},xt.prototype.invokeMap=Tt(function(e,s){return typeof e=="function"?new xt(this):this.map(function(o){return ur(o,e,s)})}),xt.prototype.reject=function(e){return this.filter(Ni(ht(e)))},xt.prototype.slice=function(e,s){e=gt(e);var o=this;return o.__filtered__&&(e>0||s<0)?new xt(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),s!==n&&(s=gt(s),o=s<0?o.dropRight(-s):o.take(s-e)),o)},xt.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},xt.prototype.toArray=function(){return this.take(q)},fn(xt.prototype,function(e,s){var o=/^(?:filter|find|map|reject)|While$/.test(s),u=/^(?:head|last)$/.test(s),p=m[u?"take"+(s=="last"?"Right":""):s],g=u||/^find/.test(s);!p||(m.prototype[s]=function(){var T=this.__wrapped__,x=u?[1]:arguments,M=T instanceof xt,U=x[0],$=M||mt(T),Q=function(St){var Et=p.apply(m,Wn([St],x));return u&&st?Et[0]:Et};$&&o&&typeof U=="function"&&U.length!=1&&(M=$=!1);var st=this.__chain__,ct=!!this.__actions__.length,ft=g&&!st,vt=M&&!ct;if(!g&&$){T=vt?T:new xt(this);var dt=e.apply(T,x);return dt.__actions__.push({func:Si,args:[Q],thisArg:n}),new He(dt,st)}return ft&&vt?e.apply(this,x):(dt=this.thru(Q),ft?u?dt.value()[0]:dt.value():dt)})}),Ge(["pop","push","shift","sort","splice","unshift"],function(e){var s=Yr[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);m.prototype[e]=function(){var p=arguments;if(u&&!this.__chain__){var g=this.value();return s.apply(mt(g)?g:[],p)}return this[o](function(T){return s.apply(mt(T)?T:[],p)})}}),fn(xt.prototype,function(e,s){var o=m[s];if(o){var u=o.name+"";Pt.call(Os,u)||(Os[u]=[]),Os[u].push({name:s,func:o})}}),Os[mi(n,k).name]=[{name:"wrapper",func:n}],xt.prototype.clone=bp,xt.prototype.reverse=Sp,xt.prototype.value=Cp,m.prototype.at=Jm,m.prototype.chain=tg,m.prototype.commit=eg,m.prototype.next=ng,m.prototype.plant=rg,m.prototype.reverse=ig,m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=og,m.prototype.first=m.prototype.head,nr&&(m.prototype[nr]=sg),m},Ns=ep();ts?((ts.exports=Ns)._=Ns,Eo._=Ns):pe._=Ns}).call(mr)})(gh,gh.exports);document.querySelector("#app").innerHTML=`
  <button id="playButton">Play</button>
  <div id="board1" style="width: 400px"></div>
`;var eC=Chessboard("board1","start");const Ef=new Ya.Chess,nC=['[Event "Match"]','[Site "Sveti-Stefan/Belgrade (Yugoslavia)"]','[Date "1992.??.??"]','[Round "?"]','[White "Bobby Fischer"]','[Black "Boris V Spassky"]','[Result "1-0"]',"","1. e4 e5 2. Nf3 Nc6 3. Bb5 a6 4. Ba4 Nf6 5. O-O Be7 6. Re1 b5 7. Bb3 d6 8. c3","O-O 9. h3 Nb8 10. d4 Nbd7 11. Nbd2 Bb7 12. Bc2 Re8 13. Nf1 Bf8 14. Ng3 g6 15.","Bg5 h6 16. Bd2 Bg7 17. a4 c5 18. d5 c4 19. b4 Nh7 20. Be3 h5 21. Qd2 Rf8 22. Ra3","Ndf6 23. Rea1 Qd7 24. R1a2 Rfc8 25. Qc1 Bf8 26. Qa1 Qe8 27. Nf1 Be7 28. N1d2 Kg7","29. Nb1 Nxe4 30. Bxe4 f5 31. Bc2 Bxd5 32. axb5 axb5 33. Ra7 Kf6 34. Nbd2 Rxa7","35. Rxa7 Ra8 36. g4 hxg4 37. hxg4 Rxa7 38. Qxa7 f4 39. Bxf4 exf4 40. Nh4 Bf7 41.","Qd4+ Ke6 42. Nf5 Bf8 43. Qxf4 Kd7 44. Nd4 Qe1+ 45. Kg2 Bd5+ 46. Be4 Bxe4+ 47.","Nxe4 Be7 48. Nxb5 Nf8 49. Nbxd6 Ne6 50. Qe5 1-0"];Ef.loadPgn(nC.join(`
`));const vh=Ef.history({verbose:!0}),Pa=document.getElementById("playButton"),yh=new zs().toDestination(),wh=new Ya.Chess;let Fa=!1,La;Pa.addEventListener("click",()=>{if(Fa=!Fa,Fa){MS(),Pa.textContent="Pause";let i=0;La=setInterval(()=>{const t=vh[i],n=sC(t.to);let r=tC();yh.triggerAttack(n,r),yh.triggerRelease(r+1),wh.move(t.san);let a=wh.fen();eC.position(a),i<vh.length-1?i++:clearInterval(La)},500)}else Pa.textContent="Play",clearInterval(La)});const sC=i=>{const t=["C","D","E","F","G","A","B","C"];let n=i[0],r=i[1],a=t[n.charCodeAt()-97];return(n="h")&&r++,a+r};
